#!/usr/local/bin/perl

#use strict;
use XML::Writer;
use IO::File;
use DBI;
use CBIL::Util::PropertySet;

#------- Uid and Password..these are fetched from the gus.cnfig file----------
my ($gusConfigFile);
$gusConfigFile = $ENV{GUS_HOME} . "/config/gus.config" unless($gusConfigFile);

unless(-e $gusConfigFile) {
  print STDERR "gus.config file not found! \n";
  exit;
}


my @properties = ();
my $gusconfig = CBIL::Util::PropertySet->new($gusConfigFile, \@properties, 1);

my $u = $gusconfig->{props}->{databaseLogin};
my $pw = $gusconfig->{props}->{databasePassword};

#----------------------------------------------------------------------------

$DBLinks[0] = "cryp420n";
$DBLinks[1] = "giar130n";
$DBLinks[2] = "plas610n";
$DBLinks[3] = "toxo521s";
$DBLinks[4] = "tvag111n";
$DBLinks[5] = "tryp120n";

$OrganismDBLink{"Cryptosporidium_hominis"} = $DBLinks[0];
$OrganismDBLink{"Cryptosporidium_muris"} = $DBLinks[0];
$OrganismDBLink{"Cryptosporidium_parvum"} = $DBLinks[0];
$OrganismDBLink{"Giardia_lamblia"} = $DBLinks[1];
$OrganismDBLink{"Neospora_caninum"} = $DBLinks[3];
$OrganismDBLink{"Plasmodium_berghei"} = $DBLinks[2];
$OrganismDBLink{"Plasmodium_chabaudi"} = $DBLinks[2];
$OrganismDBLink{"Plasmodium_falciparum"} = $DBLinks[2];
$OrganismDBLink{"Plasmodium_knowlesi"} = $DBLinks[2];
$OrganismDBLink{"Plasmodium_vivax"} = $DBLinks[2];
$OrganismDBLink{"Plasmodium_yoelii"} = $DBLinks[2];
$OrganismDBLink{"Toxoplasma_gondii"} = $DBLinks[3];
$OrganismDBLink{"Trichomonas_vaginalis"} = $DBLinks[4];
$OrganismDBLink{"Leishmania_braziliensis"} = $DBLinks[5];
$OrganismDBLink{"Leishmania_infantum"} = $DBLinks[5];
$OrganismDBLink{"Leishmania_major"} = $DBLinks[5];
$OrganismDBLink{"Trypanosoma_cruzi"} = $DBLinks[5];
$OrganismDBLink{"Trypanosoma_brucei"} = $DBLinks[5];

#initialize all oraganism hashes and arrays
$OrgansimQueryAddress{"Cryptosporidium_hominis"} = \@Cryto_hominis_Queries;
$OrgansimQueryAddress{"Cryptosporidium_muris"} = \@Cryto_muris_Queries;
$OrgansimQueryAddress{"Cryptosporidium_parvum"} = \@Crypto_Parvum_Queries;
$OrgansimQueryAddress{"Giardia_lamblia"} = \@Giardia_lamblia_Queries;
$OrgansimQueryAddress{"Neospora_caninum"} = \@Neospora_caninum_Queries;
$OrgansimQueryAddress{"Plasmodium_berghei"} = \@Plasmodium_bergheii_queries;
$OrgansimQueryAddress{"Plasmodium_chabaudi"} = \@Plasmodium_chabudi_queries;
$OrgansimQueryAddress{"Plasmodium_falciparum"} = \@Plasmodium_falciparum_queries;
$OrgansimQueryAddress{"Plasmodium_knowlesi"} = \@Plasmodium_knowlesii_queries;
$OrgansimQueryAddress{"Plasmodium_vivax"} = \@Plasmodium_vivax_queries;
$OrgansimQueryAddress{"Plasmodium_yoelii"} = \@Plasmodium_yoleii_queries;
$OrgansimQueryAddress{"Toxoplasma_gondii"} = \@Toxoplasma_gondii_queries;
$OrgansimQueryAddress{"Trichomonas_vaginalis"} = \@Trichomonas_vaginalis_queries;
$OrgansimQueryAddress{"Leishmania_braziliensis"} = \@Leishmania_braziliensis_queries;
$OrgansimQueryAddress{"Leishmania_infantum"} = \@Leishmania_infantum_queries;
$OrgansimQueryAddress{"Leishmania_major"} = \@Leishmania_major_queries;
$OrgansimQueryAddress{"Trypanosoma_cruzi"} = \@Trypanosoma_cruzi_queries;
$OrgansimQueryAddress{"Trypanosoma_brucei"} = \@Trypanosoma_brucei_queries;

&GetQueries;


$Category[0]=\%Gene_Count_Total;	$CategoryName[0] = "Gene_Count_Total";
$Category[1]= \%Protein_coding; 	$CategoryName[1] = "Protein_coding";
$Category[2]= \%Other_categories; 	$CategoryName[2] = "Other_categories";
$Category[3]= \%Pseudogenes; 		$CategoryName[3] = "Pseudogenes";
$Category[4]= \%Community_entries; 	$CategoryName[4] = "Community_entries";
$Category[5]= \%Orthologs; 		$CategoryName[5] = "Orthologs";
$Category[6]= \%GO_terms; 		$CategoryName[6] = "GO_terms";
$Category[7]= \%EC_numbers; 		$CategoryName[7] = "EC_numbers";
$Category[8]= \%SNPs; 			$CategoryName[8] = "SNPs";
$Category[9]= \%Expression_Total; 	$CategoryName[9] = "Expression_Total";
$Category[10]= \%Microarray;		$CategoryName[10] = "Microarray";
$Category[11]= \%ESTs; 			$CategoryName[11] = "ESTs";
$Category[12] = \%SAGE_tags; 		$CategoryName[12] = "SAGE_tags";
$Category[13]= \%Proteomics; 		$CategoryName[13] = "Proteomics";
$Category[14]= \%ApiDB_curated; 	$CategoryName[14] = "ApiDB_curated";




#Open XML document
open (output,">>"."$ENV{PROJECT_HOME}"."/ApiCommonData/Model/lib/xml/genemetrics.xml");
print (output "<xmlAnswer>\n");
foreach $OrganismKey(sort SortHashes keys (%OrgansimQueryAddress))
	{
		print("$OrganismKey \n");
		&ReadandExecuteQueries ($OrganismDBLink{$OrganismKey},$OrganismKey,$OrgansimQueryAddress{$OrganismKey});
	}


&PrintDataIntoXML;
print(output "</xmlAnswer>");



sub ReadandExecuteQueries
{
	my($DataBaseLink,$Organism,$OrganismQueryArray) = @_;
	$connectparam = "dbi:Oracle:".$DataBaseLink;
	$dbh = DBI->connect($connectparam,$u,$pw);
        
        my $iteration = 0;
	foreach $sql (@$OrganismQueryArray)
		{
			if ($sql ne "None")
			{
				$sth = $dbh->prepare($sql);
				$sth->execute || die "Could not execute SQL statement!";
				while( @row = $sth->fetchrow_array() )
				 {
		   			print("@row \n");
					$HashforCount = $Category[$iteration];
					$$HashforCount{$Organism} = $row[0];
		   		 }
			}
			else
			{		print("0 \n");
					$HashforCount = $Category[$iteration];
					$$HashforCount{$Organism} = 0;
			}
			
			$iteration++;
		}
               
            
	$HashforCount = $Category[14];
        if ($Organism eq  "Cryptosporidium_parvum")
              {
                  $$HashforCount{$Organism} = 409;
              }
        else
              {
                  $$HashforCount{$Organism} = 0;
              }
}



sub PrintDataIntoXML

{
	my $iteration =0;
	for ($iteration=0; $iteration <= 13; $iteration++)
		{
			if ($iteration == 4)
			   {
				&PrintRecord(14);					
			   }
			
		&PrintRecord($iteration);
		
		}

	
}


sub PrintRecord

{
	my($itemNum) = @_;
	print (output "\n   <record>\n");
	print (output "       <attribute name = \"Metric_Type\">");
	print (output "$CategoryName[$itemNum]");
	print(output "</attribute>\n");
			
	foreach $Organism(sort SortHashes keys (%OrgansimQueryAddress))
		{
 		   print(output  "       <attribute name=\"$Organism\">");
		   $HashforCount = $Category[$itemNum];	
	           
                   print(output $$HashforCount{$Organism});
	           print(output "</attribute>\n");
		}

	print(output "   </record>\n");		
}



sub SortHashes

	{
       
 	$OrgansimQueryAddress{$a} cmp $OrgansimQueryAddress{$b};

	}












# WORK IN PROGRESS TO REDUCE BOTH THE NUMBER AND THE REDUNDANCY OF THE QUERIES.
# ANOTHER MODIFICATION IS TO AUTOMATE THE FETCHING AND SUBSTITUTION OF TAXON IDS AND SEQUENCE ONTOLOGY IDS







sub GetQueries
{

	$Crypto_Parvum_Queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458871";

	$Crypto_Parvum_Queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458871";

	$Crypto_Parvum_Queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458871";

	$Crypto_Parvum_Queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458871  AND gf.is_pseudo = 1";

	$Crypto_Parvum_Queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 458871 AND gf.source_id = ga.source_id AND ga.project_id = 'CryptoDB'";

	$Crypto_Parvum_Queries[5] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = gf.source_id  and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458871";

	$Crypto_Parvum_Queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t, dots.TranslatedAaFeature taf, dots.GoAssociation ga  WHERE ens.taxon_id IN (458871)  AND ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id   AND t.na_feature_id = taf.na_feature_id  AND taf.aa_sequence_id = ga.row_id)";

	$Crypto_Parvum_Queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.taxon_id in (458871)
			              AND gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id)";

	$Crypto_Parvum_Queries[8] = "select count(distinct gf.source_id) from dots.snpfeature sf,dots.nasequence ens, dots.genefeature gf where sf.parent_id = gf.na_feature_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458871";


	$Crypto_Parvum_Queries[9] = "select count(*) from 
(SELECT s.gene as source_id
                                        FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e, dots.GeneFeature gf, dots.nasequence ens
                                         where s.est_gene_overlap_length >= 100 
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20 
                                        AND s.percent_identity >= 90 
                                        AND e.best_alignment_count <= 1 
                                        and e.source_id = s.accession
                                        AND s.accession != 'AA555437'         
					and s.gene = gf.source_id and gf.na_sequence_id = ens.na_sequence_id 
                                        and ens.taxon_id = 458871 
                                        GROUP by s.gene 
                                        HAVING count(*) >= 1
UNION
select distinct gf.source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and nas.taxon_id in (458871)
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id)";

	$Crypto_Parvum_Queries[10] = "None";

	$Crypto_Parvum_Queries[11] = "select count(*) from (SELECT s.gene as source_id
                                        FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e, dots.GeneFeature gf, dots.nasequence ens
                                         where s.est_gene_overlap_length >= 100 
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20 
                                        AND s.percent_identity >= 90 
                                        AND e.best_alignment_count <= 1 
                                        and e.source_id = s.accession
                                        AND s.accession != 'AA555437'         
					and s.gene = gf.source_id and gf.na_sequence_id = ens.na_sequence_id  
                                        and ens.taxon_id = 458871
                                        GROUP by s.gene 
                                        HAVING count(*) >= 1)";


	$Crypto_Parvum_Queries[12] = "None";


	$Crypto_Parvum_Queries[13] = "select count(*) from (select distinct gf.source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and nas.taxon_id in (458871)
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id )";


       $Cryto_muris_Queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 459129"; 

       $Cryto_muris_Queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 459129";

       $Cryto_muris_Queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 459129";

       $Cryto_muris_Queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 459129  AND gf.is_pseudo = 1";

       $Cryto_muris_Queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 459129 AND gf.source_id = ga.source_id AND ga.project_id = 'CryptoDB'";

       $Cryto_muris_Queries[5] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = gf.source_id  and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 459129";

       $Cryto_muris_Queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t, dots.TranslatedAaFeature taf, dots.GoAssociation ga WHERE ens.taxon_id IN (459129)  AND ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id   AND t.na_feature_id = taf.na_feature_id AND taf.aa_sequence_id = ga.row_id)";
       
       $Cryto_muris_Queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.taxon_id in (459129)
			              AND gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id)";

       $Cryto_muris_Queries[8] = "select count(distinct gf.source_id) from dots.snpfeature sf,dots.nasequence ens, dots.genefeature gf where sf.parent_id = gf.na_feature_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 459129";

       $Cryto_muris_Queries[9] = "select count(*) from 
                                        (SELECT s.gene as source_id
                                        FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e, dots.GeneFeature gf, dots.nasequence ens
                                         where s.est_gene_overlap_length >= 100 
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20 
                                        AND s.percent_identity >= 90 
                                        AND e.best_alignment_count <= 1 
                                        and e.source_id = s.accession
                                        AND s.accession != 'AA555437'         
                                        and s.gene = gf.source_id 
                                        and gf.na_sequence_id = ens.na_sequence_id  
                                        and ens.taxon_id = 459129 
                                       GROUP by s.gene 
                                        HAVING count(*) >= 1
                                        UNION
                                        select distinct gf.source_id 
                                           from apidb.massspecsummary mss,
                                                  dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
                                                 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
                                            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
                                              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
                                                from apidb.massspecsummary mss,
                                                     dots.massspecfeature msf,
                                                     dots.aalocation aal,
                                                     sres.externaldatabase ed,
                                                     sres.externaldatabaserelease edr
                                                where mss.mass_spec_summary_id = msf.source_id
                                                  and msf.aa_feature_id = aal.aa_feature_id
                                                  and msf.external_database_release_id = edr.external_database_release_id
                                                  and edr.external_database_id = ed.external_database_id
                                                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
                                                group by intseq.aa_sequence_id
                                                having count(*) >= 1
                                            ) seq,
                                            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
                                                from apidb.massspecsummary mss,
                                                     sres.externaldatabase ed,
                                                     sres.externaldatabaserelease edr
                                                where mss.external_database_release_id = edr.external_database_release_id
                                                  and edr.external_database_id = ed.external_database_id
                                                group by mss.aa_sequence_id
                                                having sum(spectrum_count) >= 1
                                            ) spec,
                                            dots.nasequence nas
                                            where mss.aa_sequence_id = taaf.aa_sequence_id
                                            and taaf.na_feature_id = t.na_feature_id
                                            and t.parent_id = gf.na_feature_id
                                            and gf.na_sequence_id = nas.na_sequence_id
                                            and nas.taxon_id in (459129)                
                                            and mss.aa_sequence_id = seq.aa_sequence_id
                                            and mss.aa_sequence_id = spec.aa_sequence_id)";

       $Cryto_muris_Queries[10] = "None";


       $Cryto_muris_Queries[11] = "select count(*) from (SELECT s.gene as source_id
                                        FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e, 
                                        dots.GeneFeature gf, dots.nasequence ens
                                         where s.est_gene_overlap_length >= 100 
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20 
                                        AND s.percent_identity >= 90 
                                        AND e.best_alignment_count <= 1 
                                        and e.source_id = s.accession        
					and s.gene = gf.source_id 
					and gf.na_sequence_id = ens.na_sequence_id
				        and ens.taxon_id = 459129
                                        GROUP by s.gene 
                                        HAVING count(*) >= 1)";
 

       $Cryto_muris_Queries[12] = "None";

       $Cryto_muris_Queries[13] = "select count(*) from (select distinct gf.source_id
                                            from apidb.massspecsummary mss, 
                                                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
                                                 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
                                            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
                                              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
                                                from apidb.massspecsummary mss,
                                                     dots.massspecfeature msf,
                                                     dots.aalocation aal,
                                                     sres.externaldatabase ed,
                                                     sres.externaldatabaserelease edr
                                                where mss.mass_spec_summary_id = msf.source_id                                                  
                                                and msf.aa_feature_id = aal.aa_feature_id
                                                  and msf.external_database_release_id = edr.external_database_release_id
                                                  and edr.external_database_id = ed.external_database_id
                                                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
                                                group by intseq.aa_sequence_id
                                                having count(*) >= 1
                                            ) seq,
                                            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
                                                from apidb.massspecsummary mss,
                                                     sres.externaldatabase ed,
                                                     sres.externaldatabaserelease edr
                                                where mss.external_database_release_id = edr.external_database_release_id
                                                  and edr.external_database_id = ed.external_database_id                                                
                                                  group by mss.aa_sequence_id
                                                having sum(spectrum_count) >= 1
                                            ) spec,
                                            dots.nasequence nas
                                            where mss.aa_sequence_id = taaf.aa_sequence_id
                                            and taaf.na_feature_id = t.na_feature_id                                            
                                            and t.parent_id = gf.na_feature_id
                                            and gf.na_sequence_id = nas.na_sequence_id
                                            and nas.taxon_id in (459129)                                            
                                            and mss.aa_sequence_id = seq.aa_sequence_id
                                            and mss.aa_sequence_id = spec.aa_sequence_id )";







	$Cryto_hominis_Queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458868 AND gf.source_id = ga.source_id AND ga.project_id = 'CryptoDB'";

	$Cryto_hominis_Queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458868 AND gf.source_id = ga.source_id AND ga.project_id = 'CryptoDB'";

	$Cryto_hominis_Queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458868 AND gf.source_id = ga.source_id AND ga.project_id = 'CryptoDB'";

	$Cryto_hominis_Queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 458868 AND gf.source_id = ga.source_id AND ga.project_id = 'CryptoDB' AND gf.is_pseudo = 1";

	$Cryto_hominis_Queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 458868 AND gf.source_id = ga.source_id AND ga.project_id = 'CryptoDB'";

	$Cryto_hominis_Queries[5] = "select count(*) from apidb.phylogeneticprofile where substr(source_id,0,2) = 'Ch'";

	$Cryto_hominis_Queries[6] = "select count(*) from (select distinct s.source_id as id from dots.goassociation ga, dots.translatedaasequence s where ga.row_id = s.aa_sequence_id and substr(s.source_id,0,2) in ('Ch'))";

	$Cryto_hominis_Queries[7] = "select count(*) from (select distinct s.source_id as id from dots.aaSequenceEnzymeClass e, dots.aasequence s where s.aa_sequence_id = e.aa_sequence_id and substr(s.source_id,0,2) in ('Ch'))";

	$Cryto_hominis_Queries[8] = "None";
	$Cryto_hominis_Queries[9] = "None";
	$Cryto_hominis_Queries[10] = "None";
	$Cryto_hominis_Queries[11] = "None";
	$Cryto_hominis_Queries[12] = "None";
	$Cryto_hominis_Queries[13] = "None";




	$Neospora_caninum_Queries[0] ="select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 14204 AND gf.source_id = ga.source_id AND ga.project_id = 'ToxoDB'";

	$Neospora_caninum_Queries[1] ="select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 14204 AND gf.source_id = ga.source_id AND ga.project_id = 'ToxoDB'";

	$Neospora_caninum_Queries[2] ="select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 14204 AND gf.source_id = ga.source_id AND ga.project_id = 'ToxoDB'";

	$Neospora_caninum_Queries[3] ="select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 14204 AND gf.source_id = ga.source_id AND ga.project_id = 'ToxoDB' AND gf.is_pseudo = 1";

	$Neospora_caninum_Queries[4] ="select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 14204 AND gf.source_id = ga.source_id AND ga.project_id = 'ToxoDB'";

	$Neospora_caninum_Queries[5] ="select count (*) from (select substr(source_id,0,2) from apidb.phylogeneticprofile where substr(source_id,0,2) = 'NC')";

	$Neospora_caninum_Queries[6] ="select count(*) from (select distinct s.source_id as id from dots.goassociation ga, dots.translatedaasequence s where ga.row_id = s.aa_sequence_id and substr(s.source_id,0,2) = 'NC')";

	$Neospora_caninum_Queries[7] ="select count(*) from (select distinct s.source_id from dots.aaSequenceEnzymeClass e, dots.aasequence s where s.aa_sequence_id = e.aa_sequence_id and substr(s.source_id,0,2) = 'NC')";

	$Neospora_caninum_Queries[8] ="None";

	$Neospora_caninum_Queries[9] = "select count(*) from
(select distinct gf.source_id as source_id
		from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
		where c.na_sequence_id = t.na_sequence_id
		and gf.na_feature_id = t.parent_id
		and  substr(gf.source_id,0,2) in  ('NC')
UNION
SELECT s.gene as source_id
                       FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                       where s.est_gene_overlap_length >= 100
                       AND s.is_best_alignment in (1)
                       AND s.percent_est_bases_aligned >= 20
                       AND s.percent_identity >= 90
                       AND e.best_alignment_count <= 1
                       and s.target_taxon_id in (14204)
                       and e.source_id = s.accession
                       GROUP by s.gene
                       HAVING count(*) >= 1)";

	$Neospora_caninum_Queries[10] ="select count(*)
from (select distinct gf.source_id
from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
where c.na_sequence_id = t.na_sequence_id
and gf.na_feature_id = t.parent_id)
where substr(source_id,0,2) in  ('NC')";

	$Neospora_caninum_Queries[11] ="select count(*) from (SELECT s.gene as source_id
                                                    FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and s.target_taxon_id in (14204)
                                                and e.source_id = s.accession
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)";

	$Neospora_caninum_Queries[12] ="None";

	$Neospora_caninum_Queries[13] ="None";




	$Giardia_lamblia_Queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 107023 AND gf.source_id = ga.source_id and ga.is_deprecated = '0'";

	$Giardia_lamblia_Queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 107023 AND gf.source_id = ga.source_id and ga.is_deprecated = '0'";

	$Giardia_lamblia_Queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 107023 AND gf.source_id = ga.source_id and ga.is_deprecated = '0'";

	$Giardia_lamblia_Queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,12,573,578,663) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 107023 AND gf.source_id = ga.source_id and ga.is_deprecated = '0' AND gf.is_pseudo = 1";

	$Giardia_lamblia_Queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = ga.source_id and ga.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 107023 and ga.is_deprecated = '0'";

	$Giardia_lamblia_Queries[5] = "select count(*) from apidb.geneattributes ga, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = ga.source_id  and ga.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 107023 and ga.is_deprecated = '0'";

	$Giardia_lamblia_Queries[6] = "select count(*) from (select distinct ga.source_id from dots.NaSequence ens, dots.Transcript t,apidb.geneattributes ga, dots.TranslatedAaFeature taf, dots.GoAssociation go  WHERE ens.taxon_id IN (107023)  AND ens.na_sequence_id = ga.na_sequence_id  AND ga.na_feature_id = t.parent_id  AND t.na_feature_id = taf.na_feature_id  AND taf.aa_sequence_id = go.row_id and ga.is_deprecated = '0')";

	$Giardia_lamblia_Queries[7] = "select count(*) from (select distinct ga.source_id FROM apidb.geneattributes ga, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.taxon_id in (107023)
			              AND gs.na_sequence_id = ga.na_sequence_id
			              AND ga.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id and ga.is_deprecated = '0')";

	$Giardia_lamblia_Queries[8] = "select count(distinct ga.source_id) from dots.snpfeature sf,dots.nasequence ens, apidb.geneattributes ga where sf.parent_id = ga.na_feature_id and ga.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 107023 and ga.is_deprecated = '0'";

	$Giardia_lamblia_Queries[9] = "select count(*) from
(select g.source_id AS source_id
				            from rad.DIFFERENTIALEXPRESSION de, Core.TABLEINFO ti, 
				                 rad.COMPOSITEELEMENTNASEQUENCE cs, dots.TRANSCRIPT t, dots.GENEFEATURE g, apidb.geneattributes ga
				            where ti.name = 'ShortOligoFamily'
				              and de.table_id = ti.table_id
				              and de.row_id = cs.composite_element_id
				              and cs.na_sequence_id = t.na_sequence_id
				              and t.parent_id = g.na_feature_id
					      and g.source_id = ga.source_id and ga.is_deprecated = '0'
				              and de.analysis_id in (select a.analysis_id as analysis_id
				            from rad.ANALYSIS a, rad.PROTOCOL p
				            where p.protocol_id = a.protocol_id
				            and p.name = 'PaGE')
				              AND de.confidence >= 0.8
				              AND (abs (de.fold_change) >= 2)
				             group by g.source_id
UNION
SELECT s.gene as source_id
                                            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e, apidb.geneattributes ga
                                         where s.est_gene_overlap_length >= 100 
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20 
                                        AND s.percent_identity >= 90 
                                        AND e.best_alignment_count <= 1 
                                        and e.source_id = s.accession
					and s.gene = ga.source_id and ga.is_deprecated = '0'     
                                        GROUP by s.gene 
                                        HAVING count(*) >= 1
UNION
select source_id from ((select gene_source_id as source_id  from 
                                                         (select stg.gene_source_id, stg.tag_source_id,
                                                                 stg.sense_count, stg.antisense_count
                                                          from apidb.SageTagGene stg
                                                          where stg.occurrence <= 2
                                                          and ((stg.direction = '5' and stg.distance <= 0)
                                                             OR (stg.direction = '3' and stg.distance <= 0))
                                                          group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                                       ), apidb.geneattributes ga
							 where  gene_source_id =  ga.source_id and ga.is_deprecated = '0' 
                                                       group by gene_source_id having sum(sense_count) >= 1)
union
(select gene_source_id as source_id  from 
                                                         (select stg.gene_source_id, stg.tag_source_id,
                                                                 stg.sense_count, stg.antisense_count
                                                          from apidb.SageTagGene stg
                                                          where stg.occurrence <= 2
                                                          and ((stg.direction = '5' and stg.distance <= 0)
                                                             OR (stg.direction = '3' and stg.distance <= 0))
                                                          group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                                       ), apidb.geneattributes ga
							 where  gene_source_id =  ga.source_id and ga.is_deprecated = '0' 
                                                       group by gene_source_id having sum(antisense_count) >= 1)
union
(select gene_source_id as source_id	         from (
					         select g.gene_source_id, aa.library_name, library_count.n as ni, f.frequency as fj, sum(aa.raw_count) as xij
					         from apidb.SAGETAGANALYSISATTRIBUTES aa, 
					              apidb.SAGETAGATTRIBUTES a,apidb.geneattributes ga,
					              (select distinct gene_source_id, tag_feature_id, antisense 
					               from apidb.SAGETAGGENE 
					               where ((direction = '5' and distance <= 0) OR (direction = '3' and distance <= 0))
					               ) g,
					              (select g.gene_source_id, sum(aa.raw_count) / max(n.n) as frequency
					               from apidb.SAGETAGANALYSISATTRIBUTES aa, 
					               apidb.SAGETAGATTRIBUTES a,
					               (select distinct gene_source_id, tag_feature_id, antisense 
					                from apidb.SAGETAGGENE
					                where ((direction = '5' and distance <= 0) OR (direction = '3' and distance <= 0))
					                ) g,
					               (select sum(max(total_raw_count)) as n
					                from apidb.SAGETAGANALYSISATTRIBUTES
					                group by library_name) n
					               where g.tag_feature_id = a.na_feature_id
					                and g.antisense = 0
					                and aa.composite_element_id = a.composite_element_id
					               group by g.gene_source_id) f,
					              (select library_name, max(total_raw_count) as n
					               from apidb.SAGETAGANALYSISATTRIBUTES
					               group by library_name) library_count
					         where g.tag_feature_id = a.na_feature_id
					          and g.antisense = 0
					          and aa.composite_element_id = a.composite_element_id
					          and g.gene_source_id = f.gene_source_id
						  and f.gene_source_id =  ga.source_id and ga.is_deprecated = '0' 
					          and aa.library_name = library_count.library_name
					         group by g.gene_source_id, aa.library_name, library_count.n, f.frequency
					         )
					       group by gene_source_id
					       having sum(xij * log(10, (xij/(Ni * fj)))) >  10))
UNION
select distinct ga.source_id as source_id
                                                    from apidb.massspecsummary mss, 
                                                    dots.translatedaafeature taaf, dots.transcript t, apidb.geneattributes ga, dots.GeneFeature gf,
                                                    sres.externalDatabase ed, sres.externalDatabaseRelease edr,
                                                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count
                                                       from (select mss.aa_sequence_id, count(*) as sum_seq_ct
                                                        from apidb.massspecsummary mss,
                                                             dots.massspecfeature msf, 
                                                             dots.aalocation aal,
                                                             sres.externaldatabase ed,
                                                             sres.externaldatabaserelease edr 
                                                         where mss.mass_spec_summary_id = msf.source_id
                                                          and msf.aa_feature_id = aal.aa_feature_id 
                                                          and msf.external_database_release_id = edr.external_database_release_id
                                                          and edr.external_database_id = ed.external_database_id 
                                                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
                                                        group by intseq.aa_sequence_id
                                                        having count(*) >= 1 ) seq,
                                                       (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count 
                                                       from apidb.massspecsummary mss,
                                                            sres.externaldatabase ed,
                                                            sres.externaldatabaserelease edr 
                                                       where mss.external_database_release_id = edr.external_database_release_id                  
                                                            and edr.external_database_id = ed.external_database_id 
                                                       group by mss.aa_sequence_id                
                                                       having sum(spectrum_count) >= 1            ) spec
                                                    where mss.aa_sequence_id = taaf.aa_sequence_id     
                                                    and taaf.na_feature_id = t.na_feature_id            
                                                   and t.parent_id = gf.na_feature_id
                                                    and gf.external_database_release_id = edr.external_database_release_id
                                                    and edr.external_database_id = ed.external_database_id          
                                                   and mss.aa_sequence_id = seq.aa_sequence_id            
                                                   and mss.aa_sequence_id = spec.aa_sequence_id and gf.source_id= ga.source_id and ga.is_deprecated = '0')";

	$Giardia_lamblia_Queries[10] = "select count(*) from (select g.source_id
				            from rad.DIFFERENTIALEXPRESSION de, Core.TABLEINFO ti, 
				                 rad.COMPOSITEELEMENTNASEQUENCE cs, dots.TRANSCRIPT t, dots.GENEFEATURE g, apidb.geneattributes ga
				            where ti.name = 'ShortOligoFamily'
				              and de.table_id = ti.table_id
				              and de.row_id = cs.composite_element_id
				              and cs.na_sequence_id = t.na_sequence_id
				              and t.parent_id = g.na_feature_id
					      and g.source_id = ga.source_id and ga.is_deprecated = '0'
				              and de.analysis_id in (select a.analysis_id as analysis_id
				            from rad.ANALYSIS a, rad.PROTOCOL p
				            where p.protocol_id = a.protocol_id
				            and p.name = 'PaGE')
				              AND de.confidence >= 0.8
				              AND (abs (de.fold_change) >= 2)
				             group by g.source_id)";

	$Giardia_lamblia_Queries[11] = "select count (*) from (SELECT s.gene as source_id, 'GiardiaDB' as project_id, count(*) as number_of_ests
                                            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e, apidb.geneattributes ga
                                         where s.est_gene_overlap_length >= 100 
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20 
                                        AND s.percent_identity >= 90 
                                        AND e.best_alignment_count <= 1 
                                        and e.source_id = s.accession
					and s.gene = ga.source_id and ga.is_deprecated = '0'     
                                        GROUP by s.gene 
                                        HAVING count(*) >= 1)";

	$Giardia_lamblia_Queries[12] = "select count(*) from ((select gene_source_id as source_id  from 
                                                         (select stg.gene_source_id, stg.tag_source_id,
                                                                 stg.sense_count, stg.antisense_count
                                                          from apidb.SageTagGene stg
                                                          where stg.occurrence <= 2
                                                          and ((stg.direction = '5' and stg.distance <= 0)
                                                             OR (stg.direction = '3' and stg.distance <= 0))
                                                          group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                                       ), apidb.geneattributes ga
							 where  gene_source_id =  ga.source_id and ga.is_deprecated = '0' 
                                                       group by gene_source_id having sum(sense_count) >= 1)
union
(select gene_source_id as source_id  from 
                                                         (select stg.gene_source_id, stg.tag_source_id,
                                                                 stg.sense_count, stg.antisense_count
                                                          from apidb.SageTagGene stg
                                                          where stg.occurrence <= 2
                                                          and ((stg.direction = '5' and stg.distance <= 0)
                                                             OR (stg.direction = '3' and stg.distance <= 0))
                                                          group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                                       ), apidb.geneattributes ga
							 where  gene_source_id =  ga.source_id and ga.is_deprecated = '0' 
                                                       group by gene_source_id having sum(antisense_count) >= 1)
union
(select gene_source_id as source_id	         from (
					         select g.gene_source_id, aa.library_name, library_count.n as ni, f.frequency as fj, sum(aa.raw_count) as xij
					         from apidb.SAGETAGANALYSISATTRIBUTES aa, 
					              apidb.SAGETAGATTRIBUTES a,apidb.geneattributes ga,
					              (select distinct gene_source_id, tag_feature_id, antisense 
					               from apidb.SAGETAGGENE 
					               where ((direction = '5' and distance <= 0) OR (direction = '3' and distance <= 0))
					               ) g,
					              (select g.gene_source_id, sum(aa.raw_count) / max(n.n) as frequency
					               from apidb.SAGETAGANALYSISATTRIBUTES aa, 
					               apidb.SAGETAGATTRIBUTES a,
					               (select distinct gene_source_id, tag_feature_id, antisense 
					                from apidb.SAGETAGGENE
					                where ((direction = '5' and distance <= 0) OR (direction = '3' and distance <= 0))
					                ) g,
					               (select sum(max(total_raw_count)) as n
					                from apidb.SAGETAGANALYSISATTRIBUTES
					                group by library_name) n
					               where g.tag_feature_id = a.na_feature_id
					                and g.antisense = 0
					                and aa.composite_element_id = a.composite_element_id
					               group by g.gene_source_id) f,
					              (select library_name, max(total_raw_count) as n
					               from apidb.SAGETAGANALYSISATTRIBUTES
					               group by library_name) library_count
					         where g.tag_feature_id = a.na_feature_id
					          and g.antisense = 0
					          and aa.composite_element_id = a.composite_element_id
					          and g.gene_source_id = f.gene_source_id
						  and f.gene_source_id =  ga.source_id and ga.is_deprecated = '0' 
					          and aa.library_name = library_count.library_name
					         group by g.gene_source_id, aa.library_name, library_count.n, f.frequency
					         )
					       group by gene_source_id
					       having sum(xij * log(10, (xij/(Ni * fj)))) >  10))";


	$Giardia_lamblia_Queries[13] = "select count(*) from (select distinct ga.source_id
                                                    from apidb.massspecsummary mss, 
                                                    dots.translatedaafeature taaf, dots.transcript t, apidb.geneattributes ga, dots.GeneFeature gf,
                                                    sres.externalDatabase ed, sres.externalDatabaseRelease edr,
                                                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count
                                                       from (select mss.aa_sequence_id, count(*) as sum_seq_ct
                                                        from apidb.massspecsummary mss,
                                                             dots.massspecfeature msf, 
                                                             dots.aalocation aal,
                                                             sres.externaldatabase ed,
                                                             sres.externaldatabaserelease edr 
                                                         where mss.mass_spec_summary_id = msf.source_id
                                                          and msf.aa_feature_id = aal.aa_feature_id 
                                                          and msf.external_database_release_id = edr.external_database_release_id
                                                          and edr.external_database_id = ed.external_database_id 
                                                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
                                                        group by intseq.aa_sequence_id
                                                        having count(*) >= 1 ) seq,
                                                       (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count 
                                                       from apidb.massspecsummary mss,
                                                            sres.externaldatabase ed,
                                                            sres.externaldatabaserelease edr 
                                                       where mss.external_database_release_id = edr.external_database_release_id                  
                                                            and edr.external_database_id = ed.external_database_id 
                                                       group by mss.aa_sequence_id                
                                                       having sum(spectrum_count) >= 1            ) spec
                                                    where mss.aa_sequence_id = taaf.aa_sequence_id     
                                                    and taaf.na_feature_id = t.na_feature_id            
                                                   and t.parent_id = gf.na_feature_id
                                                    and gf.external_database_release_id = edr.external_database_release_id
                                                    and edr.external_database_id = ed.external_database_id          
                                                   and mss.aa_sequence_id = seq.aa_sequence_id            
                                                   and mss.aa_sequence_id = spec.aa_sequence_id and gf.source_id= ga.source_id and ga.is_deprecated = '0')";







	$Plasmodium_bergheii_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17949 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_bergheii_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17949 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_bergheii_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17949 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_bergheii_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17949 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' AND gf.is_pseudo = 1";

	$Plasmodium_bergheii_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 17949 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_bergheii_queries[5] = "select count (*) from (select substr(source_id,0,2) from apidb.phylogeneticprofile where substr(source_id,0,2) = 'PB')";

	$Plasmodium_bergheii_queries[6] = "select count(*) from (select distinct s.source_id as id from dots.goassociation ga, dots.translatedaasequence s where ga.row_id = s.aa_sequence_id and substr(s.source_id,0,2) = 'PB')";

	$Plasmodium_bergheii_queries[7] = "select count(*) from (select distinct s.source_id from dots.aaSequenceEnzymeClass e, dots.aasequence s where s.aa_sequence_id = e.aa_sequence_id and substr(s.source_id,0,2) = 'PB')";

	$Plasmodium_bergheii_queries[8] = "None";

	$Plasmodium_bergheii_queries[9] = "select count(*) from
					(SELECT source_id from ((SELECT DISTINCT fred.source_id as source_id from(
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'R'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100
					          INTERSECT
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'YT'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100
					          INTERSECT
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'YS'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100
					          INTERSECT
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'MS'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100 ) fred)
					 UNION
					(SELECT ga.gene as source_id
					            FROM Rad.LogicalGroup lg,
					                 Rad.AnalysisInput ai,
					                 Rad.Analysis a, 
					                 RAD.DifferentialExpression de, 
					                 Rad.ShortOligoFamily sof,
					                 Rad.Protocol p, 
					                 Rad.ProtocolParam pp, 
					                 Rad.AnalysisParam ap,
					                 ApiDB.GeneAlias ga
					            WHERE lg.name = 'DOZI mutant vs. Wild Type - Loess Normalized Analyses'
					             AND ai.logical_group_id = lg.logical_group_id 
					             AND a.analysis_id = ai.analysis_id
					             AND de.analysis_id = a.analysis_id
					             AND sof.composite_element_id = de.row_id
					             AND sof.source_id is not null
					             AND ga.alias = sof.source_id
					             AND p.name = 'PaGE'
					             AND a.protocol_id = p.protocol_id
					             AND pp.protocol_id = p.protocol_id
					             AND pp.name = 'reference_condition'
					             AND ap.protocol_param_id = pp.protocol_param_id
					             AND a.analysis_id = ap.analysis_id
					             AND de.confidence >= 0.8
					             AND ( abs (de.fold_change) ) >= 2
					             GROUP BY ga.gene))
UNION
SELECT s.gene as source_id
					            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
						 where s.est_gene_overlap_length >= 100 
						AND s.is_best_alignment in (1)
						AND s.percent_est_bases_aligned >= 20 
						AND s.percent_identity >= 90 
						AND e.best_alignment_count <= 1 
						and s.target_taxon_id in (17949)
						and e.source_id = s.accession           
						GROUP by s.gene 
						HAVING count(*) >= 1
UNION
select source_id from 
((select distinct gf.source_id as source_id
				            from apidb.massspecsummary mss, 
				                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
						 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
				            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
				              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
				                from apidb.massspecsummary mss,
				                     dots.massspecfeature msf,
				                     dots.aalocation aal,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.mass_spec_summary_id = msf.source_id
				                  and msf.aa_feature_id = aal.aa_feature_id
				                  and msf.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
				                group by intseq.aa_sequence_id
				                having count(*) >= 1
				            ) seq,
				            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
				                from apidb.massspecsummary mss,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id
				                having sum(spectrum_count) >= 1
				            ) spec,
				            dots.nasequence nas
				            where mss.aa_sequence_id = taaf.aa_sequence_id
				            and taaf.na_feature_id = t.na_feature_id
				            and t.parent_id = gf.na_feature_id
				            and gf.na_sequence_id = nas.na_sequence_id
				            and nas.taxon_id in (17949)
				            and mss.aa_sequence_id = seq.aa_sequence_id
				            and mss.aa_sequence_id = spec.aa_sequence_id)
union
(SELECT DISTINCT pb.source_id as source_id FROM
				            (SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 1 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 2 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 3 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 4 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 5 AND ('any' = 'any' OR
				                                           pe.value = 'any'))) pb)))";

	$Plasmodium_bergheii_queries[10] = "SELECT COUNT(source_id) from ((SELECT DISTINCT fred.source_id as source_id from(
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'R'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100
					          INTERSECT
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'YT'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100
					          INTERSECT
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'YS'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100
					          INTERSECT
					            SELECT p.source_id
					            FROM apidb.profileElementName pen,
					                 apidb.profileSet ps,
					                 apidb.profile p,
					                 apidb.profileElement pe
					            WHERE ps.name LIKE 'Waters HP% Percents Averaged'
					              AND p.profile_set_id = ps.profile_set_id
					              AND pe.profile_id = p.profile_id
					              AND pen.element_order = pe.element_order
					              AND pen.name = 'MS'
					              AND ps.profile_set_id = pen.profile_set_id
					              AND pe.value >= 0/100
					              AND pe.value <= 100/100 ) fred)
					 UNION
					(SELECT ga.gene as source_id
					            FROM Rad.LogicalGroup lg,
					                 Rad.AnalysisInput ai,
					                 Rad.Analysis a, 
					                 RAD.DifferentialExpression de, 
					                 Rad.ShortOligoFamily sof,
					                 Rad.Protocol p, 
					                 Rad.ProtocolParam pp, 
					                 Rad.AnalysisParam ap,
					                 ApiDB.GeneAlias ga
					            WHERE lg.name = 'DOZI mutant vs. Wild Type - Loess Normalized Analyses'
					             AND ai.logical_group_id = lg.logical_group_id 
					             AND a.analysis_id = ai.analysis_id
					             AND de.analysis_id = a.analysis_id
					             AND sof.composite_element_id = de.row_id
					             AND sof.source_id is not null
					             AND ga.alias = sof.source_id
					             AND p.name = 'PaGE'
					             AND a.protocol_id = p.protocol_id
					             AND pp.protocol_id = p.protocol_id
					             AND pp.name = 'reference_condition'
					             AND ap.protocol_param_id = pp.protocol_param_id
					             AND a.analysis_id = ap.analysis_id
					             AND de.confidence >= 0.8
					             AND ( abs (de.fold_change) ) >= 2
					             GROUP BY ga.gene))";

	$Plasmodium_bergheii_queries[11] = "select count (*) from (SELECT s.gene as source_id, 'PlasmoDB' as project_id, count(*) as number_of_ests
					            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
						 where s.est_gene_overlap_length >= 100 
						AND s.is_best_alignment in (1)
						AND s.percent_est_bases_aligned >= 20 
						AND s.percent_identity >= 90 
						AND e.best_alignment_count <= 1 
						and s.target_taxon_id in (17949)
						and e.source_id = s.accession           
						GROUP by s.gene 
						HAVING count(*) >= 1)";


	$Plasmodium_bergheii_queries[12] = "None";

	$Plasmodium_bergheii_queries[13] = "select count(*) from 
((select distinct gf.source_id as source_id
				            from apidb.massspecsummary mss, 
				                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
						 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
				            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
				              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
				                from apidb.massspecsummary mss,
				                     dots.massspecfeature msf,
				                     dots.aalocation aal,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.mass_spec_summary_id = msf.source_id
				                  and msf.aa_feature_id = aal.aa_feature_id
				                  and msf.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
				                group by intseq.aa_sequence_id
				                having count(*) >= 1
				            ) seq,
				            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
				                from apidb.massspecsummary mss,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id
				                having sum(spectrum_count) >= 1
				            ) spec,
				            dots.nasequence nas
				            where mss.aa_sequence_id = taaf.aa_sequence_id
				            and taaf.na_feature_id = t.na_feature_id
				            and t.parent_id = gf.na_feature_id
				            and gf.na_sequence_id = nas.na_sequence_id
				            and nas.taxon_id in (17949)
				            and mss.aa_sequence_id = seq.aa_sequence_id
				            and mss.aa_sequence_id = spec.aa_sequence_id)
union
(SELECT DISTINCT pb.source_id as source_id FROM
				            (SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 1 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 2 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 3 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 4 AND ('any' = 'any' OR
				                                           pe.value = 'any'))
				            INTERSECT
				            SELECT p.source_id
				            FROM apidb.profileElement pe, apidb.profile p, apidb.profileset ps
				            WHERE pe.profile_id = p.profile_id
				            AND   p.profile_set_id = ps.profile_set_id
				            AND   ps.name = 'berghei_proteomic_Sinden'
				            AND (pe.element_order = 5 AND ('any' = 'any' OR
				                                           pe.value = 'any'))) pb))";








	$Plasmodium_chabudi_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17956 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_chabudi_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17956 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";	

	$Plasmodium_chabudi_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17956 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_chabudi_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17956 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' AND gf.is_pseudo = 1";

	$Plasmodium_chabudi_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 17956 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_chabudi_queries[5] = "select count (*) from (select substr(source_id,0,2) from apidb.phylogeneticprofile where substr(source_id,0,2) = 'PC')";

	$Plasmodium_chabudi_queries[6] = "select count(*) from (select distinct s.source_id as id from dots.goassociation ga, dots.translatedaasequence s where ga.row_id = s.aa_sequence_id and substr(s.source_id,0,2) = 'PC')";

	$Plasmodium_chabudi_queries[7] = "select count(*) from (select distinct s.source_id from dots.aaSequenceEnzymeClass e, dots.aasequence s where s.aa_sequence_id = e.aa_sequence_id and substr(s.source_id,0,2) = 'PC')";

	$Plasmodium_chabudi_queries[8] = "None";

	$Plasmodium_chabudi_queries[9] = "select count(*) from 
(select distinct gf.source_id as source_id
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id
				              and substr(gf.source_id,0,2) = 'PC'
UNION
SELECT s.gene as source_id
					            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
						 where s.est_gene_overlap_length >= 100 
						AND s.is_best_alignment in (1)
						AND s.percent_est_bases_aligned >= 20 
						AND s.percent_identity >= 90 
						AND e.best_alignment_count <= 1 
						and s.target_taxon_id in (17956)
						and e.source_id = s.accession           
						GROUP by s.gene 
						HAVING count(*) >= 1
UNION
select source_id from (select distinct gf.source_id as source_id, seq.sum_sequence_count, spec.sum_spectrum_count
				            from apidb.massspecsummary mss, 
				                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
						 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
				            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
				              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
				                from apidb.massspecsummary mss,
				                     dots.massspecfeature msf,
				                     dots.aalocation aal,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.mass_spec_summary_id = msf.source_id
				                  and msf.aa_feature_id = aal.aa_feature_id
				                  and msf.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
				                group by intseq.aa_sequence_id
				                having count(*) >= 1
				            ) seq,
				            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
				                from apidb.massspecsummary mss,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id
				                having sum(spectrum_count) >= 1
				            ) spec,
				            dots.nasequence nas
				            where mss.aa_sequence_id = taaf.aa_sequence_id
				            and taaf.na_feature_id = t.na_feature_id
				            and t.parent_id = gf.na_feature_id
				            and gf.na_sequence_id = nas.na_sequence_id
				            and nas.taxon_id in (17956)
				            and mss.aa_sequence_id = seq.aa_sequence_id
				            and mss.aa_sequence_id = spec.aa_sequence_id))";

	$Plasmodium_chabudi_queries[10] = "select count(*)
					     from (select distinct gf.source_id 
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id)
				              where substr(source_id,0,2) = 'PC'";

	$Plasmodium_chabudi_queries[11] = "select count(*) from (SELECT s.gene as source_id, 'PlasmoDB' as project_id, count(*) as number_of_ests
					            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
						 where s.est_gene_overlap_length >= 100 
						AND s.is_best_alignment in (1)
						AND s.percent_est_bases_aligned >= 20 
						AND s.percent_identity >= 90 
						AND e.best_alignment_count <= 1 
						and s.target_taxon_id in (17956)
						and e.source_id = s.accession           
						GROUP by s.gene 
						HAVING count(*) >= 1)";

	$Plasmodium_chabudi_queries[12] = "None";

	$Plasmodium_chabudi_queries[13] = "select count(*) from (select distinct gf.source_id,'PlasmoDB' as project_id, seq.sum_sequence_count, spec.sum_spectrum_count
				            from apidb.massspecsummary mss, 
				                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
						 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
				            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
				              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
				                from apidb.massspecsummary mss,
				                     dots.massspecfeature msf,
				                     dots.aalocation aal,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.mass_spec_summary_id = msf.source_id
				                  and msf.aa_feature_id = aal.aa_feature_id
				                  and msf.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
				                group by intseq.aa_sequence_id
				                having count(*) >= 1
				            ) seq,
				            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
				                from apidb.massspecsummary mss,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id
				                having sum(spectrum_count) >= 1
				            ) spec,
				            dots.nasequence nas
				            where mss.aa_sequence_id = taaf.aa_sequence_id
				            and taaf.na_feature_id = t.na_feature_id
				            and t.parent_id = gf.na_feature_id
				            and gf.na_sequence_id = nas.na_sequence_id
				            and nas.taxon_id in (17956)
				            and mss.aa_sequence_id = seq.aa_sequence_id
				            and mss.aa_sequence_id = spec.aa_sequence_id)";








	$Plasmodium_falciparum_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga, apidb.trackoldannotation tna where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17882 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')";


	$Plasmodium_falciparum_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga, apidb.trackoldannotation tna where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17882 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')";

	$Plasmodium_falciparum_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga, apidb.trackoldannotation tna where gf.sequence_ontology_id in (572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17882 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')";

	$Plasmodium_falciparum_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga, apidb.trackoldannotation tna where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17882 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar') AND gf.is_pseudo = 1";

	$Plasmodium_falciparum_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga, apidb.trackoldannotation tna where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 17882 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')";

	$Plasmodium_falciparum_queries[5] = "select count (*) from apidb.phylogeneticprofile pp,apidb.geneattributes ga, apidb.trackoldannotation tna where substr(pp.source_id,0,2) in ('PF','MA','CY','co') and pp.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')";

	$Plasmodium_falciparum_queries[6] = "SELECT count (DISTINCT gf.source_id)
					            FROM dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t,
					                 dots.TranslatedAaFeature taf,
					                 dots.GoAssociation ga, sres.GoTerm gp,
					                 sres.GoRelationship gr, core.TableInfo ti,
					                 sres.GoRelationshipType grt
					            WHERE ens.taxon_id IN (17882)
					              AND ens.na_sequence_id = gf.na_sequence_id
					              AND gf.na_feature_id = t.parent_id
						      AND gf.source_id not in (select source_id from apidb.trackoldannotation where status in ('new','new_organellar'))
						      AND t.na_feature_id = taf.na_feature_id
					              AND taf.aa_sequence_id = ga.row_id
					              AND ga.table_id = ti.table_id
					              AND ti.name = 'TranslatedAASequence'
					              AND ga.go_term_id = gr.child_term_id
					              AND gr.parent_term_id = gp.go_term_id
					              AND (gp.go_id = '*'
					                   OR gp.name LIKE REPLACE('*', '*', '%'))
					              AND gr.go_relationship_type_id = grt.go_relationship_type_id
					              AND grt.name = 'closure'
					            ORDER BY gf.source_id";

	$Plasmodium_falciparum_queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,apidb.geneattributes ga,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec,apidb.trackoldannotation tna
			            WHERE gs.taxon_id in (17882)
			              AND gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id and gf.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar') )";

	$Plasmodium_falciparum_queries[8] = "select count(distinct gf.source_id) from dots.snpfeature sf, dots.genefeature gf,apidb.geneattributes ga,apidb.trackoldannotation tna where sf.parent_id = gf.na_feature_id and gf.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar') ";

	$Plasmodium_falciparum_queries[9] = "select count(*) from
(select ma.source_id as source_id	     from (select distinct gf.source_id as source_id
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id) ma,apidb.trackoldannotation tna, apidb.geneattributes ga
				              where substr(ma.source_id,0,2) in  ('PF','MA','CY','co') and ma.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')
UNION
select EST.source_id as source_id from (SELECT s.gene as source_id
					            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
						 where s.est_gene_overlap_length >= 100 
						AND s.is_best_alignment in (1)
						AND s.percent_est_bases_aligned >= 20 
						AND s.percent_identity >= 90 
						AND e.best_alignment_count <= 1 
						and s.target_taxon_id in (17882)
						and e.source_id = s.accession
						GROUP by s.gene 
						HAVING count(*) >= 1) EST,apidb.trackoldannotation tna,apidb.geneattributes ga where EST.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')
UNION
select source_id from
						((select distinct SAGE.source_id as source_id from (select gene_source_id as source_id,
										                      round(sum(sense_count),1) as sense_count,
										                      round(sum(antisense_count),1) as antisense_count
												from 
										                 (select stg.gene_source_id, stg.tag_source_id,
										                         stg.sense_count, stg.antisense_count
										                  from apidb.SageTagGene stg 
												where stg.occurrence <= 2
												and ((stg.direction = '5' and stg.distance <= 100)
										                     OR (stg.direction = '3' and stg.distance <= 100))
										                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
										               ) 
										               group by gene_source_id having sum(sense_count) >= 1) SAGE,apidb.trackoldannotation tna,apidb.geneattributes ga where SAGE.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar'))
						union
						(select distinct SAGE.source_id as source_id from (select gene_source_id as source_id,
										                      round(sum(sense_count),1) as sense_count,
										                      round(sum(antisense_count),1) as antisense_count
												from 
										                 (select stg.gene_source_id, stg.tag_source_id,
										                         stg.sense_count, stg.antisense_count
										                  from apidb.SageTagGene stg 
												where stg.occurrence <= 2
												and ((stg.direction = '5' and stg.distance <= 100)
										                     OR (stg.direction = '3' and stg.distance <= 100))
										                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
										               ) 
										               group by gene_source_id having sum(antisense_count) >= 1) SAGE,apidb.trackoldannotation tna,apidb.geneattributes ga where SAGE.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar'))
						union
						(select gene_source_id as source_id
						         from (
						         select g.gene_source_id, aa.library_name, library_count.n as ni, f.frequency as fj, sum(aa.raw_count) as xij
						         from apidb.SAGETAGANALYSISATTRIBUTES aa, 
						              apidb.SAGETAGATTRIBUTES a,
						              (select distinct gene_source_id, tag_feature_id, antisense 
						               from apidb.SAGETAGGENE 
						               where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
						               ) g,
						              (select g.gene_source_id, sum(aa.raw_count) / max(n.n) as frequency
						               from apidb.SAGETAGANALYSISATTRIBUTES aa, 
						               apidb.SAGETAGATTRIBUTES a,
						               (select distinct gene_source_id, tag_feature_id, antisense 
						                from apidb.SAGETAGGENE
						                where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
						                ) g,
						               (select sum(max(total_raw_count)) as n
						                from apidb.SAGETAGANALYSISATTRIBUTES
						                group by library_name) n
						               where g.tag_feature_id = a.na_feature_id
						                and g.antisense = 0
						                and aa.composite_element_id = a.composite_element_id
						               group by g.gene_source_id) f,
						              (select library_name, max(total_raw_count) as n
						               from apidb.SAGETAGANALYSISATTRIBUTES
						               group by library_name) library_count
						         where g.tag_feature_id = a.na_feature_id
						          and g.antisense = 0
						          and aa.composite_element_id = a.composite_element_id
						          and g.gene_source_id = f.gene_source_id
						          and aa.library_name = library_count.library_name
						         group by g.gene_source_id, aa.library_name, library_count.n, f.frequency
						         )
						       group by gene_source_id
						       having sum(xij * log(10, (xij/(Ni * fj)))) >  10))
UNION
select PROT.source_id as source_id from (SELECT source_id,sum(sequence_count) as sum_sequence_count,sum(spectrum_count) as sum_spectrum_count from (
				                SELECT distinct gf.source_id, 'PlasmoDB' as project_id,mss.number_of_spans as sequence_count,mss.spectrum_count as spectrum_count
				                FROM apidb.MassSpecSummary mss, dots.transcript t,
				                     dots.genefeature gf, dots.translatedAAFeature taf
				                WHERE mss.developmental_stage in ('merozoite','trophozoite','FWTrophSchizont','gametocyte','sporozoite','-------------','Shahid Khan Merozoite Peptides','--------------','iRBCmembrane')
				                  AND taf.aa_sequence_id = mss.aa_sequence_id
				                  AND t.na_feature_id = taf.na_feature_id
				                  AND gf.na_feature_id = t.parent_id
				               UNION
				                SELECT gf.source_id, 'PlasmoDB' as project_id,mss.number_of_spans as sequence_count,mss.spectrum_count as spectrum_count
				                FROM apidb.MassSpecSummary mss, dots.transcript t,
				                     dots.genefeature gf, dots.translatedAAFeature taf,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                WHERE mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                  and ed.name in ('merozoite','trophozoite','FWTrophSchizont','gametocyte','sporozoite','-------------','Shahid Khan Merozoite Peptides','--------------','iRBCmembrane')
				                  AND taf.aa_sequence_id = mss.aa_sequence_id
				                  AND t.na_feature_id = taf.na_feature_id
				                  AND gf.na_feature_id = t.parent_id
				             )
					    group by source_id,project_id
				            having sum(sequence_count) >= 1) PROT,apidb.trackoldannotation tna,apidb.geneattributes ga where PROT.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar'))";

	$Plasmodium_falciparum_queries[10] = "select count(distinct ma.source_id)  from (select distinct gf.source_id as source_id
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id) ma,apidb.trackoldannotation tna,apidb.geneattributes ga
				              where substr(ma.source_id,0,2) in  ('PF','MA','CY','co') and ma.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar')";

	$Plasmodium_falciparum_queries[11] = "select count(*) from (select distinct tna.source_id as source_id from (select s.gene as source_id
					            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
						 where s.est_gene_overlap_length >= 100 
						AND s.is_best_alignment in (1)
						AND s.percent_est_bases_aligned >= 20 
						AND s.percent_identity >= 90 
						AND e.best_alignment_count <= 1 
						and s.target_taxon_id in (17882)
						and e.source_id = s.accession
						GROUP by s.gene 
						HAVING count(*) >= 1) ests,apidb.geneattributes ga,apidb.trackoldannotation tna where ests.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar'))";

	$Plasmodium_falciparum_queries[12] = "select count(*) from
						((select distinct SAGE.source_id as source_id from (select gene_source_id as source_id,
										                      round(sum(sense_count),1) as sense_count,
										                      round(sum(antisense_count),1) as antisense_count
												from 
										                 (select stg.gene_source_id, stg.tag_source_id,
										                         stg.sense_count, stg.antisense_count
										                  from apidb.SageTagGene stg 
												where stg.occurrence <= 2
												and ((stg.direction = '5' and stg.distance <= 100)
										                     OR (stg.direction = '3' and stg.distance <= 100))
										                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count) 
										               group by gene_source_id having sum(sense_count) >= 1) SAGE,apidb.trackoldannotation tna,apidb.geneattributes ga where SAGE.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar'))
						union
						(select distinct SAGE.source_id as source_id from (select gene_source_id as source_id,
										                      round(sum(sense_count),1) as sense_count,
										                      round(sum(antisense_count),1) as antisense_count
												from 
										                 (select stg.gene_source_id, stg.tag_source_id,
										                         stg.sense_count, stg.antisense_count
										                  from apidb.SageTagGene stg 
												where stg.occurrence <= 2
												and ((stg.direction = '5' and stg.distance <= 100)
										                     OR (stg.direction = '3' and stg.distance <= 100))
										                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
										               ) 
										               group by gene_source_id having sum(antisense_count) >= 1) SAGE,apidb.trackoldannotation tna,apidb.geneattributes ga where SAGE.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar'))
						union
						(select gene_source_id as source_id
						         from (
						         select g.gene_source_id, aa.library_name, library_count.n as ni, f.frequency as fj, sum(aa.raw_count) as xij
						         from apidb.SAGETAGANALYSISATTRIBUTES aa, 
						              apidb.SAGETAGATTRIBUTES a,
						              (select distinct gene_source_id, tag_feature_id, antisense 
						               from apidb.SAGETAGGENE 
						               where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
						               ) g,
						              (select g.gene_source_id, sum(aa.raw_count) / max(n.n) as frequency
						               from apidb.SAGETAGANALYSISATTRIBUTES aa, 
						               apidb.SAGETAGATTRIBUTES a,
						               (select distinct gene_source_id, tag_feature_id, antisense 
						                from apidb.SAGETAGGENE
						                where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
						                ) g,
						               (select sum(max(total_raw_count)) as n
						                from apidb.SAGETAGANALYSISATTRIBUTES
						                group by library_name) n
						               where g.tag_feature_id = a.na_feature_id
						                and g.antisense = 0
						                and aa.composite_element_id = a.composite_element_id
						               group by g.gene_source_id) f,
						              (select library_name, max(total_raw_count) as n
						               from apidb.SAGETAGANALYSISATTRIBUTES
						               group by library_name) library_count
						         where g.tag_feature_id = a.na_feature_id
						          and g.antisense = 0
						          and aa.composite_element_id = a.composite_element_id
						          and g.gene_source_id = f.gene_source_id
						          and aa.library_name = library_count.library_name
						         group by g.gene_source_id, aa.library_name, library_count.n, f.frequency
						         )
						       group by gene_source_id
						       having sum(xij * log(10, (xij/(Ni * fj)))) >  10))";



	$Plasmodium_falciparum_queries[13] = "select count(*) from (select distinct tna.source_id as source_id from (SELECT source_id,project_id,sum(sequence_count) as sum_sequence_count,sum(spectrum_count) as sum_spectrum_count from (
				                SELECT distinct gf.source_id, 'PlasmoDB' as project_id,mss.number_of_spans as sequence_count,mss.spectrum_count as spectrum_count
				                FROM apidb.MassSpecSummary mss, dots.transcript t,
				                     dots.genefeature gf, dots.translatedAAFeature taf
				                WHERE mss.developmental_stage in ('merozoite','trophozoite','FWTrophSchizont','gametocyte','sporozoite','nothing will be returned','Kahn Pfalciparum merozoite peptides','Lasonder Mosquito oocyst peptides','Lasonder Mosquito oocyst-derived sporozoite peptides','Lasonder Mosquito salivary gland sporozoite peptides','iRBCmembrane')
				                  AND taf.aa_sequence_id = mss.aa_sequence_id
				                  AND t.na_feature_id = taf.na_feature_id
				                  AND gf.na_feature_id = t.parent_id
				               UNION
				                SELECT gf.source_id, 'PlasmoDB' as project_id,mss.number_of_spans as sequence_count,mss.spectrum_count as spectrum_count
				                FROM apidb.MassSpecSummary mss, dots.transcript t,
				                     dots.genefeature gf, dots.translatedAAFeature taf,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                WHERE mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                  and ed.name in ('merozoite','trophozoite','FWTrophSchizont','gametocyte','sporozoite','nothing will be returned','Kahn Pfalciparum merozoite peptides','Lasonder Mosquito oocyst peptides','Lasonder Mosquito oocyst-derived sporozoite peptides','Lasonder Mosquito salivary gland sporozoite peptides','iRBCmembrane')
				                  AND taf.aa_sequence_id = mss.aa_sequence_id
				                  AND t.na_feature_id = taf.na_feature_id
				                  AND gf.na_feature_id = t.parent_id
				             )
					    group by source_id,project_id
				            having sum(sequence_count) >= 1) pro,apidb.trackoldannotation tna,apidb.geneattributes ga where pro.source_id = ga.source_id and ga.source_id = tna.source_id and tna.status not in ('new','new_organellar'))";







	$Plasmodium_knowlesii_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17983 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_knowlesii_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17983 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_knowlesii_queries[2] = "select count(*) from (select ga.source_id  as source_id from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17983 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB')";

	$Plasmodium_knowlesii_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17983 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' AND gf.is_pseudo = 1";

	$Plasmodium_knowlesii_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 17983 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_knowlesii_queries[5] = "select count (*) from (select substr(source_id,0,2) from apidb.phylogeneticprofile where substr(source_id,0,2) = 'PK')";

	$Plasmodium_knowlesii_queries[6] = "select count(*) from (select distinct s.source_id as id from dots.goassociation ga, dots.translatedaasequence s where ga.row_id = s.aa_sequence_id and substr(s.source_id,0,2) = 'PK')";

	$Plasmodium_knowlesii_queries[7] = "select count(*) from (select distinct s.source_id from dots.aaSequenceEnzymeClass e, dots.aasequence s where s.aa_sequence_id = e.aa_sequence_id and substr(s.source_id,0,2) = 'PK')";

	$Plasmodium_knowlesii_queries[8] = "None";

	$Plasmodium_knowlesii_queries[9] = "select count(*) from 
(select distinct gf.source_id as source_id
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id
				              and substr(gf.source_id,0,2) = 'PK'
UNION
SELECT s.gene as source_id
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (17983)
					and e.source_id = s.accession           
					GROUP by s.gene 
					HAVING count(*) >= 1)";

	$Plasmodium_knowlesii_queries[10] = "select count(*)
					     from (select distinct gf.source_id 
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id)
				              where substr(source_id,0,2) = 'PK'";

	$Plasmodium_knowlesii_queries[11] = "select count(*) from (SELECT s.gene as source_id, 'PlasmoDB' as project_id, count(*) as number_of_ests
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (17983)
					and e.source_id = s.accession           
					GROUP by s.gene 
					HAVING count(*) >= 1)";

	$Plasmodium_knowlesii_queries[12] = "None";

	$Plasmodium_knowlesii_queries[13] = "None";




	$Plasmodium_vivax_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17986 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_vivax_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17986 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_vivax_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17986 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_vivax_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17986 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' AND gf.is_pseudo = 1";

	$Plasmodium_vivax_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 17986 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_vivax_queries[5] = "select count(*) from (SELECT DISTINCT gf.source_id
				            FROM apidb.PhylogeneticProfile pp, dots.GeneFeature gf, dots.NaSequence ns
				            WHERE pp.source_id = gf.source_id
				              AND gf.na_sequence_id = ns.na_sequence_id
				              AND ns.taxon_id in (17986)
				            ORDER BY ns.taxon_id, gf.source_id)";

	$Plasmodium_vivax_queries[6] = "select count(*) from (select distinct s.source_id as id from dots.goassociation ga, dots.translatedaasequence s where ga.row_id = s.aa_sequence_id and substr(s.source_id,0,2) = 'PV')";

	$Plasmodium_vivax_queries[7] = "select count(*) from (select distinct s.source_id from dots.aaSequenceEnzymeClass e, dots.aasequence s where s.aa_sequence_id = e.aa_sequence_id and substr(s.source_id,0,2) = 'PV')";

	$Plasmodium_vivax_queries[8] = "None";

	$Plasmodium_vivax_queries[9] = "select count(*) from 
(select distinct gf.source_id as source_id
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id
				             and substr(gf.source_id,0,2) = 'PV'
UNION
SELECT s.gene as source_id
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (17986)
					and e.source_id = s.accession           
					GROUP by s.gene 
					HAVING count(*) >= 1)";

	$Plasmodium_vivax_queries[10] = "select count(*)
					     from (select distinct gf.source_id 
			                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
			                     where c.na_sequence_id = t.na_sequence_id
			                     and gf.na_feature_id = t.parent_id)
				              where substr(source_id,0,2) = 'PV'";

	$Plasmodium_vivax_queries[11] = "select count(*) from (SELECT s.gene as source_id, 'PlasmoDB' as project_id, count(*) as number_of_ests
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (17986)
					and e.source_id = s.accession           
					GROUP by s.gene 
					HAVING count(*) >= 1)";

	$Plasmodium_vivax_queries[12] = "None";

	$Plasmodium_vivax_queries[13] = "None";





	$Plasmodium_yoleii_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17953 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_yoleii_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17953 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_yoleii_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17953 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_yoleii_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,572,622,662,12) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 17953 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB' AND gf.is_pseudo = 1";

	$Plasmodium_yoleii_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 17953 AND gf.source_id = ga.source_id AND ga.project_id = 'PlasmoDB'";

	$Plasmodium_yoleii_queries[5] = "select count (*) from (select substr(source_id,0,2) from apidb.phylogeneticprofile where substr(source_id,0,2) in ('PY','90','10'))";

	$Plasmodium_yoleii_queries[6] = "select count(*) from (select distinct s.source_id as id from dots.goassociation ga, dots.translatedaasequence s where ga.row_id = s.aa_sequence_id and substr(s.source_id,0,2) in ('PY','90','10'))";

	$Plasmodium_yoleii_queries[7] = "select count(*) from (select distinct s.source_id from dots.aaSequenceEnzymeClass e, dots.aasequence s where s.aa_sequence_id = e.aa_sequence_id and substr(s.source_id,0,2) in ('PY','90','10'))";

	$Plasmodium_yoleii_queries[8] = "None";

	$Plasmodium_yoleii_queries[9] = "select count(*) from
(select distinct gf.source_id as  source_id
		                     from rad.COMPOSITEELEMENTNASEQUENCE c, dots.transcript t, dots.GENEFEATURE gf
		                     where c.na_sequence_id = t.na_sequence_id
		                     and gf.na_feature_id = t.parent_id
			             and substr(gf.source_id,0,2) in  ('PY','10','90')
UNION
SELECT s.gene as source_id
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (17953)
					and e.source_id = s.accession           
					GROUP by s.gene 
					HAVING count(*) >= 1
UNION
select source_id from (select distinct gf.source_id as source_id, seq.sum_sequence_count, spec.sum_spectrum_count
				            from apidb.massspecsummary mss, 
				                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
						 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
				            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
				              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
				                from apidb.massspecsummary mss,
				                     dots.massspecfeature msf,
				                     dots.aalocation aal,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.mass_spec_summary_id = msf.source_id
				                  and msf.aa_feature_id = aal.aa_feature_id
				                  and msf.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
				                group by intseq.aa_sequence_id
				                having count(*) >= 1
				            ) seq,
				            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
				                from apidb.massspecsummary mss,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id
				                having sum(spectrum_count) >= 1
				            ) spec,
				            dots.nasequence nas
				            where mss.aa_sequence_id = taaf.aa_sequence_id
				            and taaf.na_feature_id = t.na_feature_id
				            and t.parent_id = gf.na_feature_id
				            and gf.na_sequence_id = nas.na_sequence_id
				            and mss.aa_sequence_id = seq.aa_sequence_id
				            and mss.aa_sequence_id = spec.aa_sequence_id
					    and nas.taxon_id in (17953)))";

	$Plasmodium_yoleii_queries[10] = "SELECT count(g.source_id)
				            FROM Rad.DifferentialExpression de, Core.TableInfo t, Dots.GeneFeature g
				            WHERE t.table_id = de.table_id
				             AND g.na_feature_id = de.row_id
				             AND t.name = 'GeneFeature'
				             AND de.analysis_id in (select  a.analysis_id as analysis_id    from rad.protocol p, rad.analysis a   where p.name = 'Fold Change'   and p.protocol_id = a.protocol_id)
				             AND ( abs (de.fold_change)) >= 2";

	$Plasmodium_yoleii_queries[11] = "select count(*) from (SELECT s.gene as source_id, 'PlasmoDB' as project_id, count(*) as number_of_ests
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (17953)
					and e.source_id = s.accession           
					GROUP by s.gene 
					HAVING count(*) >= 1)";

	$Plasmodium_yoleii_queries[12] = "None";

	$Plasmodium_yoleii_queries[13] = "select count(*) from (select distinct gf.source_id,'PlasmoDB' as project_id, seq.sum_sequence_count, spec.sum_spectrum_count
				            from apidb.massspecsummary mss, 
				                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
						 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
				            (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
				              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
				                from apidb.massspecsummary mss,
				                     dots.massspecfeature msf,
				                     dots.aalocation aal,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.mass_spec_summary_id = msf.source_id
				                  and msf.aa_feature_id = aal.aa_feature_id
				                  and msf.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
				                group by intseq.aa_sequence_id
				                having count(*) >= 1
				            ) seq,
				            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
				                from apidb.massspecsummary mss,
				                     sres.externaldatabase ed,
				                     sres.externaldatabaserelease edr
				                where mss.external_database_release_id = edr.external_database_release_id
				                  and edr.external_database_id = ed.external_database_id
				                group by mss.aa_sequence_id
				                having sum(spectrum_count) >= 1
				            ) spec,
				            dots.nasequence nas
				            where mss.aa_sequence_id = taaf.aa_sequence_id
				            and taaf.na_feature_id = t.na_feature_id
				            and t.parent_id = gf.na_feature_id
				            and gf.na_sequence_id = nas.na_sequence_id
				            and mss.aa_sequence_id = seq.aa_sequence_id
				            and mss.aa_sequence_id = spec.aa_sequence_id
					    and nas.taxon_id in (17953))";





	$Toxoplasma_gondii_queries[0] =  "SELECT count(*)
                 FROM
                    (SELECT source_id, project_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id,
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (11,573,663)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (0,1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1, 
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id, 
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (11,573,663)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (0,1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id";

	$Toxoplasma_gondii_queries[1] = "SELECT count(*)
                 FROM
                    (SELECT source_id, project_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id,
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (11)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (0,1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id,
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (11)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (0,1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id";

	$Toxoplasma_gondii_queries[2] = "SELECT count(*)
                 FROM
                    (SELECT source_id, project_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id,
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (573,663)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (0,1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id,
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (573,663)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (0,1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id";

	$Toxoplasma_gondii_queries[3] = "SELECT count(*)
                 FROM
                    (SELECT source_id, project_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id,
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (11,573,663)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (SELECT gf.source_id, 'ToxoDB' as project_id,
              decode(gf.is_pseudo,0,'No',1,'Yes') as is_pseudo
            FROM dots.GeneFeature gf, dots.NaSequence ens, apidb.GeneAttributes ga
            WHERE gf.sequence_ontology_id IN (11,573,663)
              AND gf.na_sequence_id = ens.na_sequence_id
              and gf.is_pseudo in (1)
              AND ens.taxon_id IN (14109,14108,14105,14106)
              AND gf.source_id = ga.source_id
              AND ga.project_id = 'ToxoDB') ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id"; 

	$Toxoplasma_gondii_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  in (14109,14108,14105,14106) AND gf.source_id = ga.source_id AND ga.project_id = 'ToxoDB'";

	$Toxoplasma_gondii_queries[5] = "select count (*) from (select substr(source_id,0,2) from apidb.phylogeneticprofile where substr(source_id,0,2) = 'TG')";

	$Toxoplasma_gondii_queries[6] = "SELECT count(*)
                 FROM
                    (SELECT source_id, project_id
                      FROM (SELECT DISTINCT gf.source_id, 'ToxoDB' as project_id
            FROM dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t,
                 dots.TranslatedAaFeature taf,
                 dots.GoAssociation ga, sres.GoTerm gp,
                 sres.GoRelationship gr, core.TableInfo ti,
                 sres.GoRelationshipType grt
            WHERE ens.taxon_id IN (14109,14108,14105,14106)
              AND ens.na_sequence_id = gf.na_sequence_id
              AND gf.na_feature_id = t.parent_id
              AND t.na_feature_id = taf.na_feature_id
              AND taf.aa_sequence_id = ga.row_id
              AND ga.table_id = ti.table_id
              AND ti.name = 'TranslatedAASequence'
              AND ga.go_term_id = gr.child_term_id
              AND gr.parent_term_id = gp.go_term_id
              AND (gp.go_id = '*'
                   OR gp.name LIKE REPLACE('*', '*', '%'))
              AND gr.go_relationship_type_id = grt.go_relationship_type_id
              AND grt.name = 'closure'
            ORDER BY gf.source_id) ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (SELECT DISTINCT gf.source_id, 'ToxoDB' as project_id
            FROM dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t,
                 dots.TranslatedAaFeature taf,
                 dots.GoAssociation ga, sres.GoTerm gp,
                 sres.GoRelationship gr, core.TableInfo ti,
                 sres.GoRelationshipType grt
            WHERE ens.taxon_id IN (14109,14108,14105,14106)
              AND ens.na_sequence_id = gf.na_sequence_id
              AND gf.na_feature_id = t.parent_id
              AND t.na_feature_id = taf.na_feature_id
              AND taf.aa_sequence_id = ga.row_id
              AND ga.table_id = ti.table_id
              AND ti.name = 'TranslatedAASequence'
              AND ga.go_term_id = gr.child_term_id
              AND gr.parent_term_id = gp.go_term_id
              AND (gp.go_id = '*'
                   OR gp.name LIKE REPLACE('*', '*', '%'))
              AND gr.go_relationship_type_id = grt.go_relationship_type_id
              AND grt.name = 'closure'
            ORDER BY gf.source_id) ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id";

	$Toxoplasma_gondii_queries[7] = "SELECT count(*)     FROM
                    (SELECT source_id, project_id
                      FROM (SELECT DISTINCT gf.source_id, 'ToxoDB' as project_id
            FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
                 dots.Transcript t, dots.translatedAaFeature taf,
                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec,apidb.geneattributes ga
            WHERE gs.taxon_id IN (14109,14108,14105,14106)
              AND gs.na_sequence_id = gf.na_sequence_id
              AND ga.source_id = gf.source_id
              AND gf.na_feature_id = t.parent_id
              AND t.na_feature_id = taf.na_feature_id
              AND taf.aa_sequence_id = asec.aa_sequence_id
              AND asec.enzyme_class_id = ec.enzyme_class_id
              AND ec.ec_number LIKE REPLACE(REPLACE('-.-.-.-',' ',''),
                                            '-', '%')
            ORDER BY gf.source_id) ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (SELECT DISTINCT gf.source_id, 'ToxoDB' as project_id
            FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
                 dots.Transcript t, dots.translatedAaFeature taf,
                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec,apidb.geneattributes ga
            WHERE gs.taxon_id IN (14109,14108,14105,14106)
              AND gs.na_sequence_id = gf.na_sequence_id
              AND ga.source_id = gf.source_id
              AND gf.na_feature_id = t.parent_id
              AND t.na_feature_id = taf.na_feature_id
              AND taf.aa_sequence_id = asec.aa_sequence_id
              AND asec.enzyme_class_id = ec.enzyme_class_id
              AND ec.ec_number LIKE REPLACE(REPLACE('-.-.-.-',' ',''),
                                            '-', '%')
            ORDER BY gf.source_id) ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id";

	$Toxoplasma_gondii_queries[8] = "select count (distinct gf.source_id) from dots.snpfeature sf, dots.genefeature gf where sf.parent_id = gf.na_feature_id";

	$Toxoplasma_gondii_queries[9] = "None";

	$Toxoplasma_gondii_queries[10] = "None";

	$Toxoplasma_gondii_queries[11] = "SELECT count(*)                 FROM
                    (SELECT source_id, project_id
                      FROM (SELECT s.gene as source_id, 'ToxoDB' as project_id, count(*) as number_of_ests
                                            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                         where s.est_gene_overlap_length >= 100
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20
                                        AND s.percent_identity >= 90
                                        AND e.best_alignment_count <= 1
                                        and e.source_id = s.accession
                                        GROUP by s.gene
                                        HAVING count(*) >= 1)) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (SELECT s.gene as source_id, 'ToxoDB' as project_id, count(*) as number_of_ests
                                            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                         where s.est_gene_overlap_length >= 100
                                        AND s.is_best_alignment in (1)
                                        AND s.percent_est_bases_aligned >= 20
                                        AND s.percent_identity >= 90
                                        AND e.best_alignment_count <= 1
                                        and e.source_id = s.accession
                                        GROUP by s.gene
                                        HAVING count(*) >= 1) ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id";

	$Toxoplasma_gondii_queries[12] = "select count(*) from
((SELECT c.source_id as source_id
                 FROM
                    (SELECT source_id
                      FROM (select gene_source_id as source_id,'ToxoDB' as project_id,
                                                      round(sum(sense_count),1) as sense_count,
                                                      round(sum(antisense_count),1) as antisense_count
                                from
                                                 (select stg.gene_source_id, stg.tag_source_id,
                                                         stg.sense_count, stg.antisense_count
                                                  from apidb.SageTagGene stg
                                                where stg.occurrence <= 2
                                                and ((stg.direction = '5' and stg.distance <= 100)
                                                     OR (stg.direction = '3' and stg.distance <= 100))
                                                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                               )
                                               group by gene_source_id having sum(sense_count) >= 1) ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (select gene_source_id as source_id,'ToxoDB' as project_id,
                                                      round(sum(sense_count),1) as sense_count,
                                                      round(sum(antisense_count),1) as antisense_count
                                from
                                                 (select stg.gene_source_id, stg.tag_source_id,
                                                         stg.sense_count, stg.antisense_count
                                                  from apidb.SageTagGene stg
                                                where stg.occurrence <= 2
                                                and ((stg.direction = '5' and stg.distance <= 100)
                                                     OR (stg.direction = '3' and stg.distance <= 100))
                                                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                               )
                                               group by gene_source_id having sum(sense_count) >= 1) ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
               WHERE c.source_id = f.source_id)
union
(SELECT c.source_id as source_id
                 FROM
                    (SELECT source_id
                      FROM (select gene_source_id as source_id,'ToxoDB' as project_id,
                                                      round(sum(sense_count),1) as sense_count,
                                                      round(sum(antisense_count),1) as antisense_count
                                from
                                                 (select stg.gene_source_id, stg.tag_source_id,
                                                         stg.sense_count, stg.antisense_count
                                                  from apidb.SageTagGene stg
                                                where stg.occurrence <= 2
                                                and ((stg.direction = '5' and stg.distance <= 100)
                                                     OR (stg.direction = '3' and stg.distance <= 100))
                                                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                               )
                                               group by gene_source_id having sum(antisense_count) >= 1) ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (select gene_source_id as source_id,'ToxoDB' as project_id,
                                                      round(sum(sense_count),1) as sense_count,
                                                      round(sum(antisense_count),1) as antisense_count
                                from
                                                 (select stg.gene_source_id, stg.tag_source_id,
                                                         stg.sense_count, stg.antisense_count
                                                  from apidb.SageTagGene stg
                                                where stg.occurrence <= 2
                                                and ((stg.direction = '5' and stg.distance <= 100)
                                                     OR (stg.direction = '3' and stg.distance <= 100))
                                                  group by stg.gene_source_id, stg.tag_source_id, stg.sense_count, stg.antisense_count
                                               )
                                               group by gene_source_id having sum(antisense_count) >= 1) ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id)
union
(SELECT c.source_id as source_id
                 FROM   
                    (SELECT source_id
                      FROM (select gene_source_id as source_id 
				         from (
				         select g.gene_source_id, aa.library_name, library_count.n as ni, f.frequency as fj, sum(aa.raw_count) as xij
				         from apidb.SAGETAGANALYSISATTRIBUTES aa, 
				              apidb.SAGETAGATTRIBUTES a,
				              (select distinct gene_source_id, tag_feature_id, antisense 
				               from apidb.SAGETAGGENE 
				               where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
				               ) g,
				              (select g.gene_source_id, sum(aa.raw_count) / max(n.n) as frequency
				               from apidb.SAGETAGANALYSISATTRIBUTES aa, 
				               apidb.SAGETAGATTRIBUTES a,
				               (select distinct gene_source_id, tag_feature_id, antisense 
				                from apidb.SAGETAGGENE
				                where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
				                ) g,
				               (select sum(max(total_raw_count)) as n
				                from apidb.SAGETAGANALYSISATTRIBUTES
				                group by library_name) n
				               where g.tag_feature_id = a.na_feature_id
				                and g.antisense = 0
				                and aa.composite_element_id = a.composite_element_id
				               group by g.gene_source_id) f,
				              (select library_name, max(total_raw_count) as n
				               from apidb.SAGETAGANALYSISATTRIBUTES
				               group by library_name) library_count
				         where g.tag_feature_id = a.na_feature_id
				          and g.antisense = 0
				          and aa.composite_element_id = a.composite_element_id
				          and g.gene_source_id = f.gene_source_id
				          and aa.library_name = library_count.library_name
				         group by g.gene_source_id, aa.library_name, library_count.n, f.frequency
				         )
				       group by gene_source_id
				       having sum(xij * log(10, (xij/(Ni * fj)))) >  10) ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY 
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1, 
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (select gene_source_id as source_id 
				         from (
				         select g.gene_source_id, aa.library_name, library_count.n as ni, f.frequency as fj, sum(aa.raw_count) as xij
				         from apidb.SAGETAGANALYSISATTRIBUTES aa, 
				              apidb.SAGETAGATTRIBUTES a,
				              (select distinct gene_source_id, tag_feature_id, antisense 
				               from apidb.SAGETAGGENE 
				               where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
				               ) g,
				              (select g.gene_source_id, sum(aa.raw_count) / max(n.n) as frequency
				               from apidb.SAGETAGANALYSISATTRIBUTES aa, 
				               apidb.SAGETAGATTRIBUTES a,
				               (select distinct gene_source_id, tag_feature_id, antisense 
				                from apidb.SAGETAGGENE
				                where ((direction = '5' and distance <= 100) OR (direction = '3' and distance <= 100))
				                ) g,
				               (select sum(max(total_raw_count)) as n
				                from apidb.SAGETAGANALYSISATTRIBUTES
				                group by library_name) n
				               where g.tag_feature_id = a.na_feature_id
				                and g.antisense = 0
				                and aa.composite_element_id = a.composite_element_id
				               group by g.gene_source_id) f,
				              (select library_name, max(total_raw_count) as n
				               from apidb.SAGETAGANALYSISATTRIBUTES
				               group by library_name) library_count
				         where g.tag_feature_id = a.na_feature_id
				          and g.antisense = 0
				          and aa.composite_element_id = a.composite_element_id
				          and g.gene_source_id = f.gene_source_id
				          and aa.library_name = library_count.library_name
				         group by g.gene_source_id, aa.library_name, library_count.n, f.frequency
				         )
       group by gene_source_id
       having sum(xij * log(10, (xij/(Ni * fj)))) >  10) ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                       AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id))";

	$Toxoplasma_gondii_queries[13] = "SELECT count(*)      FROM
                    (SELECT source_id, project_id
                      FROM (select distinct gf.source_id,'ToxoDB' as project_id, seq.sum_sequence_count, spec.sum_spectrum_count
            from apidb.massspecsummary mss,
                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
                 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
            (select intseq.aa_sequence_id,count(*) as sum_sequence_count
              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
                from apidb.massspecsummary mss,
                     dots.massspecfeature msf,
                     dots.aalocation aal,
                     sres.externaldatabase ed,
                     sres.externaldatabaserelease edr
                where mss.mass_spec_summary_id = msf.source_id
                  and msf.aa_feature_id = aal.aa_feature_id
                  and msf.external_database_release_id = edr.external_database_release_id
                  and edr.external_database_id = ed.external_database_id
                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
                group by intseq.aa_sequence_id
                having count(*) >= 1
            ) seq,
            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
                from apidb.massspecsummary mss,
                     sres.externaldatabase ed,
                     sres.externaldatabaserelease edr
                where mss.external_database_release_id = edr.external_database_release_id
                  and edr.external_database_id = ed.external_database_id
                    group by mss.aa_sequence_id
                having sum(spectrum_count) >= 1
            ) spec
            where mss.aa_sequence_id = taaf.aa_sequence_id
            and taaf.na_feature_id = t.na_feature_id
            and t.parent_id = gf.na_feature_id
            and gf.external_database_release_id = edr.external_database_release_id
            and edr.external_database_id = ed.external_database_id
            and ed.name = 'T.gondii ME49 contigs from Genbank'
            and mss.aa_sequence_id = seq.aa_sequence_id
            and mss.aa_sequence_id = spec.aa_sequence_id) ) c,
                    (SELECT  MAX(ga.source_id) KEEP (DENSE_RANK FIRST ORDER BY
                            DECODE(ga.organism, 'Toxoplasma gondii ME49', 1,
                                                'Toxoplasma gondii GT1', 2,
                                                'Toxoplasma gondii VEG', 3)) AS source_id
                      FROM (select distinct gf.source_id,'ToxoDB' as project_id, seq.sum_sequence_count, spec.sum_spectrum_count
            from apidb.massspecsummary mss,
                 dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
                 sres.externalDatabase ed, sres.externalDatabaseRelease edr,
            (select intseq.aa_sequence_id,count(*) as sum_sequence_count
              from (select mss.aa_sequence_id, count(*) as sum_seq_ct
                from apidb.massspecsummary mss,
                     dots.massspecfeature msf,
                     dots.aalocation aal,
                      sres.externaldatabase ed,
                     sres.externaldatabaserelease edr
                where mss.mass_spec_summary_id = msf.source_id
                  and msf.aa_feature_id = aal.aa_feature_id
                  and msf.external_database_release_id = edr.external_database_release_id
                  and edr.external_database_id = ed.external_database_id
                group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
                group by intseq.aa_sequence_id
                having count(*) >= 1
            ) seq,
            (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
                from apidb.massspecsummary mss,
                     sres.externaldatabase ed,
                     sres.externaldatabaserelease edr
                where mss.external_database_release_id = edr.external_database_release_id
                  and edr.external_database_id = ed.external_database_id
                  group by mss.aa_sequence_id
                having sum(spectrum_count) >= 1
            ) spec
            where mss.aa_sequence_id = taaf.aa_sequence_id
            and taaf.na_feature_id = t.na_feature_id
            and t.parent_id = gf.na_feature_id
            and gf.external_database_release_id = edr.external_database_release_id
            and edr.external_database_id = ed.external_database_id
            and ed.name = 'T.gondii ME49 contigs from Genbank'
            and mss.aa_sequence_id = seq.aa_sequence_id
            and mss.aa_sequence_id = spec.aa_sequence_id) ca, apidb.geneattributes ga
                      WHERE ga.source_id = ca.source_id
                      AND ga.organism like 'Toxoplasma gondii%'
                      GROUP BY ga.gene_id) f
                WHERE c.source_id = f.source_id";




	$Trichomonas_vaginalis_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,574,658,664) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 252797 AND gf.source_id = ga.source_id AND ga.project_id = 'TrichDB'";

	$Trichomonas_vaginalis_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 252797 AND gf.source_id = ga.source_id AND ga.project_id = 'TrichDB'";

	$Trichomonas_vaginalis_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (574,658,664) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 252797 AND gf.source_id = ga.source_id AND ga.project_id = 'TrichDB'";

	$Trichomonas_vaginalis_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where gf.sequence_ontology_id in (11,574,658,664) and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id = 252797 AND gf.source_id = ga.source_id AND ga.project_id = 'TrichDB' AND gf.is_pseudo = 1";

	$Trichomonas_vaginalis_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id  = 252797 AND gf.source_id = ga.source_id and gf.sequence_ontology_id not in (658) AND ga.project_id = 'TrichDB' ";

	$Trichomonas_vaginalis_queries[5] = "None";

	$Trichomonas_vaginalis_queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.Transcript t,dots.genefeature gf, dots.TranslatedAaFeature taf, dots.GoAssociation go  WHERE ens.taxon_id IN (252797)  AND ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id  AND gf.sequence_ontology_id not in (658) and t.na_feature_id = taf.na_feature_id  AND taf.aa_sequence_id = go.row_id)";


	$Trichomonas_vaginalis_queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.genefeature gf, apidb.GenomicSequence gs,
                 dots.Transcript t, dots.translatedAaFeature taf,
                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
            WHERE gs.taxon_id in (252797)
              AND gs.na_sequence_id = gf.na_sequence_id
	      AND gf.sequence_ontology_id not in (658)
              AND gf.na_feature_id = t.parent_id
              AND t.na_feature_id = taf.na_feature_id
              AND taf.aa_sequence_id = asec.aa_sequence_id)";

	$Trichomonas_vaginalis_queries[8] = "select count(distinct gf.source_id) from dots.snpfeature sf, dots.genefeature gf where sf.parent_id = gf.na_feature_id AND gf.sequence_ontology_id not in (658)";

	$Trichomonas_vaginalis_queries[9] = "select count(*) from (SELECT s.gene as source_id
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e,dots.genefeature gf
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (252797)
					and e.source_id = s.accession           
                                        and s.gene = gf.source_id and gf.sequence_ontology_id not in (658)
					GROUP by s.gene 
					HAVING count(*) >= 1)";

	$Trichomonas_vaginalis_queries[10] = "None";

	$Trichomonas_vaginalis_queries[11] = "select count(*) from (SELECT s.gene as source_id
				            FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e,dots.genefeature gf
					 where s.est_gene_overlap_length >= 100 
					AND s.is_best_alignment in (1)
					AND s.percent_est_bases_aligned >= 20 
					AND s.percent_identity >= 90 
					AND e.best_alignment_count <= 1 
					and s.target_taxon_id in (252797)
					and e.source_id = s.accession           
                                        and s.gene = gf.source_id and gf.sequence_ontology_id not in (658)
					GROUP by s.gene 
					HAVING count(*) >= 1)";

	$Trichomonas_vaginalis_queries[12] = "None";

	$Trichomonas_vaginalis_queries[13] = "None";



$Leishmania_braziliensis_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113797";

$Leishmania_braziliensis_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113797";

$Leishmania_braziliensis_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113797";

$Leishmania_braziliensis_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,574,664,579,12) and gf.na_sequence_id = ens.na_sequence_id AND 
gf.is_pseudo = 1 and ens.taxon_id = 113797";   

$Leishmania_braziliensis_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga 
where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id AND gf.source_id = ga.source_id  AND ga.project_id = 'TriTrypDB' 
and ens.taxon_id  =  113797";

$Leishmania_braziliensis_queries[5] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = gf.source_id and 
gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id =  113797";

$Leishmania_braziliensis_queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t, dots.TranslatedAaFeature taf,
dots.GoAssociation ga  WHERE  ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id   AND t.na_feature_id = taf.na_feature_id
AND taf.aa_sequence_id = ga.row_id and  ens.taxon_id =  113797)";


$Leishmania_braziliensis_queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id
			              AND gs.taxon_id = 113797)";
			              
$Leishmania_braziliensis_queries[8] = "None";


$Leishmania_braziliensis_queries[9] = "select count(*) from ((select source_id from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (113797)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)) 
                                                UNION (select source_id from (select distinct gf.source_id as source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 113797))
			                    UNION
			                    (SELECT gf.source_id
                                 FROM apidb.profile pr, apidb.profileset prs,
                                         dots.nafeature gf, dots.nasequence ns
                                    WHERE pr.source_id = gf.source_id
                                    AND pr.profile_set_id = prs.profile_set_id
                                    and gf.na_sequence_id = ns.na_sequence_id
                                    and ns.taxon_id = 113797
                                    group BY gf.source_id))";

								
$Leishmania_braziliensis_queries[10] = "select count(*) from (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 113797
          group BY gf.source_id)";

$Leishmania_braziliensis_queries[11] = "select count(*) from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (113797)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)";

$Leishmania_braziliensis_queries[12] = "None";

$Leishmania_braziliensis_queries[13] = "select count(*) from (select distinct gf.source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 113797)";
			                    
			                    
			                    
			                   






$Leishmania_infantum_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113769";

$Leishmania_infantum_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113769";

$Leishmania_infantum_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113769";

$Leishmania_infantum_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,574,664,579,12) and gf.na_sequence_id = ens.na_sequence_id AND 
gf.is_pseudo = 1 and ens.taxon_id = 113769";   

$Leishmania_infantum_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga 
where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id AND gf.source_id = ga.source_id  AND ga.project_id = 'TriTrypDB' 
and ens.taxon_id  =  113769";

$Leishmania_infantum_queries[5] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = gf.source_id and 
gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id =  113769";

$Leishmania_infantum_queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t, dots.TranslatedAaFeature taf,
dots.GoAssociation ga  WHERE  ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id   AND t.na_feature_id = taf.na_feature_id
AND taf.aa_sequence_id = ga.row_id and  ens.taxon_id =  113769)";


$Leishmania_infantum_queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id
			              AND gs.taxon_id = 113769)";
			              
$Leishmania_infantum_queries[8] = "None";


$Leishmania_infantum_queries[9] = "select count(*) from ((select source_id from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (113769)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)) 
                                                UNION (select source_id from (select distinct gf.source_id as source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 113769))
			                    UNION
			                    (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 113769
          group BY gf.source_id))";

								
$Leishmania_infantum_queries[10] = "select count(*) from (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 113769
          group BY gf.source_id)";

$Leishmania_infantum_queries[11] = "select count(*) from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (113769)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)";

$Leishmania_infantum_queries[12] = "None";

$Leishmania_infantum_queries[13] = "select count(*) from (select distinct gf.source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 113769)";
			                    
			                    
			                    
			                    
			                    
			                    
			                    
			                    
			                    
$Leishmania_major_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113787";

$Leishmania_major_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113787";

$Leishmania_major_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 113787";

$Leishmania_major_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,574,664,579,12) and gf.na_sequence_id = ens.na_sequence_id AND 
gf.is_pseudo = 1 and ens.taxon_id = 113787";   

$Leishmania_major_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga 
where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id AND gf.source_id = ga.source_id  AND ga.project_id = 'TriTrypDB' 
and ens.taxon_id  =  113787";

$Leishmania_major_queries[5] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = gf.source_id and 
gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id =  113787";

$Leishmania_major_queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t, dots.TranslatedAaFeature taf,
dots.GoAssociation ga  WHERE  ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id   AND t.na_feature_id = taf.na_feature_id
AND taf.aa_sequence_id = ga.row_id and  ens.taxon_id =  113787)";


$Leishmania_major_queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id
			              AND gs.taxon_id = 113787)";
			              
$Leishmania_major_queries[8] = "None";


$Leishmania_major_queries[9] = "select count(*) from ((select source_id from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (113787)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)) 
                                                UNION (select source_id from (select distinct gf.source_id as source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 113787))
			                    UNION
			                    (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 113787
          group BY gf.source_id))";

								
$Leishmania_major_queries[10] = "select count(*) from (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 113787
          group BY gf.source_id)";

$Leishmania_major_queries[11] = "select count(*) from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (113787)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)";

$Leishmania_major_queries[12] = "None";

$Leishmania_major_queries[13] = "select count(*) from (select distinct gf.source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 113787)";
			                    
			                    
			                    
			                    
			                    
			                    
			                    
			                    
			                    
			                    
$Trypanosoma_cruzi_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 114018";

$Trypanosoma_cruzi_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 114018";

$Trypanosoma_cruzi_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 114018";

$Trypanosoma_cruzi_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,574,664,579,12) and gf.na_sequence_id = ens.na_sequence_id AND 
gf.is_pseudo = 1 and ens.taxon_id = 114018";   

$Trypanosoma_cruzi_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga 
where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id AND gf.source_id = ga.source_id  AND ga.project_id = 'TriTrypDB' 
and ens.taxon_id  =  114018";

$Trypanosoma_cruzi_queries[5] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = gf.source_id and 
gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id =  114018";

$Trypanosoma_cruzi_queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t, dots.TranslatedAaFeature taf,
dots.GoAssociation ga  WHERE  ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id   AND t.na_feature_id = taf.na_feature_id
AND taf.aa_sequence_id = ga.row_id and  ens.taxon_id =  114018)";


$Trypanosoma_cruzi_queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id
			              AND gs.taxon_id = 114018)";
			              
$Trypanosoma_cruzi_queries[8] = "None";


$Trypanosoma_cruzi_queries[9] = "select count(*) from ((select source_id from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (114018)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)) 
                                                UNION (select source_id from (select distinct gf.source_id as source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 114018))
			                    UNION
			                    (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 114018
          group BY gf.source_id))";

								
$Trypanosoma_cruzi_queries[10] = "select count(*) from (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 114018
          group BY gf.source_id)";

$Trypanosoma_cruzi_queries[11] = "select count(*) from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (114018)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)";

$Trypanosoma_cruzi_queries[12] = "None";

$Trypanosoma_cruzi_queries[13] = "select count(*) from (select distinct gf.source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 114018)";
			                    
			                    			                    
			                    
			                    
			                    
			                    
    
$Trypanosoma_brucei_queries[0] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 114031";

$Trypanosoma_brucei_queries[1] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 114031";

$Trypanosoma_brucei_queries[2] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (577,662,622,572,12) and gf.na_sequence_id = ens.na_sequence_id and
ens.taxon_id = 114031";

$Trypanosoma_brucei_queries[3] = "select count(*) from dots.genefeature gf, dots.nasequence ens where gf.sequence_ontology_id in (11,574,664,579,12) and gf.na_sequence_id = ens.na_sequence_id AND 
gf.is_pseudo = 1 and ens.taxon_id = 114031";   

$Trypanosoma_brucei_queries[4] = "select count(lgc.comment_id) from comments2.comments\@apidb.login_comment lgc, dots.genefeature gf, dots.nasequence ens, apidb.geneattributes ga 
where lgc.stable_id = gf.source_id and gf.na_sequence_id = ens.na_sequence_id AND gf.source_id = ga.source_id  AND ga.project_id = 'TriTrypDB' 
and ens.taxon_id  =  114031";

$Trypanosoma_brucei_queries[5] = "select count(*) from dots.genefeature gf, dots.nasequence ens, apidb.phylogeneticprofile pp where pp.source_id = gf.source_id and 
gf.na_sequence_id = ens.na_sequence_id and ens.taxon_id =  114031";

$Trypanosoma_brucei_queries[6] = "select count(*) from (select distinct gf.source_id from dots.NaSequence ens, dots.GeneFeature gf, dots.Transcript t, dots.TranslatedAaFeature taf,
dots.GoAssociation ga  WHERE  ens.na_sequence_id = gf.na_sequence_id  AND gf.na_feature_id = t.parent_id   AND t.na_feature_id = taf.na_feature_id
AND taf.aa_sequence_id = ga.row_id and  ens.taxon_id =  114031)";


$Trypanosoma_brucei_queries[7] = "select count(*) from (select distinct gf.source_id FROM dots.GeneFeature gf, apidb.GenomicSequence gs,
			                 dots.Transcript t, dots.translatedAaFeature taf,
			                 dots.aaSequenceEnzymeClass asec, sres.enzymeClass ec
			            WHERE gs.na_sequence_id = gf.na_sequence_id
			              AND gf.na_feature_id = t.parent_id
			              AND t.na_feature_id = taf.na_feature_id
			              AND taf.aa_sequence_id = asec.aa_sequence_id
			              AND gs.taxon_id = 114031)";
			              
$Trypanosoma_brucei_queries[8] = "None";


$Trypanosoma_brucei_queries[9] = "select count(*) from ((select source_id from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (114031)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)) 
                                                UNION (select source_id from (select distinct gf.source_id as source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 114031))
			                    UNION
			                    (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 114031
          group BY gf.source_id))";

								
$Trypanosoma_brucei_queries[10] = "select count(*) from (SELECT gf.source_id
           FROM apidb.profile pr, apidb.profileset prs,
               dots.nafeature gf, dots.nasequence ns
          WHERE pr.source_id = gf.source_id
          AND pr.profile_set_id = prs.profile_set_id
          and gf.na_sequence_id = ns.na_sequence_id
          and ns.taxon_id = 114031
          group BY gf.source_id)";

$Trypanosoma_brucei_queries[11] = "select count(*) from (SELECT s.gene as source_id FROM apidb.EstAlignmentGeneSummary s, apidb.estattributes e
                                                 where s.est_gene_overlap_length >= 100
                                                AND s.is_best_alignment in (1)
                                                AND s.percent_est_bases_aligned >= 20
                                                AND s.percent_identity >= 90
                                                AND e.best_alignment_count <= 1
                                                and e.source_id = s.accession
                                                and s.target_taxon_id in (114031)
                                                GROUP by s.gene
                                                HAVING count(*) >= 1)";

$Trypanosoma_brucei_queries[12] = "None";

$Trypanosoma_brucei_queries[13] = "select count(*) from (select distinct gf.source_id
			                    from apidb.massspecsummary mss, 
			                         dots.translatedaafeature taaf, dots.transcript t, dots.genefeature gf,
			                         sres.externalDatabase ed, sres.externalDatabaseRelease edr,
			                    (select intseq.aa_sequence_id,count(*) as sum_sequence_count 
			                      from (select mss.aa_sequence_id, count(*) as sum_seq_ct
			                        from apidb.massspecsummary mss,
			                             dots.massspecfeature msf,
			                             dots.aalocation aal,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.mass_spec_summary_id = msf.source_id
			                          and msf.aa_feature_id = aal.aa_feature_id
			                          and msf.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id,aal.start_min,aal.end_max ) intseq
			                        group by intseq.aa_sequence_id
			                        having count(*) >= 1
			                    ) seq,
			                    (select mss.aa_sequence_id, sum(spectrum_count) as sum_spectrum_count
			                        from apidb.massspecsummary mss,
			                             sres.externaldatabase ed,
			                             sres.externaldatabaserelease edr
			                        where mss.external_database_release_id = edr.external_database_release_id
			                          and edr.external_database_id = ed.external_database_id
			                        group by mss.aa_sequence_id
			                        having sum(spectrum_count) >= 1
			                    ) spec,
			                    dots.nasequence nas
			                    where mss.aa_sequence_id = taaf.aa_sequence_id
			                    and taaf.na_feature_id = t.na_feature_id
			                    and t.parent_id = gf.na_feature_id
			                    and gf.na_sequence_id = nas.na_sequence_id
			                    and mss.aa_sequence_id = seq.aa_sequence_id
			                    and mss.aa_sequence_id = spec.aa_sequence_id
			                    and nas.taxon_id = 114031)";
}
