<wdkModel>

    <recordClassSet name="AssemblyRecordClasses" excludeProjects="TrichDB">

        <!-- AssemblyRecordClasses.AssemblyRecordClass -->
        <recordClass name="AssemblyRecordClass" type="Assembly">


      <testParamValues includeProjects="PlasmoDB">
         <paramValue name="source_id">PvDT.474317.tmp</paramValue>
         <paramValue name="project_id">PlasmoDB</paramValue>
      </testParamValues>

      <testParamValues includeProjects="ToxoDB" minRows="0">
         <paramValue name="source_id">NcDT.426290.tmp</paramValue>
         <paramValue name="project_id">ToxoDB</paramValue>
      </testParamValues>

      <testParamValues includeProjects="CryptoDB">
         <paramValue name="source_id">CpDT.322688.tmp</paramValue>
         <paramValue name="project_id">CryptoDB</paramValue>
      </testParamValues>

      <testParamValues includeProjects="GiardiaDB">
         <paramValue name="source_id">GlDT.40190.tmp</paramValue>
         <paramValue name="project_id">GiardiaDB</paramValue>
      </testParamValues>

      <testParamValues includeProjects="TriTrypDB">
         <paramValue name="source_id">TbDT.134346.tmp</paramValue>
         <paramValue name="project_id">TriTrypDB</paramValue>
      </testParamValues>

            <!-- primary key definition -->
            <primaryKeyAttribute name="primary_key"
                                 displayName="Assembly">
                <columnRef>source_id</columnRef>
                <columnRef>project_id</columnRef>
                <text>
                    <![CDATA[
                      $$source_id$$
                    ]]>
                </text>                
            </primaryKeyAttribute>


          <!-- =============================================================== -->
          <!--   Reporters -->  
          <!-- =============================================================== -->

          <reporter name="tabular" displayName="Summary - TAB Delimited"
                    implementation="org.gusdb.wdk.model.report.TabularReporter"/>
          <reporter name="fullRecord" displayName="Detailed"  excludeProjects="EuPathDB" 
                    implementation="org.gusdb.wdk.model.report.FullRecordReporter" />


      <!-- =============================================================== -->
      <!--   Filters -->
      <!-- =============================================================== -->


      <answerFilterLayout name="eupath_project" visible="true"
                              fileName="eupath_project_filter.jsp" 
                            displayName="Filter results by component website" includeProjects="EuPathDB">
            <instanceRef ref="all_results" />
            <instanceRef ref="crypto_assemblies" />
            <instanceRef ref="giardia_assemblies" />
            <instanceRef ref="plasmo_assemblies" />
            <instanceRef ref="toxo_assemblies" />
            <instanceRef ref="trich_assemblies" />
            <instanceRef ref="tritryp_assemblies" />
      </answerFilterLayout>

     <answerFilter queryRef="AssemblyTables.AllResults"   includeProjects="EuPathDB">
                  <instance name="all_results" displayName="All Results" default="true">
                    <description>
                        <![CDATA[
                            All results
                        ]]>
                    </description>
                </instance>

      </answerFilter>

     <answerFilter queryRef="AssemblyTables.ApiProjectAssemblies"
                          includeProjects="EuPathDB">

               <instance name="crypto_assemblies" displayName="CryptoDB" >
                    <description>
                        <![CDATA[
                            Number of Assemblies in CryptoDB.
                        ]]>
                    </description>
                    <paramValue name="Project">CryptoDB</paramValue>
                </instance>
               <instance name="giardia_assemblies" displayName="GiardiaDB" >
                    <description>
                        <![CDATA[
                            Number of Assemblies in GiardiaDB.
                        ]]>
                    </description>
                    <paramValue name="Project">GiardiaDB</paramValue>
                </instance>
               <instance name="plasmo_assemblies" displayName="PlasmoDB" >
                    <description>
                        <![CDATA[
                            Number of Assemblies in PlasmoDB.
                        ]]>
                    </description>
                    <paramValue name="Project">PlasmoDB</paramValue>
                </instance>
               <instance name="toxo_assemblies" displayName="ToxoDB" >
                    <description>
                        <![CDATA[
                            Number of Assemblies in ToxoDB.
                        ]]>
                    </description>
                    <paramValue name="Project">ToxoDB</paramValue>
                </instance>
               <instance name="trich_assemblies" displayName="TrichDB" >
                    <description>
                        <![CDATA[
                            Number of Assemblies in TrichDB.
                        ]]>
                    </description>
                    <paramValue name="Project">TrichDB</paramValue>
                </instance>
               <instance name="tritryp_assemblies" displayName="TriTrypDB" >
                    <description>
                        <![CDATA[
                            Number of Assemblies in TriTrypDB.
                        ]]>
                    </description>
                    <paramValue name="Project">TriTrypDB</paramValue>
                </instance>
      </answerFilter>


      <!-- =================================================================== -->
      <!--  Text Attributes  ++++++++-->
      <!-- =================================================================== -->
       <attributeQueryRef ref="AssemblyAttributes.Bfmv" includeProjects="EuPathDB,CryptoDB,ToxoDB,GiardiaDB,PlasmoDB,TriTrypDB">
        <columnAttribute name="project_id" internal="true" inReportMaker="false"/>
        <columnAttribute name="source_id" internal="true" inReportMaker="false"/>
        <columnAttribute name="organism" internal="true" inReportMaker="true"/>
        <columnAttribute name="formatted_organism"    displayName="Organism"  inReportMaker="false"/>
        <columnAttribute name="est_count"  displayName="EST count" inReportMaker="true" align="center"/>
        <columnAttribute name="a_count" displayName="A Count" inReportMaker="true" align="center"/>
        <columnAttribute name="t_count" displayName="T Count" inReportMaker="true" align="center"/>
        <columnAttribute name="c_count" displayName="C Count" inReportMaker="true" align="center"/>
        <columnAttribute name="g_count" displayName="G Count" inReportMaker="true" align="center"/>
        <columnAttribute name="other_count" displayName="Other Count" inReportMaker="true" align="center"/>
        <columnAttribute name="length" displayName="Length" inReportMaker="true" align="center"/>
       </attributeQueryRef>

       <attributeQueryRef ref="AssemblyAttributes.Sequence" includeProjects="EuPathDB,CryptoDB,ToxoDB,GiardiaDB,PlasmoDB,TriTrypDB">
        <columnAttribute name="sequence" displayName="Sequence" internal="true" inReportMaker="true"/>
       </attributeQueryRef>

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- Overview -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

          <textAttribute name="overview" displayName="Overview" includeProjects="EuPathDB,CryptoDB,ToxoDB,GiardiaDB,PlasmoDB,TriTrypDB"
                         internal="true" inReportMaker="false">

             <text>
                  <![CDATA[
		    Organism:  $$formatted_organism$$<br>
                    Residue counts: <b>A</b>:$$a_count$$, <b>T</b>:$$t_count$$, <b>C</b>:$$c_count$$,
                    <b>G</b>:$$g_count$$, <b>other</b>:$$other_count$$<br>
                    Length: $$length$$<br>
                    Number of ESTs: $$est_count$$
                  ]]>
             </text>

         </textAttribute>

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- DNA Context -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
<!--        <textAttribute name="dnaContext" includeProjects="ToxoDB,CryptoDB,GiardiaDB"
                        displayName="Genomic Context"  
                       inReportMaker="false">
           <text includeProjects="ToxoDB">
                <![CDATA[
                /cgi-bin/gbrowse_img/toxodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;embed=1;type=DoTSAssemblies+AnnotatedGenes+EST;h_feat=$$source_id$$@thistle;width=600;base=/cgi-bin/gbrowse
                ]]>
           </text>
          <text includeProjects="CryptoDB">
                <![CDATA[
                /cgi-bin/gbrowse_img/cryptodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;embed=1;type=Cluster+Gene+EST;h_feat=$$source_id$$@thistle;width=600;base=/cgi-bin/gbrowse
                ]]>
           </text>
        </textAttribute>
-->
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- GBrowse -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
 <!--       <textAttribute name="gbrowseLink"  includeProjects="ToxoDB,CryptoDB,GiardiaDB"
            inReportMaker="false">
            <text includeProjects="ToxoDB">
                 <![CDATA[
                /cgi-bin/gbrowse/toxodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;enable=DoTSAssemblies;h_feat=$$source_id$$@thistle
                ]]>
            </text>
            <text includeProjects="CryptoDB">
                 <![CDATA[
                /cgi-bin/gbrowse/cryptodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;enable=Cluster;h_feat=$$source_id$$@thistle
                ]]>
            </text>
         </textAttribute>

       -->  

     <!-- =================================================================== -->
     <!-- Tables ++++++++-->
     <!-- =================================================================== -->

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- AlignmentInfo -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <table name="AlignmentInfo" includeProjects="ToxoDB,CryptoDB,GiardiaDB,PlasmoDB,TriTrypDB"
               displayName="Alignments to genomic sequence"
               queryRef="AssemblyTables.AlignmentInfo">
            <columnAttribute name="id"            internal="true" />
            <columnAttribute name="source_id"            internal="true" />
            <columnAttribute name="project_id"            internal="true" />
            <columnAttribute name="organism" displayName="Organism"/>
            <columnAttribute name="gene" inReportMaker="true" internal="true"/>
            <columnAttribute name="sequence_id"   internal="true" />
            <columnAttribute name="target_start"  internal="true" />
            <columnAttribute name="target_end"    internal="true" />
            <columnAttribute name="context_start" internal="true" />
            <columnAttribute name="context_end"   internal="true" />

            <columnAttribute displayName="Length" name="length"   internal="false" />
            <columnAttribute displayName="Number of ESTs" name="count" />

            <linkAttribute displayName="Genomic Sequence" name="alignedcontig" inReportMaker="false">
                 <displayText>
                    <![CDATA[ $$sequence_id$$ ]]>
                 </displayText>
                 <url>
                    <![CDATA[
                    showRecord.do?name=SequenceRecordClasses.SequenceRecordClass&project_id=$$project_id$$&source_id=$$sequence_id$$&modgbrowse=startOverride=$$target_start$$:endOverride=$$target_end$$
                    ]]>
                 </url>
            </linkAttribute>

            <columnAttribute displayName="Percent Identity" name="percent_identity" />
            <columnAttribute displayName="Score" name="score" />
            <columnAttribute displayName="Is Consistent" name="is_consistent" />
            <columnAttribute displayName="Is Reversed" name="is_reversed" />

            <linkAttribute displayName="Gene" name="gene_link" inReportMaker="false">
                 <displayText>
                    <![CDATA[ $$gene$$ ]]>
                 </displayText>
                 <url>
                    <![CDATA[
                   showRecord.do?name=GeneRecordClasses.GeneRecordClass&project_id=$$project_id$$&source_id=$$gene$$
                    ]]>
                 </url>
            </linkAttribute>

            <linkAttribute displayName="Alignment" name="alignmentlink" inReportMaker="false">
                 <displayText>
                    <![CDATA[ view ]]>
                 </displayText>
                 <url includeProjects="GiardiaDB">
                    <![CDATA[
                    /cgi-bin/gbrowse/giardiadb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;label=Gene;label=DoTSAssemblies;label=Cluster;h_feat=$$id$$
                    ]]>
                 </url>
 <url includeProjects="CryptoDB">
                    <![CDATA[
                    /cgi-bin/gbrowse/cryptodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;label=Gene;label=EST;label=Cluster;h_feat=$$id$$
                    ]]>
                 </url>
                 <url includeProjects="ToxoDB">
                    <![CDATA[
                    /cgi-bin/gbrowse/toxodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;label=AnnotatedGenes;label=DoTSAssemblies;h_feat=$$id$$
                    ]]>
                 </url>
                 <url includeProjects="PlasmoDB">
                    <![CDATA[
                     /cgi-bin/gbrowse/plasmodb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;label=AnnotatedGenes;label=DoTSAssemblies;h_feat=$$id$$
                    ]]>
                 </url>
                 <url includeProjects="TriTrypDB">
                    <![CDATA[
                     /cgi-bin/gbrowse/trypdb/?name=$$sequence_id$$%3A$$context_start$$-$$context_end$$;label=AnnotatedGenes;label=DoTSAssemblies;h_feat=$$id$$
                    ]]>
                 </url>

            </linkAttribute>

        </table>  

        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- LibraryInfo -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <table name="LibraryInfo" includeProjects="ToxoDB,CryptoDB,GiardiaDB,PlasmoDB,TriTrypDB"
               displayName="Libraries"
               queryRef="AssemblyTables.LibraryInfo">
            <columnAttribute displayName="Library"  name="library"/>
            <columnAttribute displayName="Number of ESTs" name="est_count"/>

        </table>  


        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <!-- EstInfo -->  
        <!--++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
        <table name="EstInfo" includeProjects="ToxoDB,CryptoDB,GiardiaDB,PlasmoDB,TriTrypDB"
               displayName="ESTs in Assembly"
               queryRef="AssemblyTables.EstInfo">
            <columnAttribute displayName="EST" name="est"  internal="true"  inReportMaker="true"/>
            <linkAttribute displayName="EST" name="est_link"  inReportMaker="false">
                 <displayText>
                    <![CDATA[
                    $$est$$
                    ]]>
                 </displayText>
                <url>
                <![CDATA[showRecord.do?name=EstRecordClasses.EstRecordClass&primary_key=$$est$$]]>
                </url>
            </linkAttribute>
            <columnAttribute displayName="Start" name="start"/>
            <columnAttribute displayName="End" name="end"/>
            <columnAttribute displayName="Strand" name="assembly_strand"/>
            <columnAttribute displayName="Gapped Length" name="gapped_length"/>
            <columnAttribute displayName="Library"  name="library"/>
        </table>  


      </recordClass>
    </recordClassSet>
</wdkModel>
