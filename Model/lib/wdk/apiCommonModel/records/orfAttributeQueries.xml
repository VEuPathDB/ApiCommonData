<wdkModel>
    <querySet name="OrfAttributes" queryType="attribute">

      <defaultTestParamValues includeProjects="PlasmoDB">
         <paramValue name="source_id">PB_RP3804-2-1862-2092</paramValue>
         <paramValue name="project_id">PlasmoDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="ToxoDB">
         <paramValue name="source_id">scf_1104442822256-1-1399492-1399677</paramValue>
         <paramValue name="project_id">ToxoDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="CryptoDB">
         <paramValue name="source_id">AAEE01000015-4-52922-52668</paramValue>
         <paramValue name="project_id">CryptoDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="GiardiaDB">
         <paramValue name="source_id">AACB02000007-2-49229-49390</paramValue>
         <paramValue name="project_id">GiardiaDB</paramValue>
      </defaultTestParamValues>

      <defaultTestParamValues includeProjects="TrichDB">
         <paramValue name="source_id">DS164731-2-86-799</paramValue>
         <paramValue name="project_id">TrichDB</paramValue>
      </defaultTestParamValues>

       <!-- TODO revisit source_id --> 
       <defaultTestParamValues includeProjects="TriTrypDB">
           <paramValue name="source_id">Lbr.chr26-1-799135-799317</paramValue>
           <paramValue name="project_id">TriTrypDB</paramValue>
       </defaultTestParamValues>

      <testRowCountSql>
               select count(na_feature_id)
               from dots.miscellaneous f, sres.SequenceOntology so
               where so.sequence_ontology_id = f.sequence_ontology_id
                 and so.term_name = 'ORF'
      </testRowCountSql>

        <sqlQuery name="Bfmv">
            <column name="source_id"/>
            <column name="project_id"/>
            <column name="nas_id"  />
            <!--column name="orf_id"  sortingColumn="source_id" /-->
            <column name="length"  />
            <column name="organism"  />
            <column name="formatted_organism"  sortingColumn="organism" />
            <column name="orf_start" />
            <column name="orf_end" />
            <column name="orf_start_text" sortingColumn="orf_start" />
            <column name="orf_end_text" sortingColumn="orf_end" />
            <column name="orf_strand" />
            <sql>
            <![CDATA[
                SELECT bfmv.source_id, bfmv.project_id, bfmv.nas_id, bfmv.length, bfmv.organism, bfmv.ncbi_tax_id,
                       '<i>' || SUBSTR(bfmv.organism, 1, 1) || '.' ||
                       REGEXP_REPLACE(SUBSTR(bfmv.organism, INSTR(bfmv.organism, ' ')), '[[:space:]]+',
                                      chr(38) || 'nbsp;') || '</i>'
                         AS formatted_organism,
                      bfmv.start_min as orf_start,bfmv.end_max as orf_end,
                      trim(to_char(bfmv.end_max,'999,999,999')) as orf_end_text,
                      trim(to_char(bfmv.start_min,'999,999,999')) as orf_start_text,
                      decode(bfmv.is_reversed,0,'+',1,'-',null) as orf_strand
                FROM apidb.OrfAttributes bfmv
        ]]>
           </sql>
        </sqlQuery>

	<sqlQuery name="Sequence">
            <column name="source_id"/>
            <column name="project_id"/>
            <column name="sequence"/>
            <sql excludeProjects="EuPathDB">
               SELECT source_id, '@PROJECT_ID@' as project_id, sequence
               FROM   apidb.orfSequence
           </sql>


           <sql includeProjects="EuPathDB">
                  SELECT taas.source_id as source_id, ext.name as project_id, taas.sequence
                	  from dots.TranslatedAASequence taas,
                      	 sres.SequenceOntology s,
                      	 sres.ExternalDatabaseRelease extr,
         	         sres.ExternalDatabase ext
                	 WHERE taas.sequence_ontology_id = s.sequence_ontology_id
                    	  AND s.term_name = 'ORF'
                   	  AND taas.external_database_release_id=extr.external_database_release_id
                 	  AND extr.external_database_id=ext.external_database_id
           </sql>
        </sqlQuery>
    </querySet>
</wdkModel>
