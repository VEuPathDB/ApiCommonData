#!@perl@
use strict;

use lib "$ENV{GUS_HOME}/lib/perl";
use File::Basename;
use ApiCommonData::Load::Steps;
use ApiCommonData::Load::MakeTaskDirs;

my $propertiesFile = shift(@ARGV);
my $optionalArgs = \@ARGV;


my ($mgr, $projectDir, $release, $allSpecies)
  = &initPlasmoAnalysis($propertiesFile, $optionalArgs);

my $dataDir = $mgr->{dataDir};

##############################################################################
########   The Pipeline                                               ########
##############################################################################


#My $apiDbGusConfigFile = $mgr->{propertySet}->getProp('apiDbGusConfigFile');

#$mgr->addCleanupCommand("updateMaterializedViews --owner apidb --gusConfigFile $apiDbGusConfigFile");

&documentGeneAliases($mgr);

&copy($mgr,"$projectDir/manualDelivery/aliases.tab","$projectDir/$release/analysis_pipeline/primary/data/misc/","$projectDir/$release/analysis_pipeline/primary/data/misc/");

&fixGeneAliases($mgr,"aliases.tab");

##### BLASTX #####
my $blastParams = "-cpus=4 -topcomboN=1 W=4 T=18 V=100 B=1000000 -hspmax=1000000 -gi E=1e-3 -wordmask=seg+xnu -hspsepQmax=4000 -span1";

&documentBlast($mgr, 'BLASTX', "Genomic sequence", "NRDB", $blastParams);

#regex for nr >gi|2829894|gb|AAC00602.1| Unknown protein [Arabidopsis thaliana]
&createSimilarityDir($mgr,"PfalciparumChroms","nr","gi\\|(\\d+)\\|","$blastParams Y=23267177","blastx");

&createSimilarityDir($mgr,"PvivaxContigs","nr","gi\\|(\\d+)\\|","$blastParams Y=26957458","blastx");

&createSimilarityDir($mgr,"PyoeliiContigs","nr","gi\\|(\\d+)\\|","$blastParams Y=20171213","blastx");

&createSimilarityDir($mgr,"PbergheiContigs","nr","gi\\|(\\d+)\\|","$blastParams Y=17996878","blastx");

&createSimilarityDir($mgr,"PchabaudiContigs","nr","gi\\|(\\d+)\\|","$blastParams Y=16893362","blastx");

&createSimilarityDir($mgr,"PknowlesiChroms","nr","gi\\|(\\d+)\\|","$blastParams Y=16893362","blastx");

&createSimilarityDir($mgr,"PfalciparumPlastid","nr","gi\\|(\\d+)\\|","$blastParams Y=29430","blastx");

&createSimilarityDir($mgr,"PfalciparumMito","nr","gi\\|(\\d+)\\|","$blastParams Y=5967","blastx");

&createSimilarityDir($mgr,"PvivaxMito","nr","gi\\|(\\d+)\\|","$blastParams Y=5990","blastx");

&copyFilesToComputeCluster($mgr,"PfalciparumChroms-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PvivaxContigs-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PyoeliiContigs-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PbergheiContigs-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PchabaudiContigs-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PknowlesiChroms-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PfalciparumPlastid-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PfalciparumMito-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PvivaxMito-nr","similarity");

&moveDownloadFile($mgr,"NRDB/nr.gz","seqfiles");

&shortenDefLine($mgr,"nr","seqfiles");

##### extract files for BLASTX #####

&extractNaSeq($mgr,"Sanger P. falciparum chromosomes","2007-06-28",'Pfalciparum',"chroms","ExternalNASequence","source_id");

&extractNaSeq($mgr,"P.vivax contigs from Genbank","2007-06-13",'Pvivax',"contigs","ExternalNASequence","source_id");

&extractNaSeq($mgr,"Jane Carlton P. yoelii chromosomes","2002-09-10",'Pyoelii',"contigs","ExternalNASequence","source_id");

&extractNaSeq($mgr,"P. berghei genome","2006-02-27",'Pberghei',"contigs","ExternalNASequence","source_id");

&extractNaSeq($mgr,"P. chabaudi genome","2006-02-27",'Pchabaudi',"contigs","ExternalNASequence","source_id");

&extractNaSeq($mgr,"Sanger P. knowlesi chromosomes","2007-10-03",'Pknowlesi',"chroms","ExternalNASequence","source_id");

&extractNaSeq($mgr,"P. falciparum plastid-like DNA","2",'Pfalciparum',"plastid","ExternalNASequence","source_id");

&extractNaSeq($mgr,"P. falciparum mitochondrial genome","1",'Pfalciparum',"mito","ExternalNASequence","source_id");

&extractNaSeq($mgr,"Sanger P. reichenowi contigs","2004-03-11",'Preichenowi',"contigs","ExternalNASequence","source_id");

&extractNaSeq($mgr,"Sanger P. gallinaceum contigs","2007-01-03",'Pgallinaceum',"contigs","ExternalNASequence","source_id");

&extractNaSeq($mgr,"P. vivax mitochondrial genome","2005-07-12",'Pvivax',"mito","ExternalNASequence","source_id");

##### set up and run BLASTX of genomes against nr #####

 &copyFilesToComputeCluster($mgr,"PfalciparumChroms.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PvivaxContigs.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PyoeliiContigs.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PbergheiContigs.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PchabaudiContigs.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PknowlesiChroms.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PfalciparumPlastid.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PfalciparumMito.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PvivaxMito.fsa","seqfiles");

# perl -e 'while(<>){if ($_ !~ /^>/){ $_ =~ s/J/X/g;}print "$_";}' nr_bak.fas > nr.fas replace the 'J' in the seq with 'X'; 
# use xdformat -k to ignore the invalid letter 

&copyFilesToComputeCluster($mgr,"nr.fsa","seqfiles");

&startProteinBlastOnComputeCluster($mgr,"PfalciparumChroms","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PvivaxContigs","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PyoeliiContigs","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PbergheiContigs","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PchabaudiContigs","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PknowlesiChroms","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PfalciparumPlastid","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PfalciparumMito","nr","apidb","4");

&startProteinBlastOnComputeCluster($mgr,"PvivaxMito","nr","apidb","4");

##### BLASTP #####

$blastParams = "-cpus=2 -topcomboN=1 V=100 B=20 -hspmax=1000000 -gi E=1e-3 -wordmask=seg -hspsepQmax=4000 -span1";

&documentBlast($mgr, 'BLASTP', "Protein sequences", "NRDB", $blastParams);

&createSimilarityDir($mgr,"PfalciparumAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams, "blastp");

&createSimilarityDir($mgr,"PvivaxAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams, "blastp");

&createSimilarityDir($mgr,"PyoeliiAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams,"blastp");

&createSimilarityDir($mgr,"PbergheiAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams,"blastp");

&createSimilarityDir($mgr,"PchabaudiAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams,"blastp");

&createSimilarityDir($mgr,"PknowlesiAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams, "blastp");

&createSimilarityDir($mgr,"PfalciparumMitoAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams, "blastp");

&createSimilarityDir($mgr,"PfalciparumPlastidAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams, "blastp");

&createSimilarityDir($mgr,"PvivaxMitoAnnotatedProteins","nr","gi\\|(\\d+)\\|", $blastParams, "blastp");

 &copyFilesToComputeCluster($mgr,"PfalciparumAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PvivaxAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PyoeliiAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PbergheiAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PchabaudiAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PknowlesiAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PfalciparumPlastidAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PfalciparumMitoAnnotatedProteins-nr","similarity");

 &copyFilesToComputeCluster($mgr,"PvivaxMitoAnnotatedProteins-nr","similarity");

##### Calculate protiens, protein Wt, and Isoelectric Point #####

&calculateTranslatedProteinSequence($mgr,"Sanger P. falciparum chromosomes","2007-06-28","2.2");

&calculateTranslatedProteinSequence($mgr,"Sanger P. knowlesi chromosomes","2007-10-03","2.2");

&calculateProteinMolWt($mgr,"Pfalciparum","Sanger P. falciparum chromosomes","2007-06-28","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"Pvivax","P.vivax contigs from Genbank","2007-06-13","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"Pyoelii","Jane Carlton P. yoelii chromosomes","2002-09-10","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"Pberghei","P. berghei genome","2006-02-27","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"Pchabaudi","P. chabaudi genome","2006-02-27","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"Pknowlesi","Sanger P. knowlesi chromosomes","2007-10-03","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"PfalciparumPlastid","P. falciparum plastid-like DNA","2","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"PfalciparumMito","P. falciparum mitochondrial genome","1","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"PvivaxMito","P. vivax mitochondrial genome","2005-07-12","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"PfEvigan","P. falciparum Evigan Gene Models","2008-01-14","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"Preichenowi","Sanger P. reichenowi contigs","2004-03-11","DoTS.TranslatedAASequence");

&calculateProteinMolWt($mgr,"Pgallinaceum","Sanger P. gallinaceum contigs","2007-01-03","DoTS.TranslatedAASequence");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","Sanger P. falciparum chromosomes","2007-06-28");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","P.vivax contigs from Genbank","2007-06-13");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","Jane Carlton P. yoelii chromosomes","2002-09-10");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","P. berghei genome","2006-02-27");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","P. chabaudi genome","2006-02-27");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","Sanger P. knowlesi chromosomes","2007-10-03");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","P. falciparum plastid-like DNA","2");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","P. falciparum mitochondrial genome","1");

&insertAASeqMWMinMax($mgr,"DoTS.TranslatedAASequence","P. vivax mitochondrial genome","2005-07-12");

&documentAAip($mgr);

&insertAAiP($mgr,"DoTS.TranslatedAASequence","Sanger P. falciparum chromosomes","2007-06-28"); 

&insertAAiP($mgr,"DoTS.TranslatedAASequence","P.vivax contigs from Genbank","2007-06-13");

&insertAAiP($mgr,"DoTS.TranslatedAASequence","Jane Carlton P. yoelii chromosomes","2002-09-10");

&insertAAiP($mgr,"DoTS.TranslatedAASequence","P. berghei genome","2006-02-27");

&insertAAiP($mgr,"DoTS.TranslatedAASequence","P. chabaudi genome","2006-02-27");

&insertAAiP($mgr,"DoTS.TranslatedAASequence","Sanger P. knowlesi chromosomes","2007-10-03");

&insertAAiP($mgr,"DoTS.TranslatedAASequence","P. falciparum plastid-like DNA","2");

&insertAAiP($mgr,"DoTS.TranslatedAASequence","P. falciparum mitochondrial genome","1");

&insertAAiP($mgr,"DoTS.TranslatedAASequence","P. vivax mitochondrial genome","2005-07-12");

##### extract sequences for BLASTP #####


&extractAnnotatedProteinsBySpecies($mgr, "Pfalciparum","Sanger P. falciparum chromosomes","2007-06-28",36329);

&extractAnnotatedProteinsBySpecies($mgr, "Pvivax","P.vivax contigs from Genbank","2007-06-13",126793);

&extractAnnotatedProteinsBySpecies($mgr, "Pyoelii","Jane Carlton P. yoelii chromosomes","2002-09-10",352914);

&extractAnnotatedProteinsBySpecies($mgr, "Pberghei","P. berghei genome","2006-02-27",5823);

&extractAnnotatedProteinsBySpecies($mgr, "Pchabaudi","P. chabaudi genome","2006-02-27",31271);

&extractAnnotatedProteinsBySpecies($mgr, "Pknowlesi","Sanger P. knowlesi chromosomes","2007-10-03",5851);

&extractAnnotatedProteinsBySpecies($mgr, "PfalciparumPlastid","P. falciparum plastid-like DNA","2",36329);

&extractAnnotatedProteinsBySpecies($mgr, "PfalciparumMito","P. falciparum mitochondrial genome","1",36329);

&extractAnnotatedProteinsBySpecies($mgr, "PvivaxMito","P. vivax mitochondrial genome","2005-07-12",126793);


##### set up for BLASTP of proteins against nr #####

 &copyFilesToComputeCluster($mgr,"PfalciparumAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PvivaxAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PyoeliiAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PbergheiAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PchabaudiAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PknowlesiAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PfalciparumPlastidAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PfalciparumMitoAnnotatedProteins.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PvivaxMitoAnnotatedProteins.fsa","seqfiles");

######## Psipred ########

&documentPsipred($mgr,"2.4");

&createPsipredDirWithFormattedDb($mgr,"nr.fsa","seqfiles");

&fixProteinIdsForPsipred($mgr,"PfalciparumAnnotatedProteins.fsa","seqfiles");

&fixProteinIdsForPsipred($mgr,"PvivaxAnnotatedProteins.fsa","seqfiles");

&fixProteinIdsForPsipred($mgr,"PyoeliiAnnotatedProteins.fsa","seqfiles");

&fixProteinIdsForPsipred($mgr,"PbergheiAnnotatedProteins.fsa","seqfiles");

&fixProteinIdsForPsipred($mgr,"PchabaudiAnnotatedProteins.fsa","seqfiles");

&fixProteinIdsForPsipred($mgr,"PknowlesiAnnotatedProteins.fsa","seqfiles");

&createPsipredSubdir($mgr,"PfalciparumAnnotatedProteinsPsipred.fsa","nr.fsa");

&createPsipredSubdir($mgr,"PvivaxAnnotatedProteinsPsipred.fsa","nr.fsa");

&createPsipredSubdir($mgr,"PyoeliiAnnotatedProteinsPsipred.fsa","nr.fsa");

&createPsipredSubdir($mgr,"PbergheiAnnotatedProteinsPsipred.fsa","nr.fsa");

&createPsipredSubdir($mgr,"PchabaudiAnnotatedProteinsPsipred.fsa","nr.fsa");

&createPsipredSubdir($mgr,"PknowlesiAnnotatedProteinsPsipred.fsa","nr.fsa");

 &copyFilesToComputeCluster($mgr, "psipred");

 &copyFilesToComputeCluster($mgr,"PfalciparumAnnotatedProteinsPsipred.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PvivaxAnnotatedProteinsPsipred.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PyoeliiAnnotatedProteinsPsipred.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PchabaudiAnnotatedProteinsPsipred.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PbergheiAnnotatedProteinsPsipred.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PknowlesiAnnotatedProteinsPsipred.fsa","seqfiles");

&startPsipredOnComputeCluster($mgr,"PfalciparumAnnotatedProteinsPsipred.fsa","nr.fsa","apidb");

&startPsipredOnComputeCluster($mgr,"PvivaxAnnotatedProteinsPsipred.fsa","nr.fsa","apidb");

&startPsipredOnComputeCluster($mgr,"PyoeliiAnnotatedProteinsPsipred.fsa","nr.fsa","apidb");

&startPsipredOnComputeCluster($mgr,"PchabaudiAnnotatedProteinsPsipred.fsa","nr.fsa","apidb");

&startPsipredOnComputeCluster($mgr,"PbergheiAnnotatedProteinsPsipred.fsa","nr.fsa","apidb");

&startPsipredOnComputeCluster($mgr,"PknowlesiAnnotatedProteinsPsipred.fsa","nr.fsa","apidb");

 $mgr->waitForCluster("PfalciparumAnnotatedProteinsPsipred vs nr.fsaFilt psipred", "PfalciparumAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

 $mgr->waitForCluster("PyoeliiAnnotatedProteinsPsipred vs nr.fsaFilt psipred", "PyoeliiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

 $mgr->waitForCluster("PvivaxAnnotatedProteinsPsipred vs nr.fsaFilt psipred", "PvivaxAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

 $mgr->waitForCluster("PbergheiAnnotatedProteinsPsipred vs nr.fsaFilt psipred", "PbergheiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

 $mgr->waitForCluster("PchabaudiAnnotatedProteinsPsipred vs nr.fsaFilt psipred", "PchabaudiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

 $mgr->waitForCluster("PknowlesiAnnotatedProteinsPsipred vs nr.fsaFilt psipred", "PknowlesiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

&copyFilesFromComputeCluster($mgr, "PfalciparumAnnotatedProteinsPsipred.fsa-nr.fsaFilt", "psipred");

&copyFilesFromComputeCluster($mgr, "PvivaxAnnotatedProteinsPsipred.fsa-nr.fsaFilt", "psipred");

&copyFilesFromComputeCluster($mgr, "PyoeliiAnnotatedProteinsPsipred.fsa-nr.fsaFilt", "psipred");

&copyFilesFromComputeCluster($mgr, "PbergheiAnnotatedProteinsPsipred.fsa-nr.fsaFilt", "psipred");

&copyFilesFromComputeCluster($mgr, "PchabaudiAnnotatedProteinsPsipred.fsa-nr.fsaFilt", "psipred");

&copyFilesFromComputeCluster($mgr, "PknowlesiAnnotatedProteinsPsipred.fsa-nr.fsaFilt", "psipred");

&fixPsipredFileNames($mgr, "psipred/PfalciparumAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

&fixPsipredFileNames($mgr, "psipred/PvivaxAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

&fixPsipredFileNames($mgr, "psipred/PyoeliiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

&fixPsipredFileNames($mgr, "psipred/PbergheiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

&fixPsipredFileNames($mgr, "psipred/PchabaudiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

&fixPsipredFileNames($mgr, "psipred/PknowlesiAnnotatedProteinsPsipred.fsa-nr.fsaFilt");

### !!!!NEED TO UPDATE THE START AND END DATES BEFORE WE RUN THIS STEP!!!!! ###
&makeAlgInv($mgr,"Psipred","Psipred method for protein secondary structure prediction","2.5","2008-06-06","2008-07-02","Secondary Structure prediction for all Pfalciparum annotated proteins","Pfalciparum");

&makeAlgInv($mgr,"Psipred","Psipred method for protein secondary structure prediction","2.5","2008-06-06","2008-07-02","Secondary Structure prediction for all Pvivax annotated proteins","Pvivax");

&makeAlgInv($mgr,"Psipred","Psipred method for protein secondary structure prediction","2.5","2008-06-06","2008-07-02","Secondary Structure prediction for all Pyoelii annotated proteins","Pyoelii");

&makeAlgInv($mgr,"Psipred","Psipred method for protein secondary structure prediction","2.5","2008-06-06","2008-07-02","Secondary Structure prediction for all Pberghei annotated proteins","Pberghei");

&makeAlgInv($mgr,"Psipred","Psipred method for protein secondary structure prediction","2.5","2008-06-06","2008-07-02","Secondary Structure prediction for all Pchabaudi annotated proteins","Pchabaudi");

&makeAlgInv($mgr,"Psipred","Psipred method for protein secondary structure prediction","2.5","2008-06-06","2008-07-02","Secondary Structure prediction for all Pknowlesi annotated proteins","Pknowlesi");

&loadSecondaryStructures($mgr,"Psipred","2.5","2008-06-06","2008-07-02","PfalciparumAnnotatedProteinsPsipred.fsa-nr.fsaFilt",1,"Secondary Structure prediction for all Pfalciparum annotated proteins");

&loadSecondaryStructures($mgr,"Psipred","2.5","2008-06-06","2008-07-02","PvivaxAnnotatedProteinsPsipred.fsa-nr.fsaFilt",1,"Secondary Structure prediction for all Pvivax annotated proteins");

&loadSecondaryStructures($mgr,"Psipred","2.5","2008-06-06","2008-07-02","PyoeliiAnnotatedProteinsPsipred.fsa-nr.fsaFilt",1,"Secondary Structure prediction for all Pyoelii annotated proteins");

&loadSecondaryStructures($mgr,"Psipred","2.5","2008-06-06","2008-07-02","PbergheiAnnotatedProteinsPsipred.fsa-nr.fsaFilt",1,"Secondary Structure prediction for all Pberghei annotated proteins");

&loadSecondaryStructures($mgr,"Psipred","2.5","2008-06-06","2008-07-02","PchabaudiAnnotatedProteinsPsipred.fsa-nr.fsaFilt",1,"Secondary Structure prediction for all Pchabaudi annotated proteins");

&loadSecondaryStructures($mgr,"Psipred","2.5","2008-06-06","2008-07-02","PknowlesiAnnotatedProteinsPsipred.fsa-nr.fsaFilt",1,"Secondary Structure prediction for all Pknowlesi annotated proteins");

####### TMHMM steps #######

&createTmhmmDir($mgr);

&documentTMHMM($mgr,"2.0a");

&runTMHmm($mgr,"Pfalciparum");

&runTMHmm($mgr,"Pvivax");

&runTMHmm($mgr,"Pyoelii");

&runTMHmm($mgr,"Pberghei");

&runTMHmm($mgr,"Pchabaudi");

&runTMHmm($mgr,"Pknowlesi");

&runTMHmm($mgr,"PfalciparumPlastid");

&runTMHmm($mgr,"PfalciparumMito");

&runTMHmm($mgr,"PvivaxMito");

&loadTMHmmData($mgr,"Pfalciparum","Sanger P. falciparum chromosomes","2007-06-28");

&loadTMHmmData($mgr,"Pvivax","P.vivax contigs from Genbank","2007-06-13");

&loadTMHmmData($mgr,"Pyoelii","Jane Carlton P. yoelii chromosomes","2002-09-10");

&loadTMHmmData($mgr,"Pberghei","P. berghei genome","2006-02-27");

&loadTMHmmData($mgr,"Pchabaudi","P. chabaudi genome","2006-02-27");

&loadTMHmmData($mgr,"Pknowlesi","Sanger P. knowlesi chromosomes","2007-10-03");

&loadTMHmmData($mgr,"PfalciparumPlastid","P. falciparum plastid-like DNA","2");

&loadTMHmmData($mgr,"PfalciparumMito","P. falciparum mitochondrial genome","1");

&loadTMHmmData($mgr,"PvivaxMito","P. vivax mitochondrial genome","2005-07-12");

$mgr->waitForCluster("PfalciparumChroms blast similarity to nr", "waitPfalciparumChroms-nr");

&copyFilesFromComputeCluster($mgr,"PfalciparumChroms-nr","similarity");

$mgr->waitForCluster("PvivaxContigs blast similarity to nr", "waitPvivaxContigs-nr");

&copyFilesFromComputeCluster($mgr,"PvivaxContigs-nr","similarity");

$mgr->waitForCluster("PyoeliiContigs blast similarity to nr", "waitPyoeliiContigs-nr");

&copyFilesFromComputeCluster($mgr,"PyoeliiContigs-nr","similarity");

$mgr->waitForCluster("PbergheiContigs blast similarity to nr", "waitPbergheiContigs-nr");

&copyFilesFromComputeCluster($mgr,"PbergheiContigs-nr","similarity");

$mgr->waitForCluster("PchabaudiContigs blast similarity to nr", "waitPchabaudiContigs-nr");

&copyFilesFromComputeCluster($mgr,"PchabaudiContigs-nr","similarity");

$mgr->waitForCluster("PknowlesiChroms blast similarity to nr", "waitPknowlesiChroms-nr");

&copyFilesFromComputeCluster($mgr,"PknowlesiChroms-nr","similarity");

$mgr->waitForCluster("PfalciparumPlastid blast similarity to nr", "waitPfalciparumPlastid-nr");

&copyFilesFromComputeCluster($mgr,"PfalciparumPlastid-nr","similarity");

$mgr->waitForCluster("PfalciparumMito blast similarity to nr", "waitPfalciparumMito-nr");

&copyFilesFromComputeCluster($mgr,"PfalciparumMito-nr","similarity");

$mgr->waitForCluster("PvivaxMito blast similarity to nr", "waitPvivaxMito-nr");

&copyFilesFromComputeCluster($mgr,"PvivaxMito-nr","similarity");

##### run BLASTP #####

&startProteinBlastOnComputeCluster($mgr,"PfalciparumAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PvivaxAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PyoeliiAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PbergheiAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PchabaudiAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PknowlesiAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PfalciparumPlastidAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PfalciparumMitoAnnotatedProteins","nr","apidb");

&startProteinBlastOnComputeCluster($mgr,"PvivaxMitoAnnotatedProteins","nr","apidb");

##### Filter and Load BLASTX Results #####

&renameFile($mgr,"nr.fsa","nr_shortDefs.fsa","seqfiles");

&renameFile($mgr,"nr","nr.fsa","seqfiles");

&moveDownloadFile($mgr,"taxonomy/gi_taxid_prot.dmp.gz","misc");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PfalciparumChroms-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PvivaxContigs-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PyoeliiContigs-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PbergheiContigs-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PchabaudiContigs-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PknowlesiChroms-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PfalciparumPlastid-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PfalciparumMito-nr","blastSimilarity.out.gz");

&filterBLASTResults($mgr,"Eukaryota Apicomplexa Plasmodium","gi_taxid_prot.dmp","PvivaxMito-nr","blastSimilarity.out.gz");

&extractIdsFromBlastResult($mgr,"PfalciparumChroms-nr","subject");

&extractIdsFromBlastResult($mgr,"PvivaxContigs-nr","subject");

&extractIdsFromBlastResult($mgr,"PyoeliiContigs-nr","subject");

&extractIdsFromBlastResult($mgr,"PbergheiContigs-nr","subject");

&extractIdsFromBlastResult($mgr,"PchabaudiContigs-nr","subject");

&extractIdsFromBlastResult($mgr,"PknowlesiChroms-nr","subject");

&extractIdsFromBlastResult($mgr,"PfalciparumPlastid-nr","subject");

&extractIdsFromBlastResult($mgr,"PfalciparumMito-nr","subject");

&extractIdsFromBlastResult($mgr,"PvivaxMito-nr","subject");

&loadNRDBSubset($mgr,"PfalciparumChroms-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PvivaxContigs-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PyoeliiContigs-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PbergheiContigs-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PchabaudiContigs-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PknowlesiChroms-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PfalciparumPlastid-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PfalciparumMito-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PvivaxMito-nr","blastSimIds.out","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PfalciparumChroms-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","Sanger P. falciparum chromosomes","2007-06-28","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PvivaxContigs-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","P.vivax contigs from Genbank","2007-06-13","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PyoeliiContigs-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","Jane Carlton P. yoelii chromosomes","2002-09-10","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PbergheiContigs-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","P. berghei genome","2006-02-27","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PchabaudiContigs-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","P. chabaudi genome","2006-02-27","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PknowlesiChroms-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","Sanger P. knowlesi chromosomes","2007-10-03","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PfalciparumPlastid-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","P. falciparum plastid-like DNA","2","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PfalciparumMito-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","P. falciparum mitochondrial genome","1","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PvivaxMito-nr","DoTS::ExternalNASequence", "DoTS::ExternalAASequence","source_id","source_id","P. vivax mitochondrial genome","2005-07-12","NRDB","2008-05-04");

####### signalP steps #######

&createSignalPDir($mgr);

my $signalPParams = "-t euk -f short -m nn+hmm -q -trunc 70";

&documentSignalP($mgr,"3.0",$signalPParams);

&runSignalP($mgr,"Pfalciparum", $signalPParams);

&runSignalP($mgr,"Pvivax", $signalPParams);

&runSignalP($mgr,"Pyoelii", $signalPParams);

&runSignalP($mgr,"Pberghei", $signalPParams);

&runSignalP($mgr,"Pchabaudi", $signalPParams);

&runSignalP($mgr,"Pknowlesi", $signalPParams);

&runSignalP($mgr,"PfalciparumPlastid", $signalPParams);

&runSignalP($mgr,"PfalciparumMito", $signalPParams);

&runSignalP($mgr,"PvivaxMito", $signalPParams);

&loadSignalPData($mgr,"Pfalciparum","Sanger P. falciparum chromosomes","2007-06-28");

&loadSignalPData($mgr,"Pvivax","P.vivax contigs from Genbank","2007-06-13");

&loadSignalPData($mgr,"Pyoelii","Jane Carlton P. yoelii chromosomes","2002-09-10");

&loadSignalPData($mgr,"Pberghei","P. berghei genome","2006-02-27");

&loadSignalPData($mgr,"Pchabaudi","P. chabaudi genome","2006-02-27");

&loadSignalPData($mgr,"Pknowlesi","Sanger P. knowlesi chromosomes","2007-10-03");

&loadSignalPData($mgr,"PfalciparumPlastid","P. falciparum plastid-like DNA","2");

&loadSignalPData($mgr,"PfalciparumMito","P. falciparum mitochondrial genome","1");

&loadSignalPData($mgr,"PvivaxMito","P. vivax mitochondrial genome","2005-07-12");


###### InterPro ######

&createIprscanDir($mgr, "PvivaxAnnotatedProteins.fsa");

&createIprscanDir($mgr, "PyoeliiAnnotatedProteins.fsa");

&createIprscanDir($mgr, "PfalciparumAnnotatedProteins.fsa");

&createIprscanDir($mgr, "PchabaudiAnnotatedProteins.fsa");

&createIprscanDir($mgr, "PbergheiAnnotatedProteins.fsa");

&createIprscanDir($mgr, "PknowlesiAnnotatedProteins.fsa");

#&copyFilesToComputeCluster($mgr,"iprscan");

&startIprScanOnComputeCluster($mgr,"PfalciparumAnnotatedProteins.fsa","apidb", 1);

&startIprScanOnComputeCluster($mgr,"PvivaxAnnotatedProteins.fsa","apidb", 1);

&startIprScanOnComputeCluster($mgr,"PyoeliiAnnotatedProteins.fsa","apidb", 1);

&startIprScanOnComputeCluster($mgr,"PbergheiAnnotatedProteins.fsa","apidb", 1);

&startIprScanOnComputeCluster($mgr,"PchabaudiAnnotatedProteins.fsa","apidb", 1);

&startIprScanOnComputeCluster($mgr,"PknowlesiAnnotatedProteins.fsa","apidb", 1);

###### ExportPred ######

&documentExportPred($mgr,"1.0.1");

&runExportPred($mgr,"Pfalciparum");

&runExportPred($mgr,"Pvivax");

&runExportPred($mgr,"Pyoelii");

&runExportPred($mgr,"Pberghei");

&runExportPred($mgr,"Pchabaudi");

&runExportPred($mgr,"Pknowlesi");

&loadExportPredResults($mgr,"Pfalciparum","Sanger P. falciparum chromosomes|2007-06-28","Sanger P. falciparum chromosomes|2007-06-28");

&loadExportPredResults($mgr,"Pvivax","P.vivax contigs from Genbank|2007-06-13","P.vivax contigs from Genbank|2007-06-13");

&loadExportPredResults($mgr,"Pyoelii","Jane Carlton P. yoelii chromosomes|2002-09-10","Jane Carlton P. yoelii chromosomes|2002-09-10");

&loadExportPredResults($mgr,"Pberghei","P. berghei genome|2006-02-27","P. berghei genome|2006-02-27");

&loadExportPredResults($mgr,"Pchabaudi","P. chabaudi genome|2006-02-27","P. chabaudi genome|2006-02-27");

&loadExportPredResults($mgr,"Pknowlesi","Sanger P. knowlesi chromosomes|2007-10-03","Sanger P. knowlesi chromosomes|2007-10-03");

##### tandem repeat steps #####

my $repeatFinderArgs = "2 7 7 80 20 50 500";

&documentTandemRepeatFinder($mgr,"3.21",$repeatFinderArgs);

&findTandemRepeats($mgr,"PfalciparumChroms.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PvivaxContigs.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PyoeliiContigs.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PbergheiContigs.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PchabaudiContigs.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PknowlesiChroms.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PfalciparumPlastid.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PfalciparumMito.fsa","seqfiles",$repeatFinderArgs);

&findTandemRepeats($mgr,"PvivaxMito.fsa","seqfiles",$repeatFinderArgs);

&loadTandemRepeats($mgr,"PfalciparumChroms.fsa",$repeatFinderArgs,"Sanger P. falciparum chromosomes","2007-06-28");

&loadTandemRepeats($mgr,"PvivaxContigs.fsa",$repeatFinderArgs,"P.vivax contigs from Genbank","2007-06-13");

&loadTandemRepeats($mgr,"PyoeliiContigs.fsa",$repeatFinderArgs,"Jane Carlton P. yoelii chromosomes","2002-09-10");

&loadTandemRepeats($mgr,"PbergheiContigs.fsa",$repeatFinderArgs,"P. berghei genome","2006-02-27");

&loadTandemRepeats($mgr,"PchabaudiContigs.fsa",$repeatFinderArgs,"P. chabaudi genome","2006-02-27");

&loadTandemRepeats($mgr,"PknowlesiChroms.fsa",$repeatFinderArgs,"Sanger P. knowlesi chromosomes","2007-10-03");

&loadTandemRepeats($mgr,"PfalciparumPlastid.fsa",$repeatFinderArgs,"P. falciparum plastid-like DNA","2");

&loadTandemRepeats($mgr,"PfalciparumMito.fsa",$repeatFinderArgs,"P. falciparum mitochondrial genome","1");

&loadTandemRepeats($mgr,"PvivaxMito.fsa",$repeatFinderArgs,"P. vivax mitochondrial genome","2005-07-12");

##### Load BLASTP Results #####

$mgr->waitForCluster("PfalciparumAnnotatedProteins blast similarity to nr", "waitPfalciparumAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PfalciparumAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PvivaxAnnotatedProteins blast similarity to nr", "waitPvivaxAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PvivaxAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PyoeliiAnnotatedProteins blast similarity to nr", "waitPyoeliiAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PyoeliiAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PbergheiAnnotatedProteins blast similarity to nr", "waitPbergheiAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PbergheiAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PchabaudiAnnotatedProteins blast similarity to nr", "waitPchabaudiAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PchabaudiAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PknowlesiAnnotatedProteins blast similarity to nr", "waitPknowlesiAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PknowlesiAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PfalciparumPlastidAnnotatedProteins blast similarity to nr", "waitPfalciparumPlastidAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PfalciparumPlastidAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PfalciparumMitoAnnotatedProteins blast similarity to nr", "waitPfalciparumMitoAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PfalciparumMitoAnnotatedProteins-nr","similarity");

$mgr->waitForCluster("PvivaxMitoAnnotatedProteins blast similarity to nr", "waitPvivaxMitoAnnotatedProteins-nr");

&copyFilesFromComputeCluster($mgr,"PvivaxMitoAnnotatedProteins-nr","similarity");

&extractIdsFromBlastResult($mgr,"PfalciparumAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PvivaxAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PyoeliiAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PbergheiAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PchabaudiAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PknowlesiAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PfalciparumPlastidAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PfalciparumMitoAnnotatedProteins-nr","subject");

&extractIdsFromBlastResult($mgr,"PvivaxMitoAnnotatedProteins-nr","subject");

&loadNRDBSubset($mgr,"PfalciparumAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PvivaxAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PyoeliiAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PbergheiAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PchabaudiAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PknowlesiAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PfalciparumPlastidAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PfalciparumMitoAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadNRDBSubset($mgr,"PvivaxMitoAnnotatedProteins-nr","blastSimIds.out","NRDB","2008-05-04");

&loadProteinBlast($mgr, "PfalciparumAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","Sanger P. falciparum chromosomes","2007-06-28","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PvivaxAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P.vivax contigs from Genbank","2007-06-13","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PyoeliiAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","Jane Carlton P. yoelii chromosomes","2002-09-10","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PbergheiAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P. berghei genome","2006-02-27","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PchabaudiAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P. chabaudi genome","2006-02-27","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PknowlesiAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","Sanger P. knowlesi chromosomes","2007-10-03","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PfalciparumPlastidAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P. falciparum plastid-like DNA","2","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PfalciparumMitoAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P. falciparum mitochondrial genome","1","NRDB","2008-05-04","--subjectsLimit 50");

&loadProteinBlast($mgr, "PvivaxMitoAnnotatedProteins-nr","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P. vivax mitochondrial genome","2005-07-12","NRDB","2008-05-04","--subjectsLimit 50");




##### Map Oligos #####
### Requires Oligos to be loaded ###

&extractAnnotatedTranscriptSeq($mgr,"Sanger P. falciparum chromosomes","2007-06-28",'Pfalciparum',"annotatedTranscripts","Transcript","SplicedNASequence","source_id");

&extractAnnotatedTranscriptSeq($mgr,"Jane Carlton P. yoelii chromosomes","2002-09-10",'Pyoelii',"annotatedTranscripts","Transcript","SplicedNASequence","source_id");

$blastParams = "-nogaps E=0.05","blastn";

&documentBlast($mgr, 'BLASTN', "Oligo sequences", "Genomic or transcript sequences", $blastParams);

&createSimilarityDir($mgr,"DeRisiOligos","PfalciparumChroms","(\\S+)\\s+length","-nogaps E=0.05","blastn");

&createSimilarityDir($mgr,"DeRisiOligos","PfalciparumAnnotatedTranscripts","(\\S+)\\s+length","-nogaps E=0.05","blastn");

&createSimilarityDir($mgr,"VaidyaBergmanOligos","PyoeliiContigs","(\\S+)","-nogaps E=0.05","blastn");

&createSimilarityDir($mgr,"VaidyaBergmanOligos","PyoeliiAnnotatedTranscripts","(\\S+)","-nogaps E=0.05","blastn");

 &copyFilesToComputeCluster($mgr,"DeRisiOligos-PfalciparumChroms","similarity");

 &copyFilesToComputeCluster($mgr,"DeRisiOligos-PfalciparumAnnotatedTranscripts","similarity");

 &copyFilesToComputeCluster($mgr,"VaidyaBergmanOligos-PyoeliiContigs","similarity");

 &copyFilesToComputeCluster($mgr,"VaidyaBergmanOligos-PyoeliiAnnotatedTranscripts","similarity");

&extractNaSeq($mgr,"DeRisi oligos","2.0",'DeRisi',"oligos","ExternalNASequence","source_id");

&moveDownloadFile($mgr,"/Vaidya_Bergman_oligos/PyoeliiVadyiaOligos.fasta","seqfiles");

&renameFile($mgr,"PyoeliiVadyiaOligos.fasta","VaidyaBergmanOligos.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"DeRisiOligos.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PfalciparumAnnotatedTranscripts.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"VaidyaBergmanOligos.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PyoeliiAnnotatedTranscripts.fsa","seqfiles");

&startProteinBlastOnComputeCluster($mgr,"DeRisiOligos","PfalciparumChroms","apidb");

&startProteinBlastOnComputeCluster($mgr,"DeRisiOligos","PfalciparumAnnotatedTranscripts","apidb");

&startProteinBlastOnComputeCluster($mgr,"VaidyaBergmanOligos","PyoeliiContigs","apidb");

&startProteinBlastOnComputeCluster($mgr,"VaidyaBergmanOligos","PyoeliiAnnotatedTranscripts","apidb");

$mgr->waitForCluster("DeRisiOligos blast similarity to PfalciparumChroms", "waitDeRisiOligos-PfalciparumChroms");

&copyFilesFromComputeCluster($mgr,"DeRisiOligos-PfalciparumChroms","similarity");

$mgr->waitForCluster("DeRisiOligos blast similarity to PfalciparumAnnotatedTranscripts", "waitDeRisiOligos-PfalciparumTranscripts");

&copyFilesFromComputeCluster($mgr,"DeRisiOligos-PfalciparumAnnotatedTranscripts","similarity");

$mgr->waitForCluster("VaidyaBergmanOligos blast similarity to PyoeliiContigs", "waitVaidyaBergmanOligos-PyoeliiContigs");

&copyFilesFromComputeCluster($mgr,"VaidyaBergmanOligos-PyoeliiContigs","similarity");

$mgr->waitForCluster("VaidyaBergmanOligos blast similarity to PyoeliiAnnotatedTranscripts", "waitVaidyaBergmanOligos-PyoeliiAnnotatedTranscripts");

&copyFilesFromComputeCluster($mgr,"VaidyaBergmanOligos-PyoeliiAnnotatedTranscripts","similarity");

&loadProteinBlast($mgr, "DeRisiOligos-PfalciparumChroms","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","DeRisi oligos","2.0","Sanger P. falciparum chromosomes","2007-06-28","--hspMatchLength 64 --hspPctIdent 95 --hspsLimit 1");

&loadProteinBlast($mgr, "DeRisiOligos-PfalciparumAnnotatedTranscripts","DoTS::ExternalNASequence", "DoTS::Transcript","source_id","source_id","DeRisi oligos","2.0","Sanger P. falciparum chromosomes","2007-06-28","--hspMatchLength 64 --hspPctIdent 95 --hspsLimit 1");

&loadProteinBlast($mgr, "VaidyaBergmanOligos-PyoeliiContigs","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Vaidya Bergman oligos","1.0","Jane Carlton P. yoelii chromosomes","2002-09-10","--hspMatchLength 59 --noHsps --hspPctIdent 95 --hspsLimit 1"); 

&loadProteinBlast($mgr, "VaidyaBergmanOligos-PyoeliiAnnotatedTranscripts","DoTS::ExternalNASequence", "DoTS::Transcript","source_id","source_id","Vaidya Bergman oligos","1.0","Jane Carlton P. yoelii chromosomes","2002-09-10","--hspMatchLength 59 --noHsps --hspPctIdent 95 --hspsLimit 1");


##### Load InterPro #####

$mgr->waitForCluster("Iprscan of PfalciparumAnnotatedProteins", "waitPfalciparumAnnotatedProteins-iprscan");

&copyFilesFromComputeCluster($mgr,"PfalciparumAnnotatedProteins.fsa","iprscan");

$mgr->waitForCluster("Iprscan of PvivaxAnnotatedProteins", "waitPvivaxAnnotatedProteins-iprscan");

&copyFilesFromComputeCluster($mgr,"PvivaxAnnotatedProteins.fsa","iprscan");

$mgr->waitForCluster("Iprscan of PyoeliiAnnotatedProteins", "waitPyoeliiAnnotatedProteins-iprscan");

&copyFilesFromComputeCluster($mgr,"PyoeliiAnnotatedProteins.fsa","iprscan");

$mgr->waitForCluster("Iprscan of PbergheiAnnotatedProteins", "waitPbergheiAnnotatedProteins-iprscan");

&copyFilesFromComputeCluster($mgr,"PbergheiAnnotatedProteins.fsa","iprscan");

$mgr->waitForCluster("Iprscan of PchabaudiAnnotatedProteins", "waitPchabaudiAnnotatedProteins-iprscan");

&copyFilesFromComputeCluster($mgr,"PchabaudiAnnotatedProteins.fsa","iprscan");

$mgr->waitForCluster("Iprscan of PknowlesiAnnotatedProteins", "waitPknowlesiAnnotatedProteins-iprscan");

&copyFilesFromComputeCluster($mgr,"PknowlesiAnnotatedProteins.fsa","iprscan");

my $insertInterproConfig = "$projectDir/$release/resources_pipeline/primary/downloads/InterproscanData/insertInterpro-config.xml";

my $interpro_version = "17.0";

&loadIprscanResults($mgr,"PfalciparumAnnotatedProteins.fsa", "INTERPRO", $interpro_version, $insertInterproConfig);

&loadIprscanResults($mgr,"PvivaxAnnotatedProteins.fsa", "INTERPRO", $interpro_version, $insertInterproConfig);

&loadIprscanResults($mgr,"PyoeliiAnnotatedProteins.fsa", "INTERPRO", $interpro_version, $insertInterproConfig);

&loadIprscanResults($mgr,"PbergheiAnnotatedProteins.fsa", "INTERPRO", $interpro_version, $insertInterproConfig);

&loadIprscanResults($mgr,"PchabaudiAnnotatedProteins.fsa", "INTERPRO", $interpro_version, $insertInterproConfig);

&loadIprscanResults($mgr,"PknowlesiAnnotatedProteins.fsa", "INTERPRO", $interpro_version, $insertInterproConfig);



##### low complexity steps #####

&documentLowComplexity($mgr, 'seg', 'Protein', 'x');

&filterSequences($mgr,"PfalciparumAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PvivaxAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PyoeliiAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PbergheiAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PchabaudiAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PknowlesiAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PfalciparumPlastidAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PfalciparumMitoAnnotatedProteins.fsa","filter","seg","-x");

&filterSequences($mgr,"PvivaxMitoAnnotatedProteins.fsa","filter","seg","-x");

&documentLowComplexity($mgr, 'dust', 'Genomic', 'N');

&filterSequences($mgr,"PfalciparumChroms.fsa","filter","dust");

&filterSequences($mgr,"PvivaxContigs.fsa","filter","dust");

&filterSequences($mgr,"PyoeliiContigs.fsa","filter","dust");

&filterSequences($mgr,"PbergheiContigs.fsa","filter","dust");

&filterSequences($mgr,"PchabaudiContigs.fsa","filter","dust");

&filterSequences($mgr,"PknowlesiChroms.fsa","filter","dust");

&filterSequences($mgr,"PfalciparumPlastid.fsa","filter","dust");

&filterSequences($mgr,"PfalciparumMito.fsa","filter","dust");

&filterSequences($mgr,"PvivaxMito.fsa","filter","dust");

&loadLowComplexitySequences($mgr,"PfalciparumAnnotatedProteins.fsa.seg","Sanger P. falciparum chromosomes","2007-06-28","protein","x");

&loadLowComplexitySequences($mgr,"PvivaxAnnotatedProteins.fsa.seg","P.vivax contigs from Genbank","2007-06-13","protein","x");

&loadLowComplexitySequences($mgr,"PyoeliiAnnotatedProteins.fsa.seg","Jane Carlton P. yoelii chromosomes","2002-09-10","protein","x");

&loadLowComplexitySequences($mgr,"PbergheiAnnotatedProteins.fsa.seg","P. berghei genome","2006-02-27","protein","x");

&loadLowComplexitySequences($mgr,"PchabaudiAnnotatedProteins.fsa.seg","P. chabaudi genome","2006-02-27","protein","x");

&loadLowComplexitySequences($mgr,"PknowlesiAnnotatedProteins.fsa.seg","Sanger P. knowlesi chromosomes","2007-10-03","protein","x");

&loadLowComplexitySequences($mgr,"PfalciparumPlastidAnnotatedProteins.fsa.seg","P. falciparum plastid-like DNA","2","protein","x");

&loadLowComplexitySequences($mgr,"PfalciparumMitoAnnotatedProteins.fsa.seg","P. falciparum mitochondrial genome","1","protein","x");

&loadLowComplexitySequences($mgr,"PvivaxMitoAnnotatedProteins.fsa.seg","P. vivax mitochondrial genome","2005-07-12","protein","x");

&loadLowComplexitySequences($mgr,"PfalciparumChroms.fsa.dust","Sanger P. falciparum chromosomes","2007-06-28","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PvivaxContigs.fsa.dust","P.vivax contigs from Genbank","2007-06-13","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PyoeliiContigs.fsa.dust","Jane Carlton P. yoelii chromosomes","2002-09-10","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PbergheiContigs.fsa.dust","P. berghei genome","2006-02-27","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PchabaudiContigs.fsa.dust","P. chabaudi genome","2006-02-27","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PknowlesiChroms.fsa.dust","Sanger P. knowlesi chromosomes","2007-10-03","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PfalciparumPlastid.fsa.dust","P. falciparum plastid-like DNA","2","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PfalciparumMito.fsa.dust","P. falciparum mitochondrial genome","1","dna","N","--LowComplexityName 'dust'");

&loadLowComplexitySequences($mgr,"PvivaxMito.fsa.dust","P. vivax mitochondrial genome","2005-07-12","dna","N","--LowComplexityName 'dust'");


#### ORFs ####

&makeOrfFile($mgr, "PfalciparumChroms.fsa", 50);

&makeOrfFile($mgr, "PvivaxContigs.fsa", 50);

&makeOrfFile($mgr, "PyoeliiContigs.fsa", 50);

&makeOrfFile($mgr, "PbergheiContigs.fsa", 50);

&makeOrfFile($mgr, "PchabaudiContigs.fsa", 50);

&makeOrfFile($mgr, "PreichenowiContigs.fsa", 50);

&makeOrfFile($mgr, "PgallinaceumContigs.fsa", 50);

&makeOrfFile($mgr, "PknowlesiChroms.fsa", 50);

&makeOrfFile($mgr, "PvivaxMito.fsa", 50);

&makeOrfFile($mgr, "PfalciparumPlastid.fsa", 50);

&makeOrfFile($mgr, "PfalciparumMito.fsa", 50);

&loadOrfFile($mgr, "PfalciparumChroms_orf50.gff","Sanger P. falciparum chromosomes","2007-06-28", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2","ExternalNASequence","Plasmodium falciparum 3D7");

&loadOrfFile($mgr, "PvivaxContigs_orf50.gff","P.vivax contigs from Genbank","2007-06-13", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2","ExternalNASequence","Plasmodium vivax");

&loadOrfFile($mgr, "PknowlesiChroms_orf50.gff","Sanger P. knowlesi chromosomes","2007-10-03", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2 ","ExternalNASequence","Plasmodium knowlesi H");

&loadOrfFile($mgr, "PyoeliiContigs_orf50.gff","Jane Carlton P. yoelii chromosomes","2002-09-10", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2","ExternalNASequence","Plasmodium yoelii yoelii str. 17XNL");

&loadOrfFile($mgr, "PbergheiContigs_orf50.gff","P. berghei genome","2006-02-27", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2","ExternalNASequence","Plasmodium berghei strain ANKA");

&loadOrfFile($mgr, "PchabaudiContigs_orf50.gff","P. chabaudi genome","2006-02-27", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2 ","ExternalNASequence","Plasmodium chabaudi chabaudi");

&loadOrfFile($mgr, "PreichenowiContigs_orf50.gff","Sanger P. reichenowi contigs","2004-03-11", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2 ","ExternalNASequence","Plasmodium reichenowi");

&loadOrfFile($mgr, "PgallinaceumContigs_orf50.gff","Sanger P. gallinaceum contigs","2007-01-03", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2 ","ExternalNASequence","Plasmodium gallinaceum");

&loadOrfFile($mgr, "PfalciparumPlastid_orf50.gff","P. falciparum plastid-like DNA","2", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2 ","ExternalNASequence","Plasmodium falciparum 3D7");

&loadOrfFile($mgr, "PfalciparumMito_orf50.gff","P. falciparum mitochondrial genome","1", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2 ","ExternalNASequence","Plasmodium falciparum 3D7");

&loadOrfFile($mgr, "PvivaxMito_orf50.gff","P. vivax mitochondrial genome","2005-07-12", "$ENV{GUS_HOME}/lib/xml/isf/orf2gus.xml", "2.2 ","ExternalNASequence","Plasmodium vivax Sal-1");

####### TRNAScan #######

&documentTRNAScan($mgr,'1.4','trainingOption=C');

&createTRNAscanDir($mgr,"PyoeliiContigs.fsa","C");

&createTRNAscanDir($mgr,"PchabaudiContigs.fsa","C");

&createTRNAscanDir($mgr,"PbergheiContigs.fsa","C");

&copyFilesToComputeCluster($mgr, "trnascan");

&startTRNAscanOnComputeCluster($mgr,"PyoeliiContigs.fsa","apidb");

&startTRNAscanOnComputeCluster($mgr,"PbergheiContigs.fsa","apidb");

&startTRNAscanOnComputeCluster($mgr,"PchabaudiContigs.fsa","apidb");

$mgr->waitForCluster("tRNAscan of PyoeliiContigs.fsa", "waitPyoeliiContigsTRNAscan");

$mgr->waitForCluster("tRNAscan of PbergheiContigs.fsa", "waitPbergheiContigsTRNAscan");

$mgr->waitForCluster("tRNAscan of PchabaudiContigs.fsa", "waitPchabaudiContigsTRNAscan");

&copyFilesFromComputeCluster($mgr,"PyoeliiContigs","trnascan");

&copyFilesFromComputeCluster($mgr,"PbergheiContigs","trnascan");

&copyFilesFromComputeCluster($mgr,"PchabaudiContigs","trnascan");

&createExtDbAndDbRls($mgr,"tRNAscan-SE","1.23","annotation data from tRNAscan-SE analysis");

&loadTRNAscan($mgr,"tRNAscan-SE","1.23","Jane Carlton P. yoelii chromosomes","2002-09-10","2.2","PyoeliiContigs");

&loadTRNAscan($mgr,"tRNAscan-SE","1.23","P. berghei genome","2006-02-27","2.2","PbergheiContigs");

&loadTRNAscan($mgr,"tRNAscan-SE","1.23","P. chabaudi genome","2006-02-27","2.2","PchabaudiContigs");

&loadAnticodons($mgr,"Sanger P. falciparum chromosomes","2007-06-28","PfAntiCodons");

&rnaScanToGff2($mgr,"PbergheiContigs");

&rnaScanToGff2($mgr,"PchabaudiContigs");

&rnaScanToGff2($mgr,"PyoeliiContigs");


#### Extract Transcripts #####

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"Sanger P. falciparum chromosomes","2007-06-28",'Pfalciparum',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"P.vivax contigs from Genbank","2007-06-13",'Pvivax',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"Jane Carlton P. yoelii chromosomes","2002-09-10",'Pyoelii',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"P. berghei genome","2006-02-27",'Pberghei',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"P. chabaudi genome","2006-02-27",'Pchabaudi',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"Sanger P. knowlesi chromosomes","2007-10-03",'Pknowlesi',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"P. falciparum plastid-like DNA","2",'PfalciparumPlastid',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"P. falciparum mitochondrial genome","1",'PfalciparumMito',"allTranscripts","Transcript","ExternalNASequence","source_id");

&extractAnnotatedAndPredictedTranscriptSeq($mgr,"P. vivax mitochondrial genome","2005-07-12",'PvivaxMito',"allTranscripts","Transcript","ExternalNASequence","source_id");


##### PDB #####
### Depends on PDB Protein Sequences ###

&findProteinXRefs($mgr,"PfalciparumAnnotatedProteins.fsa","nr.fsa","^\\|\\d+\\|(?:emb|gb|dbj|ref|sp|pdb)\\|([\\w\\.]+)\\|","^([\\w\\.]+)");

&findProteinXRefs($mgr,"PvivaxAnnotatedProteins.fsa","nr.fsa","^\\|\\d+\\|(?:emb|gb|dbj|ref|sp|pdb)\\|([\\w\\.]+)\\|","^(\\w+)");

&findProteinXRefs($mgr,"PyoeliiAnnotatedProteins.fsa","nr.fsa","^\\|\\d+\\|(?:emb|gb|dbj|ref|sp|pdb)\\|([\\w\\.]+)\\|","^(\\w+)");

&findProteinXRefs($mgr,"PbergheiAnnotatedProteins.fsa","nr.fsa","^\\|\\d+\\|(?:emb|gb|dbj|ref|sp|pdb)\\|([\\w\\.]+)\\|","^([\\w\\.]+)");

&findProteinXRefs($mgr,"PchabaudiAnnotatedProteins.fsa","nr.fsa","^\\|\\d+\\|(?:emb|gb|dbj|ref|sp|pdb)\\|([\\w\\.]+)\\|","^([\\w\\.]+)");

&findProteinXRefs($mgr,"PknowlesiAnnotatedProteins.fsa","nr.fsa","^\\|\\d+\\|(?:emb|gb|dbj|ref|sp|pdb)\\|([\\w\\.]+)\\|","^([\\w\\.]+)");

 &loadDbXRefs($mgr, "PfalciparumAnnotatedProteins.fsa", "emb,gb,dbj,ref,sp,pdb", "2008-05-04");

 &loadDbXRefs($mgr, "PvivaxAnnotatedProteins.fsa", "emb,gb,dbj,ref,sp,pdb", "2008-05-04");

 &loadDbXRefs($mgr, "PyoeliiAnnotatedProteins.fsa", "emb,gb,dbj,ref,sp,pdb", "2008-05-04");

 &loadDbXRefs($mgr, "PbergheiAnnotatedProteins.fsa", "emb,gb,dbj,ref,sp,pdb", "2008-05-04");

 &loadDbXRefs($mgr, "PchabaudiAnnotatedProteins.fsa", "emb,gb,dbj,ref,sp,pdb", "2008-05-04");

 &loadDbXRefs($mgr, "PknowlesiAnnotatedProteins.fsa", "emb,gb,dbj,ref,sp,pdb", "2008-05-04");

$blastParams = "-cpus=2 -topcomboN=1 V=100 B=20 -hspmax=1000000 -gi E=1e-3 -wordmask=seg -hspsepQmax=4000 -span1";

&createSimilarityDir($mgr,"PfalciparumAnnotatedProteins","pdb","(\\w+)\\s+mol:protein", $blastParams, "blastp");

&createSimilarityDir($mgr,"PvivaxAnnotatedProteins","pdb","(\\w+)\\s+mol:protein", $blastParams, "blastp");

&createSimilarityDir($mgr,"PyoeliiAnnotatedProteins","pdb","(\\w+)\\s+mol:protein", $blastParams, "blastp");

&createSimilarityDir($mgr,"PbergheiAnnotatedProteins","pdb","(\\w+)\\s+mol:protein", $blastParams, "blastp");

&createSimilarityDir($mgr,"PchabaudiAnnotatedProteins","pdb","(\\w+)\\s+mol:protein", $blastParams, "blastp");

&createSimilarityDir($mgr,"PknowlesiAnnotatedProteins","pdb","(\\w+)\\s+mol:protein", $blastParams, "blastp");

 &copyFilesToComputeCluster($mgr,"PfalciparumAnnotatedProteins-pdb","similarity");

 &copyFilesToComputeCluster($mgr,"PvivaxAnnotatedProteins-pdb","similarity");

 &copyFilesToComputeCluster($mgr,"PyoeliiAnnotatedProteins-pdb","similarity");

 &copyFilesToComputeCluster($mgr,"PbergheiAnnotatedProteins-pdb","similarity");

 &copyFilesToComputeCluster($mgr,"PchabaudiAnnotatedProteins-pdb","similarity");

 &copyFilesToComputeCluster($mgr,"PknowlesiAnnotatedProteins-pdb","similarity");

&moveDownloadFile($mgr,"PDBProteinSequences/pdb.fsa","seqfiles");

&copyFilesToComputeCluster($mgr,"pdb.fsa","seqfiles");

&startProteinBlastOnComputeCluster($mgr,"PfalciparumAnnotatedProteins","pdb","apidb");

&startProteinBlastOnComputeCluster($mgr,"PvivaxAnnotatedProteins","pdb","apidb");

&startProteinBlastOnComputeCluster($mgr,"PyoeliiAnnotatedProteins","pdb","apidb");

&startProteinBlastOnComputeCluster($mgr,"PbergheiAnnotatedProteins","pdb","apidb");

&startProteinBlastOnComputeCluster($mgr,"PchabaudiAnnotatedProteins","pdb","apidb");

&startProteinBlastOnComputeCluster($mgr,"PknowlesiAnnotatedProteins","pdb","apidb");

$mgr->waitForCluster("PfalciparumAnnotatedProteins blast similarity to pdb", "waitPfalciparumAnnotatedProteins-pdb"); 

$mgr->waitForCluster("PvivaxAnnotatedProteins blast similarity to pdb", "waitPvivaxAnnotatedProteins-pdb");

$mgr->waitForCluster("PyoeliiAnnotatedProteins blast similarity to pdb", "waitPyoeliiAnnotatedProteins-pdb");

$mgr->waitForCluster("PbergheiAnnotatedProteins blast similarity to pdb", "waitPbergheiAnnotatedProteins-pdb");

 $mgr->waitForCluster("PchabaudiAnnotatedProteins blast similarity to pdb", "waitPchabaudiAnnotatedProteins-pdb");

 $mgr->waitForCluster("PknowlesiAnnotatedProteins blast similarity to pdb", "waitPknowlesiAnnotatedProteins-pdb");

 &copyFilesFromComputeCluster($mgr,"PfalciparumAnnotatedProteins-pdb","similarity");

 &copyFilesFromComputeCluster($mgr,"PvivaxAnnotatedProteins-pdb","similarity");

 &copyFilesFromComputeCluster($mgr,"PyoeliiAnnotatedProteins-pdb","similarity");

 &copyFilesFromComputeCluster($mgr,"PbergheiAnnotatedProteins-pdb","similarity");

 &copyFilesFromComputeCluster($mgr,"PchabaudiAnnotatedProteins-pdb","similarity");

 &copyFilesFromComputeCluster($mgr,"PknowlesiAnnotatedProteins-pdb","similarity");

&loadProteinBlast($mgr, "PfalciparumAnnotatedProteins-pdb","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","Sanger P. falciparum chromosomes","2007-06-28","PDB protein sequences","2008-05-16","--noHSPs --subjectPvalue 1e-05 --subjectPctIdent 30");

&loadProteinBlast($mgr, "PvivaxAnnotatedProteins-pdb","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P.vivax contigs from Genbank","2007-06-13","PDB protein sequences","2008-05-16","--noHSPs --subjectPvalue 1e-05 --subjectPctIdent 30");

&loadProteinBlast($mgr, "PyoeliiAnnotatedProteins-pdb","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","Jane Carlton P. yoelii chromosomes","2002-09-10","PDB protein sequences","2008-05-16","--noHSPs --subjectPvalue 1e-05 --subjectPctIdent 30");

&loadProteinBlast($mgr, "PbergheiAnnotatedProteins-pdb","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P. berghei genome","2006-02-27","PDB protein sequences","2008-05-16","--noHSPs --subjectPvalue 1e-05 --subjectPctIdent 30");

&loadProteinBlast($mgr, "PchabaudiAnnotatedProteins-pdb","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","P. chabaudi genome","2006-02-27","PDB protein sequences","2008-05-16","--noHSPs --subjectPvalue 1e-05 --subjectPctIdent 30");

&loadProteinBlast($mgr, "PknowlesiAnnotatedProteins-pdb","DoTS::TranslatedAASequence", "DoTS::ExternalAASequence","source_id","source_id","Sanger P. knowlesi chromosomes","2007-10-03","PDB protein sequences","2008-05-16","--noHSPs --subjectPvalue 1e-05 --subjectPctIdent 30");


####### run MUMMER for SNPs and load results #######

&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/Su_SNPs/Pf_snps_allChromosomes.gff","$projectDir/$release/analysis_pipeline/primary/data/snp","$projectDir/$release/analysis_pipeline/primary/data/snp");

&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/Broad_SNPs/broad_snps.gff","$projectDir/$release/analysis_pipeline/primary/data/snp");

&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/WinzelerGeneticVariationArray/winzelerInput.gff","$projectDir/$release/analysis_pipeline/primary/data/snp");

&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/sangerItGhanaSnps/sangerPfalciparumSnps.gff","$projectDir/$release/analysis_pipeline/primary/data/snp");

&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/sangerReichenowiSnps/sangerPreichenowiSnps.gff","$projectDir/$release/analysis_pipeline/primary/data/snp");

&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/plasmoDbCombinedSnps/combinedSnps.gff","$projectDir/$release/analysis_pipeline/primary/data/snp");

&snpGffToFasta($mgr,"Pf_snps_allChromosomes.gff","3D7","gff2");

&snpGffToFasta($mgr,"broad_snps.gff","3D7","gff2");

&snpGffToFasta($mgr,"sangerPfalciparumSnps.gff","3D7","gff2");

&snpGffToFasta($mgr,"sangerPreichenowiSnps.gff","3D7","gff2");

&snpGffToFasta($mgr,"combinedSnps.gff","3D7","gff2");

&snpGffToFasta($mgr,"winzelerInput.gff","3D7","gff2");

&runMummer($mgr,"PfalciparumChroms.fsa","Pf_snps_allChromosomes");

&runMummer($mgr,"PfalciparumChroms.fsa","broad_snps");

&runMummer($mgr,"PfalciparumChroms.fsa","sangerPfalciparumSnps");

&runMummer($mgr,"PfalciparumChroms.fsa","sangerPreichenowiSnps");

&runMummer($mgr,"PfalciparumChroms.fsa","combinedSnps");

&runMummer($mgr,"PfalciparumChroms.fsa","winzelerInput");

&snpMummerToGFF($mgr,"PfalciparumChroms_Pf_snps_allChromosomesMummer","Pf_snps_allChromosomes.gff","3D7","gff2");

&snpMummerToGFF($mgr,"PfalciparumChroms_broad_snpsMummer","broad_snps.gff","3D7","gff2");

&snpMummerToGFF($mgr,"PfalciparumChroms_sangerPfalciparumSnpsMummer","sangerPfalciparumSnps.gff","3D7","gff2");

&snpMummerToGFF($mgr,"PfalciparumChroms_sangerPreichenowiSnpsMummer","sangerPreichenowiSnps.gff","3D7","gff2");

&snpMummerToGFF($mgr,"PfalciparumChroms_combinedSnpsMummer","combinedSnps.gff","3D7","gff2");

&snpMummerToGFF($mgr,"PfalciparumChroms_winzelerInputMummer","winzelerInput.gff","3D7","gff2");

&loadMummerSnpResults($mgr,"Su SNPs","08-26-2006","Sanger P. falciparum chromosomes","2007-06-28","Sanger P. falciparum chromosomes","2007-06-28","DoTS::ExternalNASequence","Plasmodium falciparum","3D7","PfalciparumChroms_Pf_snps_allChromosomesMummer.gff");

&loadMummerSnpResults($mgr,"Broad SNPs","2007-08","Sanger P. falciparum chromosomes","2007-06-28","Sanger P. falciparum chromosomes","2007-06-28","DoTS::ExternalNASequence","Plasmodium falciparum","3D7","PfalciparumChroms_broad_snpsMummer.gff");

&loadMummerSnpResults($mgr,"Sanger falciparum SNPs","2006-10-21","Sanger P. falciparum chromosomes","2007-06-28","Sanger P. falciparum chromosomes","2007-06-28","DoTS::ExternalNASequence","Plasmodium falciparum","3D7","PfalciparumChroms_sangerPfalciparumSnpsMummer.gff");

&loadMummerSnpResults($mgr,"Sanger reichenowi SNPs","2006-10-21","Sanger P. falciparum chromosomes","2007-06-28","Sanger P. falciparum chromosomes","2007-06-28","DoTS::ExternalNASequence","Plasmodium falciparum","3D7","PfalciparumChroms_sangerPreichenowiSnpsMummer.gff");

&loadMummerSnpResults($mgr,"PlasmoDB combined SNPs","2007-08","Sanger P. falciparum chromosomes","2007-06-28","Sanger P. falciparum chromosomes","2007-06-28","DoTS::ExternalNASequence","Plasmodium falciparum","3D7","PfalciparumChroms_combinedSnpsMummer.gff");

&loadMummerSnpResults($mgr,"Winzeler Array - Plasmodium Genetic Variation","2006-10-16","Sanger P. falciparum chromosomes","2007-06-28","Sanger P. falciparum chromosomes","2007-06-28","DoTS::ExternalNASequence","Plasmodium falciparum","3D7","PfalciparumChroms_winzelerInputMummer.gff");


##### SAGE tag steps #####

$mgr->{sageTagArrays} = ({Pfalciparum => [{ name => "P.falciparum SAGE Tags", ver => 1 }]});

&extractSageTags($mgr,"Pfalciparum", 'CATG');

$mgr->{genomeNaSequences} = ({Pfalciparum =>[{name => "Sanger P. falciparum chromosomes", ver=> "2007-06-28" }]});

&extractGenomeNaSequences($mgr, "Pfalciparum", "ExternalNASequence", "supercontig", 36329);

&mapSageTagsToNaSequences($mgr,"Pfalciparum");

&loadSageTagMap($mgr,"Pfalciparum");

&createSageTagNormFiles ($mgr,"Transcriptional profile of P.falciparum by Serial analysis of gene expression", 25372);

&insertNormSageTagFreqs ($mgr,"Transcriptional profile of P.falciparum by Serial analysis of gene expression");


##### ESTs #####
### Requires dbEST and TIGR indicies ###
#### The ncbi_tax_ids in the following steps should be for the parent genus, not for the species ####

&documentBLATAlignment($mgr,"v. 31","-minIntron 500,-minScore 30,-minIdentity 90");

&makeTranscriptSeqs($mgr,"Plasmodium",5820,1);

#In next release, chang the "Plasmodium" to "Plasmodium Predicted", make the signals for this step and the step above different
&makeTranscriptSeqs($mgr,"Plasmodium Predicted",5820,1,"select e.na_sequence_id 
         from dots.ExternalNASequence e, sres.sequenceontology s,
              sres.externalDatabase d, sres.externalDatabaseRelease r
         where e.taxon_id in(108364,108329,108333,108267)
         and e.external_database_release_id = r.external_database_release_id
         and r.external_database_id = d.external_database_id
         and r.version = '2006-11-02'
         and d.name IN ('WatanabePf3D7_PredictedTranscripts',
                        'WatanabePv_PredictedTranscripts',
                        'WatanabePy17XL_PredictedTranscripts',
                        'WatanabePbANKA_PredictedTranscripts')
         and s.term_name IN ('transcript')
         and e.sequence_ontology_id = s.sequence_ontology_id
         and e.na_sequence_id not in
         (select a.na_sequence_id from dots.AssemblySequence a)");

&extractTranscriptSeqs($mgr,"PfalciparumESTSeqs",5833,1);

&extractTranscriptSeqs($mgr,"PvivaxESTSeqs",5855,1);

&extractTranscriptSeqs($mgr,"PyoeliiESTSeqs",5861,1);

&extractTranscriptSeqs($mgr,"PbergheiESTSeqs",5821,1);

&extractTranscriptSeqs($mgr,"PchabaudiESTSeqs",5825,1);

&extractTranscriptSeqs($mgr,"PknowlesiESTSeqs",5850,1);

&extractIndividualNaSeq ($mgr,"Sanger P. falciparum chromosomes","2007-06-28","Pfalciparum","genome","ExternalNASequence","source_id");

&extractIndividualNaSeq ($mgr,"P.vivax contigs from Genbank","2007-06-13","Pvivax","genome","ExternalNASequence","source_id");

&extractIndividualNaSeq ($mgr,"Jane Carlton P. yoelii chromosomes","2002-09-10","Pyoelii","genome","ExternalNASequence","source_id");

&extractIndividualNaSeq ($mgr,"P. berghei genome","2006-02-27","Pberghei","genome","ExternalNASequence","source_id");

 &copyFilesToComputeCluster($mgr,"PfalciparumGenome","seqfiles");

 &copyFilesToComputeCluster($mgr,"PvivaxGenome","seqfiles");

 &copyFilesToComputeCluster($mgr,"PyoeliiGenome","seqfiles");

 &copyFilesToComputeCluster($mgr,"PbergheiGenome","seqfiles");

 &copyFilesToComputeCluster($mgr,"PfalciparumESTSeqs.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PvivaxESTSeqs.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PyoeliiESTSeqs.fsa","seqfiles");

 &copyFilesToComputeCluster($mgr,"PbergheiESTSeqs.fsa","seqfiles");

&createGenomeDirForGfClient($mgr,"PfalciparumESTSeqs", "PfalciparumGenome",30000 ,4,1);

&createGenomeDirForGfClient($mgr,"PvivaxESTSeqs", "PvivaxGenome",30000,4,1);

&createGenomeDirForGfClient($mgr,"PyoeliiESTSeqs", "PyoeliiGenome",20000,4,1);

&createGenomeDirForGfClient($mgr,"PbergheiESTSeqs", "PbergheiGenome",20000,4,1);

 &copyFilesToComputeCluster($mgr,"genome");

&createRepeatMaskDir_new($mgr,"PfalciparumESTSeqs");

&createRepeatMaskDir_new($mgr,"PvivaxESTSeqs");

&createRepeatMaskDir_new($mgr,"PyoeliiESTSeqs");

&createRepeatMaskDir_new($mgr,"PbergheiESTSeqs");

 &copyFilesToComputeCluster($mgr,"repeatmask");

&startGenomeAlignOnComputeCluster($mgr,"PfalciparumESTSeqs","PfalciparumGenome","apidb",4);

&startGenomeAlignOnComputeCluster($mgr,"PvivaxESTSeqs","PvivaxGenome","apidb",4);

&startGenomeAlignOnComputeCluster($mgr,"PyoeliiESTSeqs","PyoeliiGenome","apidb",4);

&startGenomeAlignOnComputeCluster($mgr,"PbergheiESTSeqs","PbergheiGenome","apidb",4);

$mgr->waitForCluster("PfalciparumESTSeqs BLAT alignment to PfalciparumGenome", "waitPfalciparumESTSeqs-PfalciparumGenome");

&copyFilesFromComputeCluster($mgr,"PfalciparumESTSeqs-PfalciparumGenome","genome");

&copyFilesFromComputeCluster($mgr,"PfalciparumESTSeqs","repeatmask");

$mgr->waitForCluster("PvivaxESTSeqs BLAT alignment to PvivaxGenome", "waitPvivaxESTSeqs-PvivaxGenome");

&copyFilesFromComputeCluster($mgr,"PvivaxESTSeqs-PvivaxGenome","genome");

&copyFilesFromComputeCluster($mgr,"PvivaxESTSeqs","repeatmask");

$mgr->waitForCluster("PyoeliiESTSeqs BLAT alignment to PyoeliiGenome", "waitPyoeliiESTSeqs-PyoeliiGenome");

&copyFilesFromComputeCluster($mgr,"PyoeliiESTSeqs-PyoeliiGenome","genome");

&copyFilesFromComputeCluster($mgr,"PyoeliiESTSeqs","repeatmask");

$mgr->waitForCluster("PbergheiESTSeqs BLAT alignment to PbergheiGenome", "waitPbergheiESTSeqs-PbergheiGenome");

&copyFilesFromComputeCluster($mgr,"PbergheiESTSeqs-PbergheiGenome","genome");

&copyFilesFromComputeCluster($mgr,"PbergheiESTSeqs","repeatmask");

#this step has not been tested yet, but needs to be run before loadContigAligns
&UpdateGusTableWithXml($mgr," $ENV{PROJECT_HOME}/ApiCommonData/Load/lib/xml/blatalignmentquality.xml","BlatAlignmentQuality");

##re-examine this, may want to use the taxon_id for query sequences (parent id) and different one for the genome(strain id).

&loadContigAlignments($mgr, 5833, "PfalciparumESTSeqs","PfalciparumGenome","","","Sanger P. falciparum chromosomes","2007-06-28","ExternalNASequence",">(\\d+)","load"); 

&loadContigAlignments($mgr, 5855, "PvivaxESTSeqs","PvivaxGenome","","","P.vivax contigs from Genbank","2007-06-13","ExternalNASequence",">(\\d+)","load");

&loadContigAlignments($mgr, 5861, "PyoeliiESTSeqs","PyoeliiGenome","","","Jane Carlton P. yoelii chromosomes","2002-09-10","ExternalNASequence",">(\\d+)","load");

&loadContigAlignments($mgr, 5821, "PbergheiESTSeqs","PbergheiGenome","","","P. berghei genome","2006-02-27","ExternalNASequence",">(\\d+)","load");

&loadContigAlignments($mgr, 5833, "PfalciparumESTSeqs","PfalciparumGenome","","","Sanger P. falciparum chromosomes","2007-06-28","ExternalNASequence",">(\\d+)","setbest","","",100);

&loadContigAlignments($mgr, 5855, "PvivaxESTSeqs","PvivaxGenome","","","P.vivax contigs from Genbank","2007-06-13","ExternalNASequence",">(\\d+)","setbest","","",100);

&loadContigAlignments($mgr, 5861, "PyoeliiESTSeqs","PyoeliiGenome","","","Jane Carlton P. yoelii chromosomes","2002-09-10","ExternalNASequence",">(\\d+)","setbest","","",100);

&loadContigAlignments($mgr, 5821, "PbergheiESTSeqs","PbergheiGenome","","","P. berghei genome","2006-02-27","ExternalNASequence",">(\\d+)","setbest","","",100);

#########Replaced by makeESTDownloadFile#################

#&extractESTsFromAllSources($mgr,"Plasmodium","falciparum","2007-09-23",5833,1,"plasmoDB");

#&extractESTsFromAllSources($mgr,"Plasmodium","vivax","2007-09-23",5855,1,"plasmoDB");

# &extractESTsFromAllSources($mgr,"Plasmodium","yoelii","2007-09-23",5861,1,"plasmoDB");

# &extractESTsFromAllSources($mgr,"Plasmodium","berghei","2007-09-23",5821,1,"plasmoDB");

# &extractESTsFromAllSources($mgr,"Plasmodium","chabaudi","2007-09-23",5825,1,"plasmoDB");

# &extractESTsFromAllSources($mgr,"Plasmodium","knowlesi","2007-09-23",5850,1,"plasmoDB");

#&copy($mgr,"$projectDir/$release/analysis_pipeline/primary/data/PfalciparumESTs_plasmoDB-5.4.fasta","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pfalciparum","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pfalciparum");

#&copy($mgr,"$projectDir/$release/analysis_pipeline/primary/data/seqfiles/PvivaxESTs_plasmoDB-5.4.fasta","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pvivax","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pvivax");

#&copy($mgr,"$projectDir/$release/analysis_pipeline/primary/data/seqfiles/PyoeliiESTs_plasmoDB-5.4.fasta","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pyoelii","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pyoelii");

#&copy($mgr,"$projectDir/$release/analysis_pipeline/primary/data/seqfiles/PbergheiESTs_plasmoDB-5.4.fasta","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pberghei","$projectDir/$release/analysis_pipeline/primary/data/downloadSite/Pberghei");

#&concatFiles($mgr,"downloadSite/Pfalciparum/PfalciparumESTs_plasmoDB-5.4.fasta downloadSite/Pvivax/PvivaxESTs_plasmoDB-5.4.fasta downloadSite/Pyoelii/PyoeliiESTs_plasmoDB-5.4.fasta downloadSite/Pberghei/PbergheiESTs_plasmoDB-5.4.fasta","PlasmodiumESTs.fsa","seqfiles"); 

#&formatBlastFile($mgr,"PfalciparumESTs_plasmoDB-5.4.fasta","downloadSite/Pfalciparum","Pfalciparum_ESTs","F");

#&formatBlastFile($mgr,"PvivaxESTs_plasmoDB-5.4.fasta","downloadSite/Pvivax","Pvivax_ESTs","F");

#&formatBlastFile($mgr,"PyoeliiESTs_plasmoDB-5.4.fasta","downloadSite/Pyoelii","Pyoelii_ESTs","F");

#&formatBlastFile($mgr,"PbergheiESTs_plasmoDB-5.4.fasta","downloadSite/Pberghei","Pberghei_ESTs","F");

#&formatBlastFile($mgr,"PlasmodiumESTs.fsa","seqfiles","Plasmodium_ESTs","F");
######## End Replaced ########

######## DoTS assemblies ########

&clusterMultiEstSourcesByAlign($mgr, "ESTs", "Pfalciparum", "Sanger P. falciparum chromosomes","2007-06-28", 5833, "ExternalNASequence",20000);

&clusterMultiEstSourcesByAlign($mgr, "ESTs", "Pvivax", "P.vivax contigs from Genbank","2007-06-13", 5855, "ExternalNASequence",20000);

&clusterMultiEstSourcesByAlign($mgr, "ESTs", "Pyoelii", "Jane Carlton P. yoelii chromosomes","2002-09-10", 5861, "ExternalNASequence",20000);

&clusterMultiEstSourcesByAlign($mgr, "ESTs", "Pberghei", "P. berghei genome","2006-02-27", 5821, "ExternalNASequence",20000);

&clusterMultiEstSourcesByAlign($mgr, "ESTs", "Pchabaudi", "P. chabaudi genome","2006-02-27",5825, "ExternalNASequence",20000);

&clusterMultiEstSourcesByAlign($mgr, "ESTs", "Pknowlesi", "Sanger P. knowlesi chromosomes","2007-10-03",5850, "ExternalNASequence",20000);

&splitCluster($mgr, "Pfalciparum", "ESTs");

&splitCluster($mgr, "Pvivax", "ESTs");

&splitCluster($mgr, "Pyoelii", "ESTs");

&splitCluster($mgr, "Pberghei", "ESTs");

&assembleTranscripts($mgr, "Pfalciparum", "", "", "ESTs", 36329);

&assembleTranscripts($mgr, "Pvivax", "", "", "ESTs", 126793);

&assembleTranscripts($mgr, "Pyoelii", "", "", "ESTs", 352914);

&assembleTranscripts($mgr, "Pberghei", "", "", "ESTs", 5823);

&extractAssemblies($mgr, "Pfalciparum", "Assemblies", 36329);

&extractAssemblies($mgr, "Pvivax", "Assemblies", 126793);

&extractAssemblies($mgr, "Pyoelii", "Assemblies", 352914);

&extractAssemblies($mgr, "Pberghei", "Assemblies", 5823);

  &copyFilesToComputeCluster($mgr, "PfalciparumAssemblies.fsa","seqfiles");

  &copyFilesToComputeCluster($mgr, "PvivaxAssemblies.fsa","seqfiles");

  &copyFilesToComputeCluster($mgr, "PyoeliiAssemblies.fsa","seqfiles");

  &copyFilesToComputeCluster($mgr, "PbergheiAssemblies.fsa","seqfiles");

 &createGenomeDirForGfClient($mgr,"PfalciparumAssemblies", "PfalciparumGenome",30000 ,4,1);

 &createGenomeDirForGfClient($mgr,"PvivaxAssemblies", "PvivaxGenome",30000,4,1);

 &createGenomeDirForGfClient($mgr,"PyoeliiAssemblies", "PyoeliiGenome",20000,4,1);

 &createGenomeDirForGfClient($mgr,"PbergheiAssemblies", "PbergheiGenome",20000,4,1);

  &copyFilesToComputeCluster($mgr, "PfalciparumAssemblies-PfalciparumGenome","genome");

  &copyFilesToComputeCluster($mgr, "PvivaxAssemblies-PvivaxGenome","genome");

  &copyFilesToComputeCluster($mgr, "PyoeliiAssemblies-PyoeliiGenome","genome");

  &copyFilesToComputeCluster($mgr, "PbergheiAssemblies-PbergheiGenome","genome");

 &createRepeatMaskDir_new($mgr,"PfalciparumAssemblies",4);

 &createRepeatMaskDir_new($mgr,"PvivaxAssemblies",4);

 &createRepeatMaskDir_new($mgr,"PyoeliiAssemblies",4);

 &createRepeatMaskDir_new($mgr,"PbergheiAssemblies",4);

  &copyFilesToComputeCluster($mgr, "PfalciparumAssemblies","repeatmask");

  &copyFilesToComputeCluster($mgr, "PvivaxAssemblies","repeatmask");

  &copyFilesToComputeCluster($mgr, "PyoeliiAssemblies","repeatmask");

  &copyFilesToComputeCluster($mgr, "PbergheiAssemblies","repeatmask");

 &startGenomeAlignOnComputeCluster($mgr,"PfalciparumAssemblies","PfalciparumGenome","apidb",4);

 &startGenomeAlignOnComputeCluster($mgr,"PvivaxAssemblies","PvivaxGenome","apidb",4);

 &startGenomeAlignOnComputeCluster($mgr,"PyoeliiAssemblies","PyoeliiGenome","apidb",4);

 &startGenomeAlignOnComputeCluster($mgr,"PbergheiAssemblies","PbergheiGenome","apidb",4);

$mgr->waitForCluster("PfalciparumAssemblies BLAT alignment to PfalciparumGenome", "waitPfalciparumAssemblies-PfalciparumGenome");

$mgr->waitForCluster("PvivaxAssemblies BLAT alignment to PvivaxGenome", "waitPvivaxAssemblies-PvivaxGenome");

$mgr->waitForCluster("PyoeliiAssemblies BLAT alignment to PyoeliiGenome", "waitPyoeliiAssemblies-PyoeliiGenome");

$mgr->waitForCluster("PbergheiAssemblies BLAT alignment to PbergheiGenome", "waitPbergheiAssemblies-PbergheiGenome");

&copyFilesFromComputeCluster($mgr,"PfalciparumAssemblies-PfalciparumGenome","genome");

&copyFilesFromComputeCluster($mgr,"PvivaxAssemblies-PvivaxGenome","genome");

&copyFilesFromComputeCluster($mgr,"PyoeliiAssemblies-PyoeliiGenome","genome");

&copyFilesFromComputeCluster($mgr,"PbergheiAssemblies-PbergheiGenome","genome");

&copyFilesFromComputeCluster($mgr,"PfalciparumAssemblies","repeatmask");

&copyFilesFromComputeCluster($mgr,"PvivaxAssemblies","repeatmask");

&copyFilesFromComputeCluster($mgr,"PyoeliiAssemblies","repeatmask");

&copyFilesFromComputeCluster($mgr,"PbergheiAssemblies","repeatmask");

&loadContigAlignments($mgr,36329, "PfalciparumAssemblies","PfalciparumGenome","","","Sanger P. falciparum chromosomes","2007-06-28","ExternalNASequence",">(\\d+)","load","Assembly","",100);

&loadContigAlignments($mgr, 126793, "PvivaxAssemblies","PvivaxGenome","","","P.vivax contigs from Genbank","2007-06-13","ExternalNASequence",">(\\d+)","load","Assembly","",100);

&loadContigAlignments($mgr, 352914, "PyoeliiAssemblies","PyoeliiGenome","","","Jane Carlton P. yoelii chromosomes","2002-09-10","ExternalNASequence",">(\\d+)","load","Assembly","",100);

&loadContigAlignments($mgr, 5823, "PbergheiAssemblies","PbergheiGenome","","","P. berghei genome","2006-02-27","ExternalNASequence",">(\\d+)","load","Assembly","",100);

&loadContigAlignments($mgr,36329, "PfalciparumAssemblies","PfalciparumGenome","","","Sanger P. falciparum chromosomes","2007-06-28","ExternalNASequence",">(\\d+)","setbest","Assembly","",100);

&loadContigAlignments($mgr, 126793, "PvivaxAssemblies","PvivaxGenome","","","P.vivax contigs from Genbank","2007-06-13","ExternalNASequence",">(\\d+)","setbest","Assembly","",100);

&loadContigAlignments($mgr, 352914, "PyoeliiAssemblies","PyoeliiGenome","","","Jane Carlton P. yoelii chromosomes","2002-09-10","ExternalNASequence",">(\\d+)","setbest","Assembly","",100);

&loadContigAlignments($mgr, 5823, "PbergheiAssemblies","PbergheiGenome","","","P. berghei genome","2006-02-27","ExternalNASequence",">(\\d+)","setbest","Assembly","",100);

&updateAssemblySourceId($mgr,"Pfalciparum",36329);

&updateAssemblySourceId($mgr,"Pvivax",126793);

&updateAssemblySourceId($mgr,"Pyoelii",352914);

&updateAssemblySourceId($mgr,"Pberghei",5823);


####### IEDB Epitopes #######
### Depends on Epitopes and the protein BLAST files made by the analysis pipeline###

############need to make protein BLAST files for ncbiBlast #############################################
&makeAnnotatedProteinDownloadFileForncbiBlast($mgr, "Pfalciparum", "PfalciparumAnnotatedProteins", "Sanger P. falciparum chromosomes","2007-06-28","ExternalNASequence","Plasmodium_falciparum_Sanger_Stanford_TIGR");

&makeAnnotatedProteinDownloadFileForncbiBlast($mgr, "Pyoelii", "PyoeliiAnnotatedProteins", "Jane Carlton P. yoelii chromosomes","2002-09-10","ExternalNASequence","Plasmodium_yoelii_TIGR");

&makeAnnotatedProteinDownloadFileForncbiBlast($mgr,"Pvivax", "PvivaxAnnotatedProteins", "P.vivax_GBAnnotation","2007-06-13","ExternalNASequence","Plasmodium_vivax_Genbank");

&makeAnnotatedProteinDownloadFileForncbiBlast($mgr, "Pberghei", "PbergheiAnnotatedProteins", "P. berghei genome","2006-02-27","ExternalNASequence","Plasmodium_berghei_Sanger");

&makeAnnotatedProteinDownloadFileForncbiBlast($mgr, "Pchabaudi","PchabaudiAnnotatedProteins", "P. chabaudi genome","2006-02-27","ExternalNASequence","Plasmodium_chabaudi_Sanger");

&makeAnnotatedProteinDownloadFileForncbiBlast($mgr, "Pknowlesi", "PknowlesiAnnotatedProteins", "Sanger P. knowlesi chromosomes","2007-10-03","ExternalNASequence","Plasmodium_knowlesi_Sanger");

#&formatncbiBlastFile($mgr,"PfalciparumAnnotatedProteins_PlasmoDB-5.5.fasta","Pfalciparum","Pfalciparum_proteins","T");

&formatncbiBlastFile($mgr,"PvivaxAnnotatedProteins_PlasmoDB-5.5.fasta","Pvivax","Pvivax_proteins","T");

&formatncbiBlastFile($mgr,"PyoeliiAnnotatedProteins_PlasmoDB-5.5.fasta","Pyoelii","Pyoelii_proteins","T");

&formatncbiBlastFile($mgr,"PbergheiAnnotatedProteins_PlasmoDB-5.5.fasta","Pberghei","Pberghei_proteins","T");

&formatncbiBlastFile($mgr,"PchabaudiAnnotatedProteins_PlasmoDB-5.5.fasta","Pchabaudi","Pchabaudi_proteins","T");

&formatncbiBlastFile($mgr,"PknowlesiAnnotatedProteins_PlasmoDB-5.5.fasta","Pknowlesi","Pknowlesi_proteins","T");

&copyDirectory($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/IEDB_Epitopes_fixed","$projectDir/$release/analysis_pipeline/primary/data/iedb/input","$projectDir/$release/analysis_pipeline/primary/data/iedb");

&createEpitopeMapFiles($mgr, "input", "$projectDir/$release/analysis_pipeline/primary/data/blastSite", "$projectDir/$release/analysis_pipeline/primary/data/seqfiles");

&loadEpitopes($mgr, "$projectDir/$release/analysis_pipeline/primary/data/iedb/results/Pf", "Pfalciparum", "Links to IEDB epitopes|2008-05-23", "Sanger P. falciparum chromosomes|2007-06-28", "out");

&loadEpitopes($mgr, "$projectDir/$release/analysis_pipeline/primary/data/iedb/results/Pv", "Pvivax", "Links to IEDB epitopes|2008-05-23", "P.vivax contigs from Genbank|2007-06-13", "out");

&loadEpitopes($mgr, "$projectDir/$release/analysis_pipeline/primary/data/iedb/results/Py", "Pyoelii", "Links to IEDB epitopes|2008-05-23", "Jane Carlton P. yoelii chromosomes|2002-09-10", "out");

&loadEpitopes($mgr, "$projectDir/$release/analysis_pipeline/primary/data/iedb/results/Pb", "Pberghei", "Links to IEDB epitopes|2008-05-23", "P. berghei genome|2006-02-27", "out");

&loadEpitopes($mgr, "$projectDir/$release/analysis_pipeline/primary/data/iedb/results/Pc", "Pchabaudi", "Links to IEDB epitopes|2008-05-23", "P. chabaudi genome|2006-02-27", "out");

&loadEpitopes($mgr, "$projectDir/$release/analysis_pipeline/primary/data/iedb/results/Pk", "Pknowlesi", "Links to IEDB epitopes|2008-05-23", "Sanger P. knowlesi chromosomes|2007-10-03", "out");

#######################Moved to Resource Pipeline###########################################################################################################################################################################################################
# load the ApiDB.PlasmoPfalLocations table
&copy($mgr,"$projectDir/manualDelivery/combined_Su_Broad_Sanger_SNPs/2007-08/map_v6.0.sql","$projectDir/$release/analysis_pipeline/primary/data/snp/","$projectDir/$release/analysis_pipeline/primary/data/snp/");
&sqlLoader($mgr, "$projectDir/$release/analysis_pipeline/primary/data/snp/map_v6.0.sql");
#load MAPP data
&sqlLoader($mgr, "/files/efr/MAPPpromoters/Pfal_MAPP-version2.sql");
#################end of move###############################################################################################################################################################################################################################


######Moved to resource pipeline (FetchPDBidx)#############################################################################################################################################################################################################
&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/FetchPDBidx/source.idx.processed","$projectDir/$release/analysis_pipeline/primary/data/misc","$projectDir/$release/analysis_pipeline/primary/data/misc");
&updateTaxonIdField($mgr,"source.idx.processed","^(\\w+)","--taxonNameRegex \'^\\w+\\s+(.+)\'","select substr(lower(source_id),0,4),aa_sequence_id from dots.externalaasequence","PDB protein sequences|2008-05-16","DoTS::ExternalAASequence");
###########################################################################################################################################################################################################################################################

########## gives AASequences a taxon id ###
&updateTaxonIdField($mgr,"gi_taxid_prot.dmp","^(\\d+)","--ncbiTaxIdRegex \'^\\d+\\s(\\d+)\'","select source_id, aa_sequence_id from dots.externalaasequence","NRDB|2008-05-04","DoTS::ExternalAASequence"); 
#######################################moved to resource pipeline###########################################################################################################################################################################################
################################
##     Isolate Vocabulary     ##
################################

# Insert Ontology Terms
&isolateVocabulary($mgr, "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolateVocabulary_new.txt");
# Update Database
&isolateVocabularyUpdate($mgr, "isolation_source", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/isolationSource.xml");
&isolateVocabularyUpdate($mgr, "specific_host", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/specificHost_fixed.xml");
&isolateVocabularyUpdate($mgr, "geographic_location", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/geographicLocation.xml");
&isolateVocabularyUpdate($mgr, "product", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/product.xml");

#########################################################################never run, probably not necessary############################################################################################################
# Create Vocabulary Reports 
&isolateVocabularyReport($mgr, "isolation_source", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/isolationSource.xml", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/isolationSource.rpt");
&isolateVocabularyReport($mgr, "specific_host", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/specificHost.xml", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/specificHost.rpt");
&isolateVocabularyReport($mgr, "geographic_location", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/geographicLocation.xml", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/geographicLocation.rpt");
&isolateVocabularyReport($mgr, "product", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/product.xml", "/files/cbil/data/cbil/plasmoDB/manualDelivery/isolate_ontology/product.rpt");

$mgr->manualTask("Please review Isolate Vocabulary reports", "waitIsolateVocabulary_report"); 
#####################################################################################################################################################################################################################
#############################################################################end of move##################################################################################################################################################################

######################################################
####### make download files ########
######################################################

&makeESTDownloadFileFromAllSources($mgr,"Pfalciparum", 5833, 1, "PlasmoDB");

&makeESTDownloadFileFromAllSources($mgr,"Pvivax", 5855, 1, "PlasmoDB");

&makeESTDownloadFileFromAllSources($mgr,"Pyoelii", 5861, 1, "PlasmoDB");

&makeESTDownloadFileFromAllSources($mgr,"Pberghei", 5821, 1, "PlasmoDB");

&makeDoTSAssemblyDownloadFile ($mgr, 'Pfalciparum', 'assembly',36329, 'PlasmoDB');

&makeDoTSAssemblyDownloadFile ($mgr, 'Pvivax', 'assembly',126793, 'PlasmoDB');

&makeDoTSAssemblyDownloadFile ($mgr, 'Pyoelii', 'assembly',352914 , 'PlasmoDB');

&makeDoTSAssemblyDownloadFile ($mgr, 'Pberghei', 'assembly',5823 , 'PlasmoDB');


&makeDerivedCdsDownloadFileTransformed($mgr, "Pfalciparum", "PfalciparumAnnotatedCDS","Sanger P. falciparum chromosomes","2009-02-19","psu","PlasmoDB",0);

&makeDerivedCdsDownloadFileTransformed($mgr, "Pyoelii", "PyoeliiAnnotatedCDS", "Jane Carlton P. yoelii chromosomes","2002-09-10","tgr","PlasmoDB",0);

&makeDerivedCdsDownloadFileTransformed($mgr, "Pvivax", "PvivaxAnnotatedCDS","P.vivax contigs from Genbank","2007-06-13","gb","PlasmoDB",0);

&makeDerivedCdsDownloadFileTransformed($mgr, "Pberghei", "PbergheiAnnotatedCDS", "P. berghei genome","2006-02-27", "psu","PlasmoDB",0);

&makeDerivedCdsDownloadFileTransformed($mgr, "Pchabaudi", "PchabaudiAnnotatedCDS", "P. chabaudi genome and annotations","2009-03-24" ,"psu","PlasmoDB",0);

&makeDerivedCdsDownloadFileTransformed($mgr, "Pknowlesi", "PknowlesiAnnotatedCDS", "P. knowlesi chromosomes","2007-10-03","psu","PlasmoDB",0);


&makeTranscriptDownloadFileTransformed($mgr, "Pfalciparum", "PfalciparumAnnotatedTranscripts", "Sanger P. falciparum chromosomes","2009-02-19","psu","PlasmoDB",0);

&makeTranscriptDownloadFileTransformed($mgr, "Pyoelii", "PyoeliiAllTranscripts", "Jane Carlton P. yoelii chromosomes,tRNAscan-SE","2002-09-10,1.23","tgr","PlasmoDB",0);

&makeTranscriptDownloadFileTransformed($mgr, "Pvivax", "PvivaxAnnotatedTranscripts","P.vivax contigs from Genbank","2007-06-13","gb","PlasmoDB",0);

&makeTranscriptDownloadFileTransformed($mgr, "Pchabaudi", "PchabaudiAnnotatedTranscripts", "P. chabaudi genome and annotations","2009-03-24","psu","PlasmoDB",0,);

&makeTranscriptDownloadFileTransformed($mgr, "Pknowlesi", "PknowlesiAnnotatedTranscripts", "P. knowlesi chromosomes","2007-10-03","psu","PlasmoDB",0);

&makeTranscriptDownloadFileTransformed($mgr, "Pberghei", "PbergheiAllTranscripts", "P. berghei genome,PbergheiTRNAscan-SE","2006-02-27,1.23","psu","PlasmoDB",0);



&makeAnnotatedProteinDownloadFileTransformed($mgr, "Pfalciparum", "PfalciparumAnnotatedProteins", "Sanger P. falciparum chromosomes","2009-02-19","psu","PlasmoDB",0);

&makeAnnotatedProteinDownloadFileTransformed($mgr, "Pyoelii", "PyoeliiAnnotatedProteins", "Jane Carlton P. yoelii chromosomes","2002-09-10","tgr","PlasmoDB",0);

&makeAnnotatedProteinDownloadFileTransformed($mgr, "Pvivax", "PvivaxAnnotatedProteins","P.vivax contigs from Genbank","2007-06-13","gb","PlasmoDB",0);

&makeAnnotatedProteinDownloadFileTransformed($mgr, "Pberghei", "PbergheiAnnotatedProteins", "P. berghei genome","2006-02-27","psu","PlasmoDB",0);

&makeAnnotatedProteinDownloadFileTransformed($mgr, "Pchabaudi","PchabaudiAnnotatedProteins", "P. chabaudi genome and annotations","2009-03-24","psu","PlasmoDB",0);

&makeAnnotatedProteinDownloadFileTransformed($mgr, "Pknowlesi", "PknowlesiAnnotatedProteins", "P. knowlesi chromosomes","2007-10-03","psu","PlasmoDB",0);


&makeMixedGenomicDownloadFile($mgr, "Pfalciparum", "PfalciparumGenomic", "Sanger P. falciparum chromosomes","2009-02-19", "psu","PlasmoDB");

&makeMixedGenomicDownloadFile($mgr, "Pyoelii", "PyoeliiGenomic", "Jane Carlton P. yoelii chromosomes","2002-09-10","tgr","PlasmoDB");

&makeMixedGenomicDownloadFile($mgr, "Pvivax", "PvivaxGenomic","Plasmodium vivax chromosomes,P.vivax contigs from Genbank","2007-09-04,2007-06-13", "gb","PlasmoDB");

&makeMixedGenomicDownloadFile($mgr, "Pberghei", "PbergheiGenomic", "P. berghei genome","2006-02-27", "psu","PlasmoDB");

&makeMixedGenomicDownloadFile($mgr, "Pchabaudi", "PchabaudiGenomic", "P. chabaudi genome and annotations","2009-03-24","psu","PlasmoDB");

&makeMixedGenomicDownloadFile($mgr, "Pknowlesi", "PknowlesiGenomic", "P. knowlesi chromosomes","2007-10-03","psu","PlasmoDB");

&makeMixedGenomicDownloadFile($mgr, "Preichenowi","PreichenowiGenomic","P. reichenowi contigs","2004-03-11" ,"psu","PlasmoDB");

&makeMixedGenomicDownloadFile($mgr, "Pgallinaceum","PgallinaceumGenomic", "P. gallinaceum contigs","2006-12-31","psu","PlasmoDB");


&makeInterproDownloadFile ($mgr, 'Pfalciparum', "Interpro", "Sanger P. falciparum chromosomes","2009-02-19", "INTERPRO", "19.0", "PlasmoDB");

 &makeInterproDownloadFile ($mgr, 'Pyoelii', "Interpro", "Jane Carlton P. yoelii chromosomes","2002-09-10", "INTERPRO", "19.0", "PlasmoDB");

 &makeInterproDownloadFile ($mgr, 'Pvivax', "Interpro", "P.vivax contigs from Genbank","2007-06-13", "INTERPRO", "19.0", "PlasmoDB");

 &makeInterproDownloadFile ($mgr, 'Pberghei', "Interpro", "P. berghei genome","2006-02-27", "INTERPRO", "19.0", "PlasmoDB");

 &makeInterproDownloadFile ($mgr, 'Pchabaudi', "Interpro", "P. chabaudi genome and annotations","2009-03-24", "INTERPRO", "19.0", "PlasmoDB");

 &makeInterproDownloadFile ($mgr, 'Pknowlesi', "Interpro", "P. knowlesi chromosomes","2007-10-03", "INTERPRO", "19.0", "PlasmoDB");



 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Pfalciparum", "PfalciparumOrfs", "Sanger P. falciparum chromosomes","2009-02-19", 50, "PlasmoDB");

 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Pvivax", "PvivaxOrfs", "Plasmodium vivax chromosomes,P.vivax contigs from Genbank","2007-09-04,2007-06-13", 50, "PlasmoDB");

 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Pyoelii", "PyoeliiOrfs", "Jane Carlton P. yoelii chromosomes","2002-09-10", 50, "PlasmoDB");

 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Pberghei", "PbergheiOrfs", "P. berghei genome","2006-02-27", 50, "PlasmoDB");

 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Pchabaudi", "PchabaudiOrfs", "P. chabaudi genome and annotations","2009-03-24", 50, "PlasmoDB");

 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Pknowlesi", "PknowlesiOrfs", "P. knowlesi chromosomes","2007-10-03", 50, "PlasmoDB");

 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Preichenowi", "PreichenowiOrfs", "P. reichenowi contigs","2004-03-11", 50, "PlasmoDB");

 &makeOrfDownloadFileWithAbrevDeflineTransformed($mgr, "Pgallinaceum", "PgallinaceumOrfs", "P. gallinaceum contigs","2006-12-31", 50, "PlasmoDB");


  &writeGeneAliasFile($mgr,"Sanger P. falciparum chromosomes","2009-02-19","PlasmoDB","Pfalciparum");

  &writeGeneAliasFile($mgr,"P.vivax contigs from Genbank","2007-06-13","PlasmoDB","Pvivax"); 

  &writeGeneAliasFile($mgr,"Jane Carlton P. yoelii chromosomes","2002-09-10","PlasmoDB","Pyoelii"); 

  &writeGeneAliasFile($mgr,"P. berghei genome","2006-02-27","PlasmoDB","Pberghei"); 

  &writeGeneAliasFile($mgr,"P. chabaudi genome and annotations","2009-03-24","PlasmoDB","Pchabaudi");

  &writeGeneAliasFile($mgr,"P. knowlesi chromosomes","2007-10-03","PlasmoDB","Pknowlesi");


 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Pfalciparum", "PfalciparumOrfNAs", "Sanger P. falciparum chromosomes","2009-02-19", 50, "PlasmoDB");

 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Pyoelii", "PyoeliiOrfNAs", "Jane Carlton P. yoelii chromosomes","2002-09-10", 50, "PlasmoDB");

 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Pvivax", "PvivaxOrfNAs", "Plasmodium vivax chromosomes,P.vivax contigs from Genbank","2007-09-04,2007-06-13", 50, "PlasmoDB");

 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Pberghei", "PbergheiOrfNAs", "P. berghei genome","2006-02-27", 50, "PlasmoDB");

 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Pchabaudi", "PchabaudiOrfNAs", "P. chabaudi genome and annotations","2009-03-24", 50, "PlasmoDB");

 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Pknowlesi", "PknowlesiOrfNAs", "P. knowlesi chromosomes","2007-10-03", 50, "PlasmoDB");

 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Preichenowi", "PreichenowiOrfNAs", "P. reichenowi contigs","2004-03-11", 50, "PlasmoDB");

 &makeOrfNaDownloadFileWithAbrevDeflineTransformed($mgr, "Pgallinaceum", "PgallinaceumOrfNAs", "P. gallinaceum contigs","2006-12-31", 50, "PlasmoDB");

&makeIsolateDownloadFile($mgr, "", "PlasmodiumIsolates", "Plasmodium isolates From Genbank","2009-04-13", "ExternalNASequence");
&makeIsolateDownloadFile($mgr, "", "PlasmodiumBarcodeIsolates", "Isolate barcode data from Broad","2008-06-13", "ExternalNASequence");

&makeCodonUsage($mgr, "Pfalciparum", "AnnotatedCDS");
&makeCodonUsage($mgr, "Pberghei", "AnnotatedCDS");
&makeCodonUsage($mgr, "Pyoelii", "AnnotatedCDS");
&makeCodonUsage($mgr, "Pchabaudi", "AnnotatedCDS");
&makeCodonUsage($mgr, "Pvivax", "AnnotatedCDS");
&makeCodonUsage($mgr, "Pknowlesi", "AnnotatedCDS");


&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pfalciparum/PfalciparumOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PfalciparumOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pfalciparum/PfalciparumAnnotatedProteins_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PfalciparumAnnotatedProteins_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/plasmoDB/6.0/analysis_pipeline/weili1/gff/Plasmodium_falciparum/p_falciparum.gff", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pfalciparum/Pfalciparum_PlasmoDB-6.0.gff");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pfalciparum/Plasmodium_falciparum/p_falciparum_gene.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pfalciparum/PfalciparumGene_PlasmoDB-6.0.txt");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pfalciparum/Plasmodium_falciparum/p_falciparum_sequence.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pfalciparum/PfalciparumSequence_PlasmoDB-6.0.txt");




&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pberghei/PbergheiOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PbergheiOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pberghei/PbergheiAnnotatedProteins_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PbergheiAnnotatedProteins_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pberghei/Plasmodium_berghei/p_berghei_gene.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pberghei/PbergheiGene_PlasmoDB-6.0.txt");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pberghei/Plasmodium_berghei/p_berghei_sequence.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pberghei/PbergheiSequence_PlasmoDB-6.0.txt");

&copy($mgr, "/files/cbil/data/cbil/plasmoDB/6.0/analysis_pipeline/weili1/gff/Plasmodium_berghei/p_berghei.gff", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pberghei/Pberghei_PlasmoDB-6.0.gff");



&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pyoelii/PyoeliiOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PyoeliiOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pyoelii/PyoeliiAnnotatedProteins_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PyoeliiAnnotatedProteins_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pyoelii/Plasmodium_yoelii/p_yoelii_gene.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pyoelii/PyoeliiGene_PlasmoDB-6.0.txt");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pyoelii/Plasmodium_yoelii/p_yoelii_sequence.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pyoelii/PyoeliiSequence_PlasmoDB-6.0.txt");

&copy($mgr, "/files/cbil/data/cbil/plasmoDB/6.0/analysis_pipeline/weili1/gff/Plasmodium_yoelii/p_yoelii.gff", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pyoelii/Pyoelii_PlasmoDB-6.0.gff");


&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pchabaudi/PchabaudiOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PchabaudiOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pchabaudi/PchabaudiAnnotatedProteins_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PchabaudiAnnotatedProteins_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pchabaudi/Plasmodium_chabaudi/p_chabaudi_gene.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pchabaudi/PchabaudiGene_PlasmoDB-6.0.txt");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pchabaudi/Plasmodium_chabaudi/p_chabaudi_sequence.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pchabaudi/PchabaudiSequence_PlasmoDB-6.0.txt");

&copy($mgr, "/files/cbil/data/cbil/plasmoDB/6.0/analysis_pipeline/weili1/gff/Plasmodium_chabaudi/p_chabaudi.gff", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pchabaudi/Pchabaudi_PlasmoDB-6.0.gff");



&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pvivax/PvivaxOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PvivaxOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pvivax/PvivaxAnnotatedProteins_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PvivaxAnnotatedProteins_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pvivax/Plasmodium_vivax/p_vivax_gene.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pvivax/PvivaxGene_PlasmoDB-6.0.txt");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pvivax/Plasmodium_vivax/p_vivax_sequence.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pvivax/PvivaxSequence_PlasmoDB-6.0.txt");

&copy($mgr, "/files/cbil/data/cbil/plasmoDB/6.0/analysis_pipeline/weili1/gff/Plasmodium_vivax/p_vivax.gff", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pvivax/Pvivax_PlasmoDB-6.0.gff");


&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pknowlesi/PknowlesiOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PknowlesiOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pknowlesi/PknowlesiAnnotatedProteins_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PknowlesiAnnotatedProteins_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pknowlesi/Plasmodium_knowlesi/p_knowlesi_gene.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pknowlesi/PknowlesiGene_PlasmoDB-6.0.txt");

#&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pknowlesi/Plasmodium_knowlesi/p_knowlesi_sequence.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pknowlesi/PknowlesiSequence_PlasmoDB-6.0.txt");

&copy($mgr, "/files/cbil/data/cbil/plasmoDB/6.0/analysis_pipeline/weili1/gff/Plasmodium_knowlesi/p_knowlesi.gff", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pknowlesi/Pknowlesi_PlasmoDB-6.0.gff");



&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Pgallinaceum/PgallinaceumOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PgallinaceumOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-6.0/Preichenowi/PreichenowiOrfs_PlasmoDB-6.0.fasta",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif/PreichenowiOrfs_PlasmoDB.fasta", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-6.0/motif");


######################################################
####### modify files for download and BLASTDir
#####################################################

&xdformatDownloadFileForBlastSite($mgr,"Pfalciparum","PfalciparumEST_PlasmoDB-6.0.fasta","PfalciparumEST","-n -t release-6.0/PfalciparumEST");

&xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxEST_PlasmoDB-6.0.fasta","PvivaxEST","-n -t release-6.0/PvivaxEST");

&xdformatDownloadFileForBlastSite($mgr,"Pyoelii","PyoeliiEST_PlasmoDB-6.0.fasta","PyoeliiEST","-n -t release-6.0/PyoeliiEST");

&xdformatDownloadFileForBlastSite($mgr,"Pberghei","PbergheiEST_PlasmoDB-6.0.fasta","PbergheiEST","-n -t release-6.0/PbergheiEST");


 &xdformatDownloadFileForBlastSite($mgr,"Pfalciparum","PfalciparumAssemblies_PlasmoDB-6.0.fasta","PfalciparumAssemblies","-n -t release-6.0/PfalciparumAssemblies");

 &xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxAssemblies_PlasmoDB-6.0.fasta","PvivaxAssemblies","-n -t release-6.0/PvivaxAssemblies");

 &xdformatDownloadFileForBlastSite($mgr,"Pyoelii","PyoeliiAssemblies_PlasmoDB-6.0.fasta","PyoeliiAssemblies","-n -t release-6.0/PyoeliiAssemblies");

 &xdformatDownloadFileForBlastSite($mgr,"Pberghei","PbergheiAssemblies_PlasmoDB-6.0.fasta","PbergheiAssemblies","-n -t release-6.0/PbergheiAssemblies");


 &xdformatDownloadFileForBlastSite($mgr, "Pfalciparum","PfalciparumOrfs_PlasmoDB-6.0.fasta","PfalciparumORF","-p -C X -t release-6.0/PfalciparumORF");

 &xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxOrfs_PlasmoDB-6.0.fasta","PvivaxORF","-p -C X -t release-6.0/PvivaxORF");

 &xdformatDownloadFileForBlastSite($mgr,"Pyoelii","PyoeliiOrfs_PlasmoDB-6.0.fasta","PyoeliiORF","-p -C X -t release-6.0/PyoeliiORF");

 &xdformatDownloadFileForBlastSite($mgr,"Pberghei","PbergheiOrfs_PlasmoDB-6.0.fasta","PbergheiORF","-p -C X -t release-6.0/PbergheiORF");

 &xdformatDownloadFileForBlastSite($mgr,"Pchabaudi","PchabaudiOrfs_PlasmoDB-6.0.fasta","PchabaudiORF","-p -C X -t release-6.0/PchabaudiORF");

 &xdformatDownloadFileForBlastSite($mgr,"Preichenowi","PreichenowiOrfs_PlasmoDB-6.0.fasta","PreichenowiORF","-p -C X -t release-6.0/PreichenowiORF");

 &xdformatDownloadFileForBlastSite($mgr,"Pgallinaceum","PgallinaceumOrfs_PlasmoDB-6.0.fasta","PgallinaceumORF", "-p -C X -t release-6.0/PgallinaceumORF");

 &xdformatDownloadFileForBlastSite($mgr,"Pknowlesi","PknowlesiOrfs_PlasmoDB-6.0.fasta","PknowlesiORF","-p -C X -t release-6.0/PknowlesiORF");

 &xdformatDownloadFileForBlastSite($mgr, "PfalciparumMito","PfalciparumMitoOrfs_PlasmoDB-6.0.fasta","PfalciparumMitoORF","-p -C X -t release-6.0/PfalciparumMitoORF");
 &xdformatDownloadFileForBlastSite($mgr, "PfalciparumPlastid","PfalciparumPlastidOrfs_PlasmoDB-6.0.fasta","PfalciparumPlastidORF","-p -C X -t release-6.0/PfalciparumPlastidORF");
 &xdformatDownloadFileForBlastSite($mgr,"PvivaxMito","PvivaxMitoOrfs_PlasmoDB-6.0.fasta","PvivaxMitoORF","-p -C X -t release-6.0/PvivaxMitoORF")


 &xdformatDownloadFileForBlastSite($mgr,"Pfalciparum","PfalciparumGenomic_PlasmoDB-6.0.fasta","PfalciparumGenomics","-n -t release-6.0/PfalciparumGenomics");

  &xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxGenomic_PlasmoDB-6.0.fasta","PvivaxGenomics","-n -t release-6.0/PvivaxGenomics");

  &xdformatDownloadFileForBlastSite($mgr,"Pyoelii","PyoeliiGenomic_PlasmoDB-6.0.fasta","PyoeliiGenomics","-n -t release-6.0/PyoeliiGenomics");

  &xdformatDownloadFileForBlastSite($mgr,"Pberghei","PbergheiGenomic_PlasmoDB-6.0.fasta","PbergheiGenomics","-n -t release-6.0/PbergheiGenomics");

  &xdformatDownloadFileForBlastSite($mgr,"Pchabaudi","PchabaudiGenomic_PlasmoDB-6.0.fasta","PchabaudiGenomics","-n -t release-6.0/PchabaudiGenomics");

  &xdformatDownloadFileForBlastSite($mgr,"Pknowlesi","PknowlesiGenomic_PlasmoDB-6.0.fasta","PknowlesiGenomics","-n -t release-6.0/PknowlesiGenomics");

  &xdformatDownloadFileForBlastSite($mgr,"Preichenowi","PreichenowiGenomic_PlasmoDB-6.0.fasta","PreichenowiGenomics","-n -t release-6.0/PreichenowiGenomics");

  &xdformatDownloadFileForBlastSite($mgr,"Pgallinaceum","PgallinaceumGenomic_PlasmoDB-6.0.fasta","PgallinaceumGenomics","-n -t release-6.0/PgallinaceumGenomics");

 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumMito","PfalciparumMitoGenomic_PlasmoDB-6.0.fasta","PfalciparumMitoGenomics","-n -t release-6.0/PfalciparumMitoGenomics");
 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumPlastid","PfalciparumPlastidGenomic_PlasmoDB-6.0.fasta","PfalciparumPlastidGenomics","-n -t release-6.0/PfalciparumPlastidGenomics");
 &xdformatDownloadFileForBlastSite($mgr,"PvivaxMito","PvivaxMitoGenomic_PlasmoDB-6.0.fasta","PvivaxMitoGenomics","-n -t release-6.0/PvivaxMitoGenomics");


 &xdformatDownloadFileForBlastSite($mgr,"Pfalciparum","PfalciparumAnnotatedProteins_PlasmoDB-6.0.fasta","PfalciparumProteins","-p -C X -t release-6.0/PfalciparumProteins");

  &xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxAnnotatedProteins_PlasmoDB-6.0.fasta","PvivaxProteins","-p -C X -t release-6.0/PvivaxProteins");

  &xdformatDownloadFileForBlastSite($mgr,"Pyoelii","PyoeliiAnnotatedProteins_PlasmoDB-6.0.fasta","PyoeliiProteins","-p -C X -t release-6.0/PyoeliiProteins");

  &xdformatDownloadFileForBlastSite($mgr,"Pberghei","PbergheiAnnotatedProteins_PlasmoDB-6.0.fasta","PbergheiProteins","-p -C X -t release-6.0/PbergheiProteins");

  &xdformatDownloadFileForBlastSite($mgr,"Pchabaudi","PchabaudiAnnotatedProteins_PlasmoDB-6.0.fasta","PchabaudiProteins","-p -C X -t release-6.0/PchabaudiProteins");

  &xdformatDownloadFileForBlastSite($mgr,"Pknowlesi","PknowlesiAnnotatedProteins_PlasmoDB-6.0.fasta","PknowlesiProteins","-p -C X -t release-6.0/PknowlesiProteins");

 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumMito","PfalciparumMitoAnnotatedProteins_PlasmoDB-6.0.fasta","PfalciparumMitoProteins","-p -C X -t release-6.0/PfalciparumMitoProteins");
 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumPlastid","PfalciparumPlastidAnnotatedProteins_PlasmoDB-6.0.fasta","PfalciparumPlastidProteins","-p -C X -t release-6.0/PfalciparumPlastidProteins");
 &xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxMitoAnnotatedProteins_PlasmoDB-6.0.fasta","PvivaxMitoProteins","-p -C X -t release-6.0/PvivaxMitoProteins");



 &xdformatDownloadFileForBlastSite($mgr,"Pfalciparum","PfalciparumAnnotatedTranscripts_PlasmoDB-6.0.fasta",,"PfalciparumTranscripts","-n -t release-6.0/PfalciparumTranscripts");

 &xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxAnnotatedTranscripts_PlasmoDB-6.0.fasta","PvivaxTranscripts","-n -t release-6.0/PvivaxTranscripts");

 &xdformatDownloadFileForBlastSite($mgr,"Pyoelii","PyoeliiAllTranscripts_PlasmoDB-6.0.fasta","PyoeliiTranscripts","-n -t release-6.0/PyoeliiTranscripts");

 &xdformatDownloadFileForBlastSite($mgr,"Pberghei","PbergheiAllTranscripts_PlasmoDB-6.0.fasta","PbergheiTranscripts","-n -t release-6.0/PbergheiTranscripts");

  &xdformatDownloadFileForBlastSite($mgr,"Pchabaudi","PchabaudiAnnotatedTranscripts_PlasmoDB-6.0.fasta","PchabaudiTranscripts","-n -t release-6.0/PchabaudiTranscripts");

  &xdformatDownloadFileForBlastSite($mgr,"Pknowlesi","PknowlesiAnnotatedTranscripts_PlasmoDB-6.0.fasta","PknowlesiTranscripts","-n -t release-6.0/PknowlesiTranscripts");

 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumMito","PfalciparumMitoAnnotatedTranscripts_PlasmoDB-6.0.fasta",,"PfalciparumMitoTranscripts","-n -t release-6.0/PfalciparumMitoTranscripts");
 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumPlastid","PfalciparumPlastidAnnotatedTranscripts_PlasmoDB-6.0.fasta",,"PfalciparumPlastidTranscripts","-n -t release-6.0/PfalciparumPlastidTranscripts");

 &xdformatDownloadFileForBlastSite($mgr,"PvivaxMito","PvivaxMitoAnnotatedTranscripts_PlasmoDB-6.0.fasta","PvivaxMitoTranscripts","-n -t release-6.0/PvivaxMitoTranscripts");



 &xdformatDownloadFileForBlastSite($mgr,"Pfalciparum","PfalciparumAnnotatedCDS_PlasmoDB-6.0.fasta","PfalciparumCDS","-n -t release-6.0/PfalciparumCDS");

  &xdformatDownloadFileForBlastSite($mgr,"Pvivax","PvivaxAnnotatedCDS_PlasmoDB-6.0.fasta","PvivaxCDS","-n -t release-6.0/PvivaxCDS");

  &xdformatDownloadFileForBlastSite($mgr,"Pyoelii","PyoeliiAnnotatedCDS_PlasmoDB-6.0.fasta","PyoeliiCDS","-n -t release-6.0/PyoeliiCDS");

  &xdformatDownloadFileForBlastSite($mgr,"Pberghei","PbergheiAnnotatedCDS_PlasmoDB-6.0.fasta","PbergheiCDS","-n -t release-6.0/PbergheiCDS");

  &xdformatDownloadFileForBlastSite($mgr,"Pchabaudi","PchabaudiAnnotatedCDS_PlasmoDB-6.0.fasta","PchabaudiCDS","-n -t release-6.0/PchabaudiCDS");

  &xdformatDownloadFileForBlastSite($mgr,"Pknowlesi","PknowlesiAnnotatedCDS_PlasmoDB-6.0.fasta","PknowlesiCDS","-n -t release-6.0/PknowlesiCDS");

 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumMito","PfalciparumMitoAnnotatedCDS_PlasmoDB-6.0.fasta","PfalciparumMitoCDS","-n -t release-6.0/PfalciparumMitoCDS");
 &xdformatDownloadFileForBlastSite($mgr,"PfalciparumPlastid","PfalciparumPlastidAnnotatedCDS_PlasmoDB-6.0.fasta","PfalciparumPlastidCDS","-n -t release-6.0/PfalciparumPlastidCDS");
 &xdformatDownloadFileForBlastSite($mgr,"PvivaxMito","PvivaxMitoAnnotatedCDS_PlasmoDB-6.0.fasta","PvivaxMitoCDS","-n -t release-6.0/PvivaxMitoCDS");

  &xdformatDownloadFileForBlastSite($mgr,'','PlasmodiumIsolates_PlasmoDB-6.0.fasta',"PlasmodiumIsolates","-n -t release-6.0/PlasmodiumIsolates");
  &xdformatDownloadFileForBlastSite($mgr,'','PlasmodiumBarcodeIsolates_PlasmoDB-6.0.fasta',"PlasmodiumBarcodeIsolates","-n -t release-6.0/PlasmodiumBarcodeIsolates");

#################################################################
##Microarray
#################################################################


###########BlastX oligos against transcript seqs###########

my $blastParams = "-nogaps E=10 M=1 N=-3 Q=3 R=1","blastn";

&createSimilarityDir($mgr,"WestenbergerPivaxOligos","PvivaxAnnotatedTranscripts","(\\S+)\\s+length","E=10 M=1 N=-3 Q=3 R=1","blastn");

&copyFilesToComputeCluster($mgr,"WestenbergerPivaxOligos-PvivaxAnnotatedTranscripts","similarity");

&copyFilesToComputeCluster($mgr,"WestenbergerPivaxOligos.fsa","seqfiles");

&copyFilesToComputeCluster($mgr,"PvivaxAnnotatedTranscripts.fsa","seqfiles");

&startProteinBlastOnComputeCluster($mgr,"WestenbergerPivaxOligos","PvivaxAnnotatedTranscripts","apidb");

&copyFilesFromComputeCluster($mgr,"WestenbergerPivaxOligos-PviavxAnnotatedTranscripts","similarity");


&createSimilarityDir($mgr,"WinzelerOligos","PfalciparumAnnotatedTranscripts","(\\S+)","E=10 M=1 N=-3 Q=3 R=1","blastn");

&copyFilesToComputeCluster($mgr,"WinzelerOligos-PfalciparumAnnotatedTranscripts","similarity");

&copyFilesToComputeCluster($mgr,"WinzelerOligos.fsa","seqfiles");

&copyFilesToComputeCluster($mgr,"PfalciparumAnnotatedTranscripts.fsa","seqfiles");

&startProteinBlastOnComputeCluster($mgr,"WinzelerOligos","PfalciparumAnnotatedTranscripts","apidb");

&copyFilesFromComputeCluster($mgr,"WinzelerOligos-PfalciparumAnnotatedTranscripts","similarity");

&createSimilarityDir($mgr,"WinzelerOligos","PyoeliiAnnotatedTranscripts","(\\S+)","E=10 M=1 N=-3 Q=3 R=1","blastn");

&copyFilesToComputeCluster($mgr,"WinzelerOligos-PyoeliiAnnotatedTranscripts","similarity");

&copyFilesToComputeCluster($mgr,"WinzelerOligos.fsa","seqfiles");

&copyFilesToComputeCluster($mgr,"PyoeliiAnnotatedTranscripts.fsa","seqfiles");

&startProteinBlastOnComputeCluster($mgr,"WinzelerOligos","PyoeliiAnnotatedTranscripts","apidb");

&copyFilesFromComputeCluster($mgr,"WinzelerOligos-PyoeliiAnnotatedTranscripts","similarity");


#######################################################################################################
# ##Linking tables between RAD and DOTS##
&InsertCompositeElementNaSequences($mgr,'Scripps Malaria GeneChip', 0);

&InsertCompositeElementNaSequences($mgr,'Agilent P. Berghei Oligo Array', 0);

&InsertCompositeElementNaSequences($mgr,'MTC_KI_Plasmodium_falciparum_33k', 1);

&InsertCompositeElementNaSequences($mgr,'DeRisi_Plasmodium_falciparum_Oligo_Array_7282', 1);

&InsertCompositeElementNaSequences($mgr,'Pfab', 1);

# #RAD Analysis (Normalization)

&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/E-MEXP-128_arrayData/","$projectDir/$release/analysis_pipeline/primary/data/", "$projectDir/$release/analysis_pipeline/primary/data/");

&InsertRadAnalysisFromConfig($mgr, "$projectDir/$release/analysis_pipeline/primary/data/E-MEXP-128_arrayData/e-mexp-128_arrayData.xml", "load_E-MEXP-128_arrayData");


# # RAD Analysis Page
&copy($mgr,"$projectDir/$release/resources_pipeline/primary/downloads/Cowman_radAnalysis/","$projectDir/$release/analysis_pipeline/primary/data/", "$projectDir/$release/analysis_pipeline/primary/data/");

&InsertRadAnalysisFromConfig($mgr, "$projectDir/$release/analysis_pipeline/primary/data/Cowman_radAnalysis/radAnalysis/expressionProfile.xml", "load_Cowman_expressionProfile","Rpath");

# ##expression profiles#######
&documentProfileAveraging($mgr);

&loadAveragedProfiles($mgr,"DeRisi Dd2 Time Series|1.0","DeRisi Dd2 Normalized repsCollapsed, DeRisi Dd2 Smoothed, DeRisi Dd2 Percents",1);

&loadAveragedProfiles($mgr,"DeRisi 3D7 Time Series|1.0","DeRisi 3D7 Normalized repsCollapsed, DeRisi 3D7 Smoothed, DeRisi 3D7 Percents",1);

&loadAveragedProfiles($mgr,"DeRisi HB3 Time Series|1.0","DeRisi HB3 Normalized repsCollapsed, DeRisi HB3 Smoothed, DeRisi HB3 Percents",1);

&documentExpressionStatistics($mgr);

&calculateExpressionStats($mgr,"DeRisi Dd2 Time Series|1.0","DeRisi Dd2 Smoothed Averaged","manualDelivery/expressionProfiles/derisi/Dd2/tp_mapping_Dd2.txt","DeRisi Dd2 Percents Averaged","1");

&calculateExpressionStats($mgr,"DeRisi 3D7 Time Series|1.0","DeRisi 3D7 Smoothed Averaged","manualDelivery/expressionProfiles/derisi/3D7/tp_mapping_3D7.txt","DeRisi 3D7 Percents Averaged","1");

&calculateExpressionStats($mgr,"DeRisi HB3 Time Series|1.0","DeRisi HB3 Smoothed Averaged","manualDelivery/expressionProfiles/derisi/HB3/tp_mapping_HB3.txt","DeRisi HB3 Percents Averaged","1");

&calculateExpressionStats($mgr,"Winzeler Cell Cycle|1.0","winzeler_cc_sorbExp","","winzeler_cc_sorbPct","0");

&calculateExpressionStats($mgr,"Transcriptional profile of the Pvivax time-series|1.0","ZB Pvivax time series normalized_averaged 1","","ZB Pvivax time series percentiles 1","1");

&calculateExpressionStats($mgr,"Transcriptional profile of the Pvivax time-series|1.0","ZB Pvivax time series normalized_averaged 2","","ZB Pvivax time series percentiles 2","1");

&calculateExpressionStats($mgr,"Transcriptional profile of the Pvivax time-series|1.0","ZB Pvivax time series normalized_averaged 3","","ZB Pvivax time series percentiles 3","1");

&calculateExpressionStats($mgr,"Westenberger Pvivax ExpressionData|1.0","westenberger vivax expression profile","","westenberger vivax expression profile percentiles","0");

&loadAveragedProfiles($mgr,"P.berghei expression profile - HP - Hall-Waters|1.0", "Waters HP Percents, Waters HP Timecourse", 1);

&loadAveragedProfiles($mgr,"P.berghei expression profile - HPE - Hall-Waters|1.0", "Waters HPE Percents, Waters HPE Timecourse", 1); 

&InsertExpressionProfileFromProcessedResult($mgr, 'Invasion by P. falciparum merozoites (Cowman Lab)', '1', 'Scripps Malaria GeneChip', 'Robust Multi-Array Average expression measure (Bioconductor affy package)', 'RMAExpress', '', 1, '2');

&InsertExpressionProfileFromProcessedResult($mgr, 'P.falciparum strain 3D7, SIR2 knockout (Cowman Lab)', '1', 'Scripps Malaria GeneChip', 'Robust Multi-Array Average expression measure (Bioconductor affy package)', 'RMAExpress', '', 1, '2');

&InsertExpressionProfileFromProcessedResult($mgr, 'P.falciparum invasion pathways (Cowman Lab)', '1', 'Scripps Malaria GeneChip', 'Robust Multi-Array Average expression measure (Bioconductor affy package)', 'RMAExpress', '', 1, '2');

# &InsertExpressionProfileFromProcessedResult($mgr, 'Plasmodium falciparum in malaria infected patients(Daily Lab)', '1', 'Scripps Malaria GeneChip', 'RMA summarization', 'RMAExpress', '', 1, '2');

&InsertExpressionProfileFromProcessedResult($mgr, 'Expression profile of 3D7 clones (E-MEXP-128)', '1', 'MTC_KI_Plasmodium_falciparum_33k', 'Loess normalization, maNorm function (Bioconductor marray package)', 'DataTransformationResult', '', 2);

&InsertAveragedExpressionProfile($mgr,"Expression profile of 3D7 clones 3D7AH1S2 and 3D7S8.4 at ring, trophozite and schizont stages.","/files/cbil/data/cbil/plasmoDB/manualDelivery/expressionArrayStudies/E-MEXP-128/working_dir/profileavg.config");

&calculateExpressionStats($mgr,"P.falciparum RNA Sequence Profiles|1.0","P.falciparum RNA Sequence Profiles","","","1");


###################################################################
############ChIP-chip data########################################
##################################################################
&mapTagsToNaSequences($mgr, "$dataDir/seqfiles/PfalciparumChroms.fsa", "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Henk_Stunnenberg/working_dir/probes.fsa", "Henk_Stunnenberg_ChIP_RAW");

&loadExpressionFeature($mgr, "mapHenk_Stunnenberg_ChIP_RAWTagsToNaSequences.mapping", "ChIP Chip Henk Stunnenberg|2009-05-18", "ArrayElementFeature", "Henk_Stunnenber_ChIP_RAW");

&InsertSimpleRadAnalysisFromConfig($mgr, "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Henk_Stunnenberg/working_dir/", "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Henk_Stunnenberg/working_dir/config.txt", "DataTransformationResult", "ArrayElementFeature", "ChIP-chip_Henk_Stunnenberg_Analysis", 1);

&mapTagsToNaSequences($mgr, "$dataDir/seqfiles/PfalciparumChroms.fsa", "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Artur_Scherf/working_dir/probes.fsa", "Artur_Scherf_ChIP_RAW");

&loadExpressionFeature($mgr, "mapArtur_Scherf_ChIP_RAWTagsToNaSequences.mapping", "ChIP Chip Artur Scherf|2008-09-23", "ArrayElementFeature", "Artur_Scherf_ChIP_RAW");

&InsertSimpleRadAnalysisFromConfig($mgr, "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Artur_Scherf/working_dir/", "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Artur_Scherf/working_dir/config.txt", "DataTransformationResult", "ArrayElementFeature", "ChIP-chip_Artur_Scherf_Analysis", 1);

&mapTagsToNaSequences($mgr, "$dataDir/seqfiles/PfalciparumChroms.fsa", "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Till_Voss/working_dir/Probe.fasta", "Till_Voss_ChIP_RAW");

&loadExpressionFeature($mgr, "mapTill_Voss_ChIP_RAWTagsToNaSequences.mapping", "ChIP Chip Till Voss|2009-08", "ArrayElementFeature", "Till_Voss_ChIP_RAW");

&InsertSimpleRadAnalysisFromConfig($mgr, "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Till_Voss/working_dir/", "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Till_Voss/working_dir/config.txt", "DataTransformationResult", "ArrayElementFeature", "ChIP-chip_Till_Voss_Analysis", 1);

&mapTagsToNaSequences($mgr, "/files/cbil/data/cbil/plasmoDB/6.4/analysis_pipeline/primary/data/seqfiles/PfalciparumChroms.fsa", "/files/cbil/data/cbil/plasmoDB/manualDelivery/chip_chip/Winzeler_Westenberger/working/probes.fsa", "Winzeler_Westenberger_ChIP_RAW");

&loadExpressionFeature($mgr, "mapWinzeler_Westenberger_ChIP_RAWTagsToNaSequences.mapping_unique", "ChIP_Chip_Winzeler_Westenberger|2009-11", "ArrayElementFeature", "Winzeler_Westenberger_ChIP_RAW");



######################################################################
#############make download files####################################
#####################################################################
&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/PfalciparumOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PfalciparumOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/PfalciparumAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PfalciparumAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/Plasmodium_falciparum/p_falciparum_gene.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/PfalciparumGene_PlasmoDB-5.5.txt");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/Plasmodium_falciparum/p_falciparum_sequence.txt", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/PfalciparumSequence_PlasmoDB-5.5.txt");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/Plasmodium_falciparum/p_falciparum.gff", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/Pfalciparum_PlasmoDB-5.5.gff");

&copyDirectory ($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/Plasmodium_falciparum", "/files/cbil/data/cbil/plasmoDB/5.5/analysis_pipeline/primary/data/downloadSite");

&makeCodonUsage($mgr, "Pfalciparum", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/PbergheiOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PbergheiOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/PbergheiAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PbergheiAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/Plasmodium_berghei/p_berghei_gene.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/PbergheiGene_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/Plasmodium_berghei/p_berghei_sequence.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/PbergheiSequence_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/Plasmodium_berghei/p_berghei.gff.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/Pberghei_PlasmoDB-5.5.gff.gz");

&copyDirectory ($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/Plasmodium_berghei", "/files/cbil/data/cbil/plasmoDB/5.5/analysis_pipeline/primary/data/downloadSite");

&makeCodonUsage($mgr, "Pberghei", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/PyoeliiOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PyoeliiOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/PyoeliiAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PyoeliiAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/Plasmodium_yoelii/p_yoelii_gene.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/PyoeliiGene_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/Plasmodium_yoelii/p_yoelii_sequence.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/PyoeliiSequence_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/Plasmodium_yoelii/p_yoelii.gff.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/Pyoelii_PlasmoDB-5.5.gff.gz");

&copyDirectory ($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/Plasmodium_yoelii", "/files/cbil/data/cbil/plasmoDB/5.5/analysis_pipeline/primary/data/downloadSite");

&makeCodonUsage($mgr, "Pyoelii", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/PchabaudiOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PchabaudiOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/PchabaudiAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PchabaudiAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/Plasmodium_chabaudi/p_chabaudi_gene.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/PchabaudiGene_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/Plasmodium_chabaudi/p_chabaudi_sequence.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/PchabaudiSequence_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/Plasmodium_chabaudi/p_chabaudi.gff.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/Pchabaudi_PlasmoDB-5.5.gff.gz");

&copyDirectory ($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/Plasmodium_chabaudi", "/files/cbil/data/cbil/plasmoDB/5.5/analysis_pipeline/primary/data/downloadSite");

&makeCodonUsage($mgr, "Pchabaudi", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/PvivaxOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PvivaxOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/PvivaxAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PvivaxAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/Plasmodium_vivax/p_vivax_gene.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/PvivaxGene_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/Plasmodium_vivax/p_vivax_sequence.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/PvivaxSequence_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/Plasmodium_vivax/p_vivax.gff.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/Pvivax_PlasmoDB-5.5.gff.gz");

&copyDirectory ($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/Plasmodium_vivax", "/files/cbil/data/cbil/plasmoDB/5.5/analysis_pipeline/primary/data/downloadSite");

&makeCodonUsage($mgr, "Pvivax", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/PknowlesiOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PknowlesiOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/PknowlesiAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PknowlesiAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/Plasmodium_knowlesi/p_knowlesi_gene.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/PknowlesiGene_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/Plasmodium_knowlesi/p_knowlesi_sequence.txt.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/PknowlesiSequence_PlasmoDB-5.5.txt.gz");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/Plasmodium_knowlesi/p_knowlesi.gff.gz", "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/Pknowlesi_PlasmoDB-5.5.gff.gz");

&copyDirectory ($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/Plasmodium_knowlesi", "/files/cbil/data/cbil/plasmoDB/5.5/analysis_pipeline/primary/data/downloadSite");

&makeCodonUsage($mgr, "Pknowlesi", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pgallinaceum/PgallinaceumOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PgallinaceumOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Preichenowi/PreichenowiOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PreichenowiOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PvivaxMito/PvivaxMitoOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PvivaxMitoOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PvivaxMito/PvivaxMitoAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PvivaxMitoAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&makeCodonUsage($mgr, "PvivaxMito", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PfalciparumPlastid/PfalciparumPlastidOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PfalciparumPlastidOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PfalciparumPlastid/PfalciparumPlastidAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PfalciparumPlastidAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&makeCodonUsage($mgr, "PfalciparumPlastid", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PfalciparumMito/PfalciparumMitoOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PfalciparumMitoOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PfalciparumMito/PfalciparumMitoAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PfalciparumMitoAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&makeCodonUsage($mgr, "PfalciparumMito", "AnnotatedCDS");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Plasmodium/PlasmodiumOrfs_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PlasmodiumOrfs_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&copy($mgr, "/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Plasmodium/PlasmodiumAnnotatedProteins_PlasmoDB-5.5.fasta.gz",  "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif/PlasmodiumAnnotatedProteins_PlasmoDB.fasta.gz", "/files/cbil/data/cbil/apiSiteFiles/webServices/PlasmoDB/release-5.5/motif");

&concatFiles($mgr,"/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PvivaxMito/PvivaxMitoCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PfalciparumMito/PfalciparumMitoCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/PfalciparumPlastid/PfalciparumPlastidCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/PfalciparumCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/PvivaxCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/PyoeliiCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/PbergheiCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/PchabaudiCodonUsage_PlasmoDB-5.5.txt /files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/PknowlesiCodonUsage_PlasmoDB-5.5.txt ","/downloadSite/PlasmoDB/release-5.5/Plasmodium/PlasmodiumCodonUsage_PlasmoDB-5.5.txt");


################################################################################
# Mercator
################################################################################

# RepeatMasker steps
# NOTES #####################
# Don't get the fasta from the download site... use dumpSequence.pl
&dumpNaSequence($mgr,"$dataDir/mercator/Plasmodium_species/seqfiles","PfalciparumGenomic_plasmoDB-5.5","Sanger P. falciparum chromosomes","2007-06-28");
&dumpNaSequence($mgr,"$dataDir/mercator/Plasmodium_species/seqfiles","PbergheiGenomic_plasmoDB-5.5","P. berghei genome","2006-02-27");
&dumpNaSequence($mgr,"$dataDir/mercator/Plasmodium_species/seqfiles","PchabaudiGenomic_plasmoDB-5.5","P. chabaudi genome","2006-02-27");
&dumpNaSequence($mgr,"$dataDir/mercator/Plasmodium_species/seqfiles","PknowlesiGenomic_plasmoDB-5.5","Sanger P. knowlesi chromosomes","2007-10-03");
&dumpNaSequence($mgr,"$dataDir/mercator/Plasmodium_species/seqfiles","PvivaxGenomic_plasmoDB-5.5","P.vivax contigs from Genbank","2007-06-13");
&dumpNaSequence($mgr,"$dataDir/mercator/Plasmodium_species/seqfiles","PyoeliiGenomic_plasmoDB-5.5","Jane Carlton P. yoelii chromosomes","2002-09-10");
&copy($mgr, "$projectDir/manualDelivery/Pfalciparum_strains/plasmodium_falciparum__isolate_dd2__1_supercontigs.fasta", "$dataDir/mercator/Pfalciparum_strains/seqfiles/PfalciparumDD2Genomic_plasmoDB-5.5.fasta","$dataDir/mercator/Pfalciparum_strains/seqfiles/PfalciparumDD2Genomic_plasmoDB-5.5.fsa");
&copy($mgr, "$projectDir/manualDelivery/Pfalciparum_strains/plasmodium_falciparum__isolate_hb3__1_supercontigs.fasta", "$dataDir/mercator/Pfalciparum_strains/seqfiles/PfalciparumHB3Genomic_plasmoDB-5.5.fsa");
&copy($mgr, "$projectDir/manualDelivery/Pfalciparum_strains/PFCLIN.contigs.fasta.20080302", "$dataDir/mercator/Pfalciparum_strains/seqfiles/PfalciparumGhanaianGenomic_plasmoDB-5.5.fsa");
&copy($mgr, "$projectDir/manualDelivery/Pfalciparum_strains/IT_2007114.phusion.supercontigs.fasta", "$dataDir/mercator/Pfalciparum_strains/seqfiles/PfalciparumITGenomic_plasmoDB-5.5.fsa");
&dumpNaSequence($mgr,"$dataDir/mercator/Pfalciparum_strains/seqfiles","Pfalciparum3D7Genomic_plasmoDB-5.5","Sanger P. falciparum chromosomes","2007-06-28");


# Should be fine... but maybe
#**** These steps use the same repeatmask dir used in the main pipeline which causes a conflict!! ****
&copyFilesToComputeCluster($mgr,'mercator');

#**** These steps use the same repeatmask dir used in the main pipeline which causes a conflict!! ****
&createRepeatMaskDir_new($mgr, 'PfalciparumGenomic_plasmoDB-5.5', 4,'-xsmall', 1,'mercator/Plasmodium_species');
&createRepeatMaskDir_new($mgr, 'PbergheiGenomic_plasmoDB-5.5', 4,'-xsmall', 150,'mercator/Plasmodium_species');
&createRepeatMaskDir_new($mgr, 'PchabaudiGenomic_plasmoDB-5.5',4, '-xsmall', 150,'mercator/Plasmodium_species');
&createRepeatMaskDir_new($mgr, 'PknowlesiGenomic_plasmoDB-5.5', 4,'-xsmall', 1,'mercator/Plasmodium_species');
&createRepeatMaskDir_new($mgr, 'PvivaxGenomic_plasmoDB-5.5', 4,'-xsmall', 150,'mercator/Plasmodium_species');
&createRepeatMaskDir_new($mgr, 'PyoeliiGenomic_plasmoDB-5.5', 4,'-xsmall', 150,'mercator/Plasmodium_species');
&createRepeatMaskDir_new($mgr, 'Pfalciparum3D7Genomic_plasmoDB-5.5', 4,'-xsmall', 1,'mercator/Pfalciparum_strains');
&createRepeatMaskDir_new($mgr, 'PfalciparumDD2Genomic_plasmoDB-5.5',4, '-xsmall', 150,'mercator/Pfalciparum_strains');
&createRepeatMaskDir_new($mgr, 'PfalciparumHB3Genomic_plasmoDB-5.5',4, '-xsmall', 150,'mercator/Pfalciparum_strains');
&createRepeatMaskDir_new($mgr, 'PfalciparumGhanaianGenomic_plasmoDB-5.5',4, '-xsmall', 1,'mercator/Pfalciparum_strains');
&createRepeatMaskDir_new($mgr, 'PfalciparumITGenomic_plasmoDB-5.5',4, '-xsmall', 150,'mercator/Pfalciparum_strains');


#**** These steps use the same repeatmask dir used in the main pipeline which causes a conflict!! ****
&copyFilesToComputeCluster($mgr, 'repeatmask','mercator/Plasmodium_species');
&copyFilesToComputeCluster($mgr, 'repeatmask','mercator/Pfalciparum_strains');

&startRepeatMaskOnComputeCluster($mgr, 'PfalciparumGenomic_plasmoDB-5.5', 'apidb','mercator/Plasmodium_species');
&startRepeatMaskOnComputeCluster($mgr, 'PbergheiGenomic_plasmoDB-5.5', 'apidb','mercator/Plasmodium_species');
&startRepeatMaskOnComputeCluster($mgr, 'PchabaudiGenomic_plasmoDB-5.5', 'apidb','mercator/Plasmodium_species');
&startRepeatMaskOnComputeCluster($mgr, 'PknowlesiGenomic_plasmoDB-5.5', 'apidb','mercator/Plasmodium_species');
&startRepeatMaskOnComputeCluster($mgr, 'PvivaxGenomic_plasmoDB-5.5', 'apidb','mercator/Plasmodium_species');
&startRepeatMaskOnComputeCluster($mgr, 'PyoeliiGenomic_plasmoDB-5.5', 'apidb','mercator/Plasmodium_species');

&startRepeatMaskOnComputeCluster($mgr, 'Pfalciparum3D7Genomic_plasmoDB-5.5', 'apidb','mercator/Pfalciparum_strains');
&startRepeatMaskOnComputeCluster($mgr, 'PfalciparumDD2Genomic_plasmoDB-5.5', 'apidb','mercator/Pfalciparum_strains');
&startRepeatMaskOnComputeCluster($mgr, 'PfalciparumHB3Genomic_plasmoDB-5.5', 'apidb','mercator/Pfalciparum_strains');
&startRepeatMaskOnComputeCluster($mgr, 'PfalciparumGhanaianGenomic_plasmoDB-5.5', 'apidb','mercator/Pfalciparum_strains');
&startRepeatMaskOnComputeCluster($mgr, 'PfalciparumITGenomic_plasmoDB-5.5', 'apidb','mercator/Pfalciparum_strains');


$mgr->waitForCluster("Repeat Mask PfalciparumGenomic_plasmoDB-5.5", "PfalciparumGenomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PbergheiGenomic_plasmoDB-5.5", "PbergheiGenomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PchabaudiGenomic_plasmoDB-5.5", "PchabaudiGenomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PknowlesiGenomic_plasmoDB-5.5", "PknowlesiGenomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PvivaxGenomic_plasmoDB-5.5", "PvivaxGenomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PyoeliiGenomic_plasmoDB-5.5", "PyoeliiGenomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask Pfalciparum3D7Genomic_plasmoDB-5.5", "Pfalciparum3D7Genomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PfalciparumDD2Genomic_plasmoDB-5.5", "PfalciparumDD2Genomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PfalciparumHB3Genomic_plasmoDB-5.5", "PfalciparumHB3Genomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PfalciparumGhanaianGenomic_plasmoDB-5.5", "PfalciparumGhanaianGenomic_plasmoDB-5.5");
$mgr->waitForCluster("Repeat Mask PfalciparumITGenomic_plasmoDB-5.5", "PfalciparumITGenomic_plasmoDB-5.5");


&copyFilesFromComputeCluster($mgr, 'PbergheiGenomic_plasmoDB-5.5', 'mercator/Plasmodium_species/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PchabaudiGenomic_plasmoDB-5.5', 'mercator/Plasmodium_species/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PfalciparumGenomic_plasmoDB-5.5', 'mercator/Plasmodium_species/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PknowlesiGenomic_plasmoDB-5.5', 'mercator/Plasmodium_species/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PvivaxGenomic_plasmoDB-5.5', 'mercator/Plasmodium_species/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PyoeliiGenomic_plasmoDB-5.5', 'mercator/Plasmodium_species/repeatmask');

&copyFilesFromComputeCluster($mgr, 'Pfalciparum3D7Genomic_plasmoDB-5.5', 'mercator/Pfalciparum_strains/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PfalciparumDD2Genomic_plasmoDB-5.5', 'mercator/Pfalciparum_strains/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PfalciparumHB3Genomic_plasmoDB-5.5', 'mercator/Pfalciparum_strains/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PfalciparumGhanaianGenomic_plasmoDB-5.5', 'mercator/Pfalciparum_strains/repeatmask');
&copyFilesFromComputeCluster($mgr, 'PfalciparumITGenomic_plasmoDB-5.5', 'mercator/Pfalciparum_strains/repeatmask');

##########The structure of the $dataDir/mercator/Plasmodium_species/mercator/ has been changed after this step for plas55p #################
##########The new structure is $dataDir/mercator/Plasmodium_species/mercator/$draft-$referenceGenome/fasta/$draft.fasta,$referenceGenome.fasta  and $dataDir/mercator/Plasmodium_species/mercator/$draft-$referenceGenome/gff/$draft.gff,$referenceGenome.gff
##########all steps for sepcies after this need to be adjusted for the new data dir structure##########################

&copy($mgr,"$dataDir/mercator/Plasmodium_species/repeatmask/PbergheiGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Plasmodium_species/mercator/fasta/p_berghei.fasta.in", "$dataDir/mercator/Plasmodium_species/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Plasmodium_species/repeatmask/PfalciparumGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Plasmodium_species/mercator/fasta/p_falciparum.fasta.in", "$dataDir/mercator/Plasmodium_species/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Plasmodium_species/repeatmask/PchabaudiGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Plasmodium_species/mercator/fasta/p_chabaudi.fasta.in", "$dataDir/mercator/Plasmodium_species/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Plasmodium_species/repeatmask/PknowlesiGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Plasmodium_species/mercator/fasta/p_knowlesi.fasta.in", "$dataDir/mercator/Plasmodium_species/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Plasmodium_species/repeatmask/PvivaxGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Plasmodium_species/mercator/fasta/p_vivax.fasta.in", "$dataDir/mercator/Plasmodium_species/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Plasmodium_species/repeatmask/PyoeliiGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Plasmodium_species/mercator/fasta/p_yoelii.fasta.in", "$dataDir/mercator/Plasmodium_species/mercator/fasta");

&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/repeatmask/Pfalciparum3D7Genomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Pfalciparum_strains/mercator/fasta/pfalciparum_3d7.fasta.in", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/repeatmask/PfalciparumDD2Genomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Pfalciparum_strains/mercator/fasta/pfalciparum_dd2.fasta.in", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/repeatmask/PfalciparumHB3Genomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Pfalciparum_strains/mercator/fasta/pfalciparum_hb3.fasta.in", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/repeatmask/PfalciparumGhanaianGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Pfalciparum_strains/mercator/fasta/pfalciparum_ghanaian.fasta.in", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/repeatmask/PfalciparumITGenomic_plasmoDB-5.5/master/mainresult/blocked.seq","$dataDir/mercator/Pfalciparum_strains/mercator/fasta/pfalciparum_it.fasta.in", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta");

&modifyFile($mgr, "pfalciparum_3d7.fasta.in", "pfalciparum_3d7.fasta", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "pfalciparum_dd2.fasta.in", "pfalciparum_dd2.fasta", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "pfalciparum_hb3.fasta.in", "pfalciparum_hb3.fasta", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "pfalciparum_ghanaian.fasta.in", "pfalciparum_ghanaian.fasta", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "pfalciparum_it.fasta.in", "pfalciparum_it.fasta", "$dataDir/mercator/Pfalciparum_strains/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');

&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/training_dir/Pfalciparum3D7Genomic_plasmoDB-5.5.gff","$dataDir/mercator/Pfalciparum_strains/mercator/gff/pfalciparum_3d7.gff.in", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/training_dir/PfalciparumDD2Genomic_plasmoDB-5.5.gff","$dataDir/mercator/Pfalciparum_strains/mercator/gff/pfalciparum_dd2.gff.in", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/training_dir/PfalciparumHB3Genomic_plasmoDB-5.5.gff","$dataDir/mercator/Pfalciparum_strains/mercator/gff/pfalciparum_hb3.gff.in", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/training_dir/PfalciparumGhanaianGenomic_plasmoDB-5.5.gff","$dataDir/mercator/Pfalciparum_strains/mercator/gff/pfalciparum_ghanaian.gff.in", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&copy($mgr,"$dataDir/mercator/Pfalciparum_strains/training_dir/PfalciparumITGenomic_plasmoDB-5.5.gff","$dataDir/mercator/Pfalciparum_strains/mercator/gff/pfalciparum_it.gff.in", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");

&grepMercatorGff($mgr, "pfalciparum_3d7.gff.in", "pfalciparum_3d7.gff", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&grepMercatorGff($mgr, "pfalciparum_dd2.gff.in", "pfalciparum_dd2.gff", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&grepMercatorGff($mgr, "pfalciparum_hb3.gff.in", "pfalciparum_hb3.gff", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&grepMercatorGff($mgr, "pfalciparum_ghanaian.gff.in", "pfalciparum_ghanaian.gff", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");
&grepMercatorGff($mgr, "pfalciparum_it.gff.in", "pfalciparum_it.gff", "$dataDir/mercator/Pfalciparum_strains/mercator/gff");

&runMercatorMavid($mgr, "$dataDir/mercator/Pfalciparum_strains/mercator", "mercatorMavid-5StrainGenomes");

########For species ###############

&modifyFile($mgr, "p_berghei.fasta.in", "p_berghei.fasta", "$dataDir/mercator/Plasmodium_species/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "p_chabaudi.fasta.in", "p_chabaudi.fasta", "$dataDir/mercator/Plasmodium_species/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "p_knowlesi.fasta.in", "p_knowlesi.fasta", "$dataDir/mercator/Plasmodium_species/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "p_yoelii.fasta.in", "p_yoelii.fasta", "$dataDir/mercator/Plasmodium_species/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "p_falciparum.fasta.in", "p_falciparum.fasta", "$dataDir/mercator/Plasmodium_species/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');
&modifyFile($mgr, "p_vivax.fasta.in", "p_vivax.fasta", "$dataDir/mercator/Plasmodium_species/mercator/fasta", '\>[\w\d-\.]+\|([\w\d_\.]+)\|.*/>$1');

&copy($mgr,"/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pberghei/Plasmodium_berghei/p_berghei.gff","$dataDir/mercator/Plasmodium_species/mercator/gff/p_berghei.gff.in", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&copy($mgr,"/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pchabaudi/Plasmodium_chabaudi/p_chabaudi.gff","$dataDir/mercator/Plasmodium_species/mercator/gff/p_chabaudi.gff.in", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&copy($mgr,"/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pfalciparum/Plasmodium_falciparum/p_falciparum.gff","$dataDir/mercator/Plasmodium_species/mercator/gff/p_falciparum.gff.in", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&copy($mgr,"/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pknowlesi/Plasmodium_knowlesi/p_knowlesi.gff","$dataDir/mercator/Plasmodium_species/mercator/gff/p_knowlesi.gff.in", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&copy($mgr,"/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pvivax/Plasmodium_vivax/p_vivax.gff","$dataDir/mercator/Plasmodium_species/mercator/gff/p_vivax.gff.in", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&copy($mgr,"/files/cbil/data/cbil/apiSiteFiles/downloadSite/PlasmoDB/release-5.5/Pyoelii/Plasmodium_yoelii/p_yoelii.gff","$dataDir/mercator/Plasmodium_species/mercator/gff/p_yoelii.gff.in", "$dataDir/mercator/Plasmodium_species/mercator/gff");

########run fixMercatorOffsetsInGFF.pl for each gff files###############################################################################
########manually run fixMercatorOffsetsInGFF.pl --f XX.fasta --g XX.gff --o outputfile for each species for plas55p#########################
########need to add steps #####################################################################################################################

&grepMercatorGff($mgr, "p_berghei.gff.in", "p_berghei.gff", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&grepMercatorGff($mgr, "p_chabaudi.gff.in", "p_chabaudi.gff", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&grepMercatorGff($mgr, "p_falciparum.gff.in", "p_falciparum.gff", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&grepMercatorGff($mgr, "p_knowlesi.gff.in", "p_knowlesi.gff", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&grepMercatorGff($mgr, "p_vivax.gff.in", "p_vivax.gff", "$dataDir/mercator/Plasmodium_species/mercator/gff");
&grepMercatorGff($mgr, "p_yoelii.gff.in", "p_yoelii.gff", "$dataDir/mercator/Plasmodium_species/mercator/gff");

&runPairwiseMercatorMavid($mgr, "$dataDir/mercator/Plasmodium_species/mercator", "mercatorMavidPairwise-6genomes");

&createExtDbAndDbRls($mgr, 'berghei-falciparum synteny from Mercator', '2008-07-14', '');
&createExtDbAndDbRls($mgr, 'chabaudi-falciparum synteny from Mercator', '2008-07-14', '');
&createExtDbAndDbRls($mgr, 'knowlesi-falciparum synteny from Mercator', '2008-07-14', '');
&createExtDbAndDbRls($mgr, 'vivax-falciparum synteny from Mercator', '2008-07-14', '');
&createExtDbAndDbRls($mgr, 'yoelii-falciparum synteny from Mercator', '2008-07-14', '');
&createExtDbAndDbRls($mgr, 'berghei-chabaudi synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'berghei-knowlesi synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'berghei-vivax synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'berghei-yoelii synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'chabaudi-knowlesi synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'chabaudi-vivax synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'chabaudi-yoelii synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'knowlesi-vivax synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'knowlesi-yoelii synteny from Mercator', '2009-05-19', '');
&createExtDbAndDbRls($mgr, 'vivax-yoelii synteny from Mercator', '2009-05-19', '');

&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_berghei-p_falciparum/p_berghei-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2007-06-28", "P. berghei genome|2006-02-27", "berghei-falciparum synteny from Mercator|2008-07-14","" ,"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_chabaudi-p_falciparum/p_chabaudi-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2007-06-28", "P. chabaudi genome|2006-02-27", "chabaudi-falciparum synteny from Mercator|2008-07-14","" ,"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_knowlesi-p_falciparum/p_knowlesi-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2007-06-28", "Sanger P. knowlesi chromosomes|2007-10-03", "knowlesi-falciparum synteny from Mercator|2008-07-14","" ,"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_vivax-p_falciparum/p_vivax-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2007-06-28", "P.vivax contigs from Genbank|2007-06-13", "vivax-falciparum synteny from Mercator|2008-07-14","" ,"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_yoelii-p_falciparum/p_yoelii-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2007-06-28", "Jane Carlton P. yoelii chromosomes|2002-09-10", "yoelii-falciparum synteny from Mercator|2008-07-14","" ,"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_berghei-p_falciparum/p_berghei-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2009-02-19", "P. berghei genome|2006-02-27", "berghei-falciparum synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_berghei-p_chabaudi/p_berghei-p_chabaudi.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "P. chabaudi genome and annotations|2009-03-24", "P. berghei genome|2006-02-27", "berghei-chabaudi synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_berghei-p_knowlesi/p_berghei-p_knowlesi.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "P. knowlesi chromosomes|2007-10-03", "P. berghei genome|2006-02-27", "berghei-knowlesi synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_yoelii-p_berghei/p_yoelii-p_berghei.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "P. berghei genome|2006-02-27", "Jane Carlton P. yoelii chromosomes|2002-09-10","berghei-yoelii synteny from Mercator|2009-05-19","$dataDir/mercator/Plasmodium_species/mercator/p_yoelii-p_berghei/mercator-output/p_berghei.agp","Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_berghei-p_vivax_chr/p_berghei-p_vivax_chr.align", "DoTS.VirtualSequence", "DoTS.ExternalNASequence", "Plasmodium vivax chromosomes|2007-09-04", "P. berghei genome|2006-02-27", "berghei-vivax synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_chabaudi-p_falciparum/p_chabaudi-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2009-02-19", "P. chabaudi genome and annotations|2009-03-24", "chabaudi-falciparum synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_chabaudi-p_knowlesi/p_chabaudi-p_knowlesi.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "P. knowlesi chromosomes|2007-10-03", "P. chabaudi genome and annotations|2009-03-24", "chabaudi-knowlesi synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_chabaudi-p_vivax_chr/p_chabaudi-p_vivax_chr.align", "DoTS.VirtualSequence", "DoTS.ExternalNASequence", "Plasmodium vivax chromosomes|2007-09-04", "P. chabaudi genome and annotations|2009-03-24", "chabaudi-vivax synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_knowlesi-p_falciparum/p_knowlesi-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2009-02-19", "P. knowlesi chromosomes|2007-10-03", "knowlesi-falciparum synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_knowlesi-p_vivax_chr/p_knowlesi-p_vivax_chr.align", "DoTS.VirtualSequence", "DoTS.ExternalNASequence", "Plasmodium vivax chromosomes|2007-09-04", "P. knowlesi chromosomes|2007-10-03", "knowlesi-vivax synteny from Mercator|2009-05-19",'',"Plasmodium");
#&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_vivax_chr-p_falciparum.align.2", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2009-02-19", "P.vivax contigs from Genbank|2007-06-13", "vivax-falciparum synteny from Mercator|2009-05-19","Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_vivax_chr-p_falciparum/p_vivax_chr-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.VirtualSequence", "Sanger P. falciparum chromosomes|2009-02-19", "Plasmodium vivax chromosomes|2007-09-04", "vivax-falciparum synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_yoelii-p_falciparum/p_yoelii-p_falciparum.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "Sanger P. falciparum chromosomes|2009-02-19", "Jane Carlton P. yoelii chromosomes|2002-09-10", "yoelii-falciparum synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_yoelii-p_chabaudi/p_yoelii-p_chabaudi.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "P. chabaudi genome and annotations|2009-03-24", "Jane Carlton P. yoelii chromosomes|2002-09-10", "chabaudi-yoelii synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_yoelii-p_knowlesi/p_yoelii-p_knowlesi.align", "DoTS.ExternalNASequence", "DoTS.ExternalNASequence", "P. knowlesi chromosomes|2007-10-03", "Jane Carlton P. yoelii chromosomes|2002-09-10", "knowlesi-yoelii synteny from Mercator|2009-05-19",'',"Plasmodium");
&insertMercatorSyntenySpans($mgr, "$dataDir/mercator/Plasmodium_species/mercator/p_yoelii-p_vivax_chr/p_yoelii-p_vivax_chr.align", "DoTS.VirtualSequence", "DoTS.ExternalNASequence", "Plasmodium vivax chromosomes|2007-09-04", "Jane Carlton P. yoelii chromosomes|2002-09-10", "vivax-yoelii synteny from Mercator|2009-05-19",'',"Plasmodium");

###############################################################################################################################
######################make Xml files for Brc##################################
#############################################################################################################################

&makeBrcSeqXmlFile($mgr, "Sanger P. falciparum chromosomes", "2007-06-28", "p_falciparum_3d7.gff", "no", "Sanger|Sanger|Sanger%%JCVI|JCVI|JCVI", "p_falciparum_3d7.xml", "plas55p", "GeneDB", "","P.falciparum");

&makeBrcSeqXmlFile($mgr, "Plasmodium vivax chromosomes,P.vivax contigs from Genbank", "2007-09-04,2007-06-13", "p_vivax_salvador1.gff", "no", "Genbank|Genbank|Genbank", "p_vivax_salvador1.xml", "plas55p", "Genbank", "","P.vivax");

&makeBrcSeqXmlFile($mgr, "Jane Carlton P. yoelii chromosomes", "2002-09-10", "p_yoelii_17xnl.gff", "no", "JCVI|JCVI|JCVI", "p_yoelii_17xnl.xml", "plas55p", "JCVI", "","P.yoelii");

&makeBrcSeqXmlFile($mgr, "P. berghei genome", "2006-02-27", "p_berghei_anka.gff", "no", "Sanger|Sanger|Sanger", "p_berghei_anka.xml", "plas55p", "GeneDB", "","P.berghei");

&makeBrcSeqXmlFile($mgr, "P. chabaudi genome", "2006-02-27", "p_chabaudi_as.gff", "no", "Sanger|Sanger|Sanger", "p_chabaudi_as.xml", "plas55p", "GeneDB", "","P.chabaudi");

&makeBrcSeqXmlFile($mgr, "Sanger P. knowlesi chromosomes", "2007-10-03", "p_knowlesi_h.gff", "no", "Sanger|Sanger|Sanger", "p_knowlesi_h.xml", "plas55p", "GeneDB", "","P.knowlesi");

&makeBrcSeqXmlFile($mgr, "P. falciparum plastid-like DNA", "2", "p_falciparum_3d7.gff", "no", "Genbank|Genbank|Genbank", "p_falciparum_plastid.xml", "plas55p", "Genbank", "","P.falciparum");

&makeBrcSeqXmlFile($mgr, "Sanger P. reichenowi contigs", "2004-03-11", "p_reichenowi.gff", "no", "Sanger|Sanger|Sanger", "p_reichenowi.xml", "plas55p", "Sanger", "","P.reichenowi");

&makeBrcSeqXmlFile($mgr, "Sanger P. gallinaceum contigs", "2007-01-03", "p_gallinaceum.gff", "no", "Sanger|Sanger|Sanger", "p_gallinaceum.xml", "plas55p", "Sanger", "","P.gallinaceum");

&makeBrcSeqXmlFile($mgr, "P. falciparum mitochondrial genome", "1", "p_falciparum_3d7.gff", "no", "Genbank|Genbank|Genbank", "p_falciparum_mitochondrial.xml", "plas55p", "Genbank", "","P.falciparum");

&makeBrcSeqXmlFile($mgr, "P. vivax mitochondrial genome", "2005-07-12", "p_vivax_salvador1.gff", "no", "Genbank|Genbank|Genbank", "p_vivax_mitochondrial.xml", "plas55p", "Genbank", "","P.vivax");

&makeBrcGOAssociationFile($mgr, "Sanger P. falciparum chromosomes", "2007-06-28", "p_falciparum_3d7.tab","ApiDB_PlasmoDB");

&makeBrcGOAssociationFile($mgr, "P.vivax_GBAnnotation", "2007-06-13", "p_vivax_salvador1.tab","ApiDB_PlasmoDB");

&makeBrcGOAssociationFile($mgr, "Jane Carlton P. yoelii chromosomes", "2002-09-10", "p_yoelii_17xnl.tab","ApiDB_PlasmoDB");

&makeBrcGOAssociationFile($mgr, "P. berghei genome", "2006-02-27", "p_berghei_anka.tab","ApiDB_PlasmoDB");

&makeBrcGOAssociationFile($mgr, "P. chabaudi genome", "2006-02-27", "p_chabaudi_as.tab","ApiDB_PlasmoDB");

&makeBrcGOAssociationFile($mgr, "Sanger P. knowlesi chromosomes", "2007-10-03", "p_knowlesi_h.tab","ApiDB_PlasmoDB");


################################################################
##########  Map Isolates to Genome  ############################
################################################################

my $blastParams = "V=1 B=1 hspsepQmax=50000 hspsepSmax=50000 -span1 -topcomboN=1 E=0.1 -wordmask=seg";

&createSimilarityDir($mgr,"PlasmoIsolates", "PfalciparumChroms","(\\S+)", $blastParams, "blastn");

&createSimilarityDir($mgr,"PlasmoIsolates", "PvivaxContigs","(\\S+)", $blastParams, "blastn");

&createSimilarityDir($mgr,"PlasmoIsolates", "PreichenowiContigs","(\\S+)", $blastParams, "blastn");

&createSimilarityDir($mgr,"PlasmoIsolates", "PknowlesiChroms","(\\S+)", $blastParams, "blastn");

&createSimilarityDir($mgr,"PlasmoIsolates", "PgallinaceumContigs","(\\S+)", $blastParams, "blastn");

&createSimilarityDir($mgr,"PlasmoIsolates", "PchabaudiChroms","(\\S+)", $blastParams, "blastn");

&createSimilarityDir($mgr,"PlasmoIsolates", "PbergherContigs","(\\S+)", $blastParams, "blastn");

&createSimilarityDir($mgr,"PlasmoIsolates", "PyoeliiContigs","(\\S+)", $blastParams, "blastn");


&extractNaSeq($mgr,"Plasmodium isolates From Genbank","2009-04-13",'Plasmo',"isolates","ExternalNASequence","source_id");

&copyFilesToComputeCluster($mgr,"PlasmoIsolates.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PfalciparumChroms.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PvivaxContigs.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PreichenowiContigs.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PknowlesiChroms.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PgallinaceumContigs.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PchabaudiChroms.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PbergherContigs.fsa","seqfiles");
&copyFilesToComputeCluster($mgr,"PyoeliiContigs.fsa","seqfiles");


 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PfalciparumChroms","similarity");
 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PvivaxContigs","similarity");
 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PreichenowiContigs","similarity");
 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PknowlesiChroms","similarity");
 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PgallinaceumContigs","similarity");
 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PchabaudiChroms","similarity");
 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PbergherContigs","similarity");
 &copyFilesToComputeCluster($mgr,"PlasmoIsolates-PyoeliiContigs","similarity");



 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PfalciparumChroms","apidb");
 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PvivaxContigs","apidb");
 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PreichenowiContigs","apidb");
 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PknowlesiChroms","apidb");
 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PgallinaceumContigs","apidb");
 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PchabaudiChroms","apidb");
 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PbergherContigs","apidb");
 &startProteinBlastOnComputeCluster($mgr,"PlasmoIsolates","PyoeliiContigs","apidb");




 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PfalciparumChroms","similarity");
 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PvivaxContigs","similarity");
 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PreichenowiContigs","similarity");
 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PknowlesiChroms","similarity");
 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PgallinaceumContigs","similarity");
 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PchabaudiChroms","similarity");
 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PbergherContigs","similarity");
 &copyFilesFromComputeCluster($mgr,"PlasmoIsolates-PyoeliiContigs","similarity");






&loadProteinBlast($mgr, "PlasmoIsolates-PfalciparumChroms","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'Sanger P. falciparum chromosomes','2009-02-19', " --subjectsLimit 50 --hspsLimit 10 ");

&loadProteinBlast($mgr, "PlasmoIsolates-PvivaxContigs","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'P.vivax contigs from Genbank','2007-06-13', " --subjectsLimit 50 --hspsLimit 10 ");

&loadProteinBlast($mgr, "PlasmoIsolates-PreichenowiContigs","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'P. reichenowi contigs','2004-03-11', " --subjectsLimit 50 --hspsLimit 10 ");

&loadProteinBlast($mgr, "PlasmoIsolates-PknowlesiChroms","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'P. knowlesi chromosomes','2007-10-03', " --subjectsLimit 50 --hspsLimit 10 ");

&loadProteinBlast($mgr, "PlasmoIsolates-PgallinaceumContigs","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'P. gallinaceum contigs','2006-12-31', " --subjectsLimit 50 --hspsLimit 10 ");

&loadProteinBlast($mgr, "PlasmoIsolates-PchabaudiChroms","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'P. chabaudi genome and annotations','2009-03-24', " --subjectsLimit 50 --hspsLimit 10 ");

&loadProteinBlast($mgr, "PlasmoIsolates-PbergherContigs","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'P. berghei genome','2006-02-27', " --subjectsLimit 50 --hspsLimit 10 ");

&loadProteinBlast($mgr, "PlasmoIsolates-PyoeliiContigs","DoTS::ExternalNASequence", "DoTS::ExternalNASequence","source_id","source_id","Plasmodium isolates From Genbank","2009-04-13",'Jane Carlton P. yoelii chromosomes','2002-09-10', " --subjectsLimit 50 --hspsLimit 10 ");

&makeIsolateDownloadFile($mgr, "", "Plasmodium_Isolate", "Plasmodium isolates From Genbank","2009-04-13", "ExternalNASequence");


#########################################
####Piggyback colnes
#########################################

my $blastParams = "-nogaps V=1 E=1e-10 B=1 hspsepQmax=50000 hspsepSmax=50000 -span1 -topcomboN=1","blastn";

&createSimilarityDir($mgr,"PiggyBac_Clones_Adams","PfalciparumChroms","(\\S+)",$blastParams,"blastn");

&copyFilesToComputeCluster($mgr,"PiggyBac_Clones_Adams-PfalciparumChroms","similarity");

&copyFilesToComputeCluster($mgr,"PiggyBac_Clones_Adams.fsa","seqfiles");

&copyFilesToComputeCluster($mgr,"PfalciparumChroms.fsa","seqfiles");

&startProteinBlastOnComputeCluster($mgr,"PiggyBac_Clones_Adams","PfalciparumChroms","apidb");

&copyFilesFromComputeCluster($mgr,"PiggyBac_Clones_Adams-PfalciparumChroms","similarity");

&blastToGff($mgr,"$projectDir/$release/analysis_pipeline/primary/data/similarity/PiggyBac_Clones_Adams-PfalciparumChroms/master/mainresult/PiggyBac_Clones_Adams_blast.gff","$projectDir/$release/analysis_pipeline/primary/data/similarity/PiggyBac_Clones_Adams-PfalciparumChroms/master/mainresult/blastSimilarity.out");

&loadTransposableElementFromGff($mgr,"$projectDir/$release/analysis_pipeline/primary/data/similarity/PiggyBac_Clones_Adams-PfalciparumChroms/master/mainresult/PiggyBac_Clones_Adams_blast.gff","PiggyBac_Clones_Adams","2010-03-23","$ENV{GUS_HOME}/lib/xml/isf/PlasmoDB/plasmoTransposableElementFeature2gus.xml","Sanger P. falciparum chromosomes","2009-02-19","2.3","ExternalNASequence","Plasmodium falciparum 3D7","enzyme:enzymeDB:2009-02-11");


$mgr->goodbye("Pipeline complete!\n");


